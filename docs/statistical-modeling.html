<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Seminar 14 Statistical modeling | Data analysis using R for Psychology and Social Science</title>
  <meta name="description" content="Material and exercises for ‘Applied data analysis for psychology using the open-source software R’ seminar." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Seminar 14 Statistical modeling | Data analysis using R for Psychology and Social Science" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Material and exercises for ‘Applied data analysis for psychology using the open-source software R’ seminar." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Seminar 14 Statistical modeling | Data analysis using R for Psychology and Social Science" />
  
  <meta name="twitter:description" content="Material and exercises for ‘Applied data analysis for psychology using the open-source software R’ seminar." />
  

<meta name="author" content="Alexander (Sasha) Pastukhov" />


<meta name="date" content="2022-01-31" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sampling-and-simulations.html"/>

<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="font-awesome.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data analysis using R for Psychology</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-r"><i class="fa fa-check"></i>Why R?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-tidyverse"><i class="fa fa-check"></i>Why Tidyverse</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-seminar"><i class="fa fa-check"></i>About the seminar</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#thinking-like-a-computer"><i class="fa fa-check"></i>Thinking like a computer</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-material"><i class="fa fa-check"></i>About the material</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="software.html"><a href="software.html"><i class="fa fa-check"></i>Software</a>
<ul>
<li class="chapter" data-level="0.1" data-path="software.html"><a href="software.html#install-r"><i class="fa fa-check"></i><b>0.1</b> Installing R</a></li>
<li class="chapter" data-level="0.2" data-path="software.html"><a href="software.html#install-rstudio"><i class="fa fa-check"></i><b>0.2</b> Installing R-Studio</a></li>
<li class="chapter" data-level="0.3" data-path="software.html"><a href="software.html#install-rtools"><i class="fa fa-check"></i><b>0.3</b> Installing RTools</a></li>
<li class="chapter" data-level="" data-path="software.html"><a href="software.html#install.packages"><i class="fa fa-check"></i>Installing packages</a></li>
<li class="chapter" data-level="0.4" data-path="software.html"><a href="software.html#minimal-set-of-packages"><i class="fa fa-check"></i><b>0.4</b> Minimal set of packages</a></li>
<li class="chapter" data-level="0.5" data-path="software.html"><a href="software.html#installr"><i class="fa fa-check"></i><b>0.5</b> Keeping R and packages up-to-date</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="reproducable-research.html"><a href="reproducable-research.html"><i class="fa fa-check"></i><b>1</b> Reproducable Research: Projects and RMarkdown Notebooks</a>
<ul>
<li class="chapter" data-level="1.1" data-path="reproducable-research.html"><a href="reproducable-research.html#projects"><i class="fa fa-check"></i><b>1.1</b> Projects</a></li>
<li class="chapter" data-level="1.2" data-path="reproducable-research.html"><a href="reproducable-research.html#rmarkdown"><i class="fa fa-check"></i><b>1.2</b> RMarkdown</a></li>
<li class="chapter" data-level="1.3" data-path="reproducable-research.html"><a href="reproducable-research.html#exercise"><i class="fa fa-check"></i><b>1.3</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="vectors.html"><a href="vectors.html"><i class="fa fa-check"></i><b>2</b> Vectors! Vectors everywhere!</a>
<ul>
<li class="chapter" data-level="2.1" data-path="vectors.html"><a href="vectors.html#variables"><i class="fa fa-check"></i><b>2.1</b> Variables as boxes</a></li>
<li class="chapter" data-level="2.2" data-path="vectors.html"><a href="vectors.html#assignment-statement"><i class="fa fa-check"></i><b>2.2</b> Assignment statement in detail</a></li>
<li class="chapter" data-level="2.3" data-path="vectors.html"><a href="vectors.html#vectors-scalars"><i class="fa fa-check"></i><b>2.3</b> Vectors and singluar values (scalars, which are also vectors)</a></li>
<li class="chapter" data-level="2.4" data-path="vectors.html"><a href="vectors.html#vector-index"><i class="fa fa-check"></i><b>2.4</b> Vector indexes (subsetting)</a></li>
<li class="chapter" data-level="2.5" data-path="vectors.html"><a href="vectors.html#names"><i class="fa fa-check"></i><b>2.5</b> Names as an Index</a></li>
<li class="chapter" data-level="2.6" data-path="vectors.html"><a href="vectors.html#vector-index-slicing"><i class="fa fa-check"></i><b>2.6</b> Slicing</a></li>
<li class="chapter" data-level="2.7" data-path="vectors.html"><a href="vectors.html#colon-sequence"><i class="fa fa-check"></i><b>2.7</b> Colon Operator and Sequence Generation</a></li>
<li class="chapter" data-level="2.8" data-path="vectors.html"><a href="vectors.html#working-with-two-vectors-of-equal-length"><i class="fa fa-check"></i><b>2.8</b> Working with two vectors of <em>equal</em> length</a></li>
<li class="chapter" data-level="2.9" data-path="vectors.html"><a href="vectors.html#different-length-vectors"><i class="fa fa-check"></i><b>2.9</b> Working with two vectors of <em>different</em> length</a></li>
<li class="chapter" data-level="2.10" data-path="vectors.html"><a href="vectors.html#applying-functions-to-a-vector"><i class="fa fa-check"></i><b>2.10</b> Applying functions to a vector</a></li>
<li class="chapter" data-level="2.11" data-path="vectors.html"><a href="vectors.html#wrap-up"><i class="fa fa-check"></i><b>2.11</b> Wrap up</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tables.html"><a href="tables.html"><i class="fa fa-check"></i><b>3</b> Tables and Tibbles (and Tribbles)</a>
<ul>
<li class="chapter" data-level="3.1" data-path="tables.html"><a href="tables.html#primary-types"><i class="fa fa-check"></i><b>3.1</b> Primary data types</a></li>
<li class="chapter" data-level="3.2" data-path="tables.html"><a href="tables.html#vectors-are-homogeneous"><i class="fa fa-check"></i><b>3.2</b> All vector values must be of the same type</a></li>
<li class="chapter" data-level="3.3" data-path="tables.html"><a href="tables.html#lists"><i class="fa fa-check"></i><b>3.3</b> Lists</a></li>
<li class="chapter" data-level="3.4" data-path="tables.html"><a href="tables.html#subsetting"><i class="fa fa-check"></i><b>3.4</b> Subsetting, a fuller version</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="tables.html"><a href="tables.html#subsetting-for-atomics-vectors"><i class="fa fa-check"></i><b>3.4.1</b> Subsetting for (atomics) vectors</a></li>
<li class="chapter" data-level="3.4.2" data-path="tables.html"><a href="tables.html#subsetting-for-lists"><i class="fa fa-check"></i><b>3.4.2</b> Subsetting for lists</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="tables.html"><a href="tables.html#dollar-subsetting"><i class="fa fa-check"></i><b>3.5</b> Yet another subsetting via $</a></li>
<li class="chapter" data-level="3.6" data-path="tables.html"><a href="tables.html#data.frame"><i class="fa fa-check"></i><b>3.6</b> Tables, a.k.a. data frames</a></li>
<li class="chapter" data-level="3.7" data-path="tables.html"><a href="tables.html#table-subsetting"><i class="fa fa-check"></i><b>3.7</b> Subsetting tables</a></li>
<li class="chapter" data-level="3.8" data-path="tables.html"><a href="tables.html#library"><i class="fa fa-check"></i><b>3.8</b> Using libraries</a></li>
<li class="chapter" data-level="3.9" data-path="tables.html"><a href="tables.html#tibble"><i class="fa fa-check"></i><b>3.9</b> Tibble, a better data.frame</a></li>
<li class="chapter" data-level="3.10" data-path="tables.html"><a href="tables.html#tribble"><i class="fa fa-check"></i><b>3.10</b> Tribble, table from text</a></li>
<li class="chapter" data-level="3.11" data-path="tables.html"><a href="tables.html#data"><i class="fa fa-check"></i><b>3.11</b> Reading example tables</a></li>
<li class="chapter" data-level="3.12" data-path="tables.html"><a href="tables.html#readr"><i class="fa fa-check"></i><b>3.12</b> Reading csv files</a></li>
<li class="chapter" data-level="3.13" data-path="tables.html"><a href="tables.html#readxl"><i class="fa fa-check"></i><b>3.13</b> Reading Excel files</a></li>
<li class="chapter" data-level="3.14" data-path="tables.html"><a href="tables.html#reading-files-from-other-programs"><i class="fa fa-check"></i><b>3.14</b> Reading files from other programs</a></li>
<li class="chapter" data-level="3.15" data-path="tables.html"><a href="tables.html#rds"><i class="fa fa-check"></i><b>3.15</b> Writing and reading a single object</a></li>
<li class="chapter" data-level="3.16" data-path="tables.html"><a href="tables.html#wrap-up-1"><i class="fa fa-check"></i><b>3.16</b> Wrap up</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>4</b> Functions! Functions everywhere!</a>
<ul>
<li class="chapter" data-level="4.1" data-path="functions.html"><a href="functions.html#functions-1"><i class="fa fa-check"></i><b>4.1</b> Functions</a></li>
<li class="chapter" data-level="4.2" data-path="functions.html"><a href="functions.html#writing-a-function"><i class="fa fa-check"></i><b>4.2</b> Writing a function</a></li>
<li class="chapter" data-level="4.3" data-path="functions.html"><a href="functions.html#scopes-global-versus-local-variables"><i class="fa fa-check"></i><b>4.3</b> Scopes: Global versus Local variables</a></li>
<li class="chapter" data-level="4.4" data-path="functions.html"><a href="functions.html#function-with-two-parameters"><i class="fa fa-check"></i><b>4.4</b> Function with two parameters</a></li>
<li class="chapter" data-level="4.5" data-path="functions.html"><a href="functions.html#table-as-a-parameter"><i class="fa fa-check"></i><b>4.5</b> Table as a parameter</a></li>
<li class="chapter" data-level="4.6" data-path="functions.html"><a href="functions.html#named-versus-positional-arguments"><i class="fa fa-check"></i><b>4.6</b> Named versus positional arguments</a></li>
<li class="chapter" data-level="4.7" data-path="functions.html"><a href="functions.html#default-values"><i class="fa fa-check"></i><b>4.7</b> Default values</a></li>
<li class="chapter" data-level="4.8" data-path="functions.html"><a href="functions.html#nested-calls"><i class="fa fa-check"></i><b>4.8</b> Nested calls</a></li>
<li class="chapter" data-level="4.9" data-path="functions.html"><a href="functions.html#pipe"><i class="fa fa-check"></i><b>4.9</b> Piping</a></li>
<li class="chapter" data-level="4.10" data-path="functions.html"><a href="functions.html#function-is-just-a-code-stored-in-a-variable"><i class="fa fa-check"></i><b>4.10</b> Function is just a code stored in a variable</a></li>
<li class="chapter" data-level="4.11" data-path="functions.html"><a href="functions.html#functions-functions-everywhere"><i class="fa fa-check"></i><b>4.11</b> Functions! Functions everywhere!</a></li>
<li class="chapter" data-level="4.12" data-path="functions.html"><a href="functions.html#using-or-not-using-explicit-return-statement"><i class="fa fa-check"></i><b>4.12</b> Using (or not using) explicit return statement</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>5</b> ggplot2: Grammar of Graphics</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ggplot2.html"><a href="ggplot2.html#tidydata"><i class="fa fa-check"></i><b>5.1</b> Tidy data</a></li>
<li class="chapter" data-level="5.2" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-1"><i class="fa fa-check"></i><b>5.2</b> ggplot2</a></li>
<li class="chapter" data-level="5.3" data-path="ggplot2.html"><a href="ggplot2.html#auto-efficiency-continuous-x-axis"><i class="fa fa-check"></i><b>5.3</b> Auto efficiency: continuous x-axis</a></li>
<li class="chapter" data-level="5.4" data-path="ggplot2.html"><a href="ggplot2.html#auto-efficiency-discrete-x-axis"><i class="fa fa-check"></i><b>5.4</b> Auto efficiency: discrete x-axis</a></li>
<li class="chapter" data-level="5.5" data-path="ggplot2.html"><a href="ggplot2.html#mammals-sleep-single-variable"><i class="fa fa-check"></i><b>5.5</b> Mammals sleep: single variable</a></li>
<li class="chapter" data-level="5.6" data-path="ggplot2.html"><a href="ggplot2.html#mapping-for-all-visuals-versus-just-one-visual"><i class="fa fa-check"></i><b>5.6</b> Mapping for all visuals versus just one visual</a></li>
<li class="chapter" data-level="5.7" data-path="ggplot2.html"><a href="ggplot2.html#mapping-on-variables-versus-constants"><i class="fa fa-check"></i><b>5.7</b> Mapping on variables versus constants</a></li>
<li class="chapter" data-level="5.8" data-path="ggplot2.html"><a href="ggplot2.html#themes"><i class="fa fa-check"></i><b>5.8</b> Themes</a></li>
<li class="chapter" data-level="5.9" data-path="ggplot2.html"><a href="ggplot2.html#you-aint-seen-nothing-yet"><i class="fa fa-check"></i><b>5.9</b> You ain’t seen nothing yet</a></li>
<li class="chapter" data-level="5.10" data-path="ggplot2.html"><a href="ggplot2.html#further-reading"><i class="fa fa-check"></i><b>5.10</b> Further reading</a></li>
<li class="chapter" data-level="5.11" data-path="ggplot2.html"><a href="ggplot2.html#extending-ggplot2"><i class="fa fa-check"></i><b>5.11</b> Extending ggplot2</a></li>
<li class="chapter" data-level="5.12" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-cannot-do-everything"><i class="fa fa-check"></i><b>5.12</b> ggplot2 cannot do everything</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="dplyr.html"><a href="dplyr.html"><i class="fa fa-check"></i><b>6</b> Tidyverse: dplyr</a>
<ul>
<li class="chapter" data-level="6.1" data-path="dplyr.html"><a href="dplyr.html#tidyverse-philosophy"><i class="fa fa-check"></i><b>6.1</b> Tidyverse philosophy</a></li>
<li class="chapter" data-level="6.2" data-path="dplyr.html"><a href="dplyr.html#select"><i class="fa fa-check"></i><b>6.2</b> <code>select()</code> columns by name</a></li>
<li class="chapter" data-level="6.3" data-path="dplyr.html"><a href="dplyr.html#conditions"><i class="fa fa-check"></i><b>6.3</b> Conditions</a></li>
<li class="chapter" data-level="6.4" data-path="dplyr.html"><a href="dplyr.html#logical-indexing"><i class="fa fa-check"></i><b>6.4</b> Logical indexing</a></li>
<li class="chapter" data-level="6.5" data-path="dplyr.html"><a href="dplyr.html#filter-rows-by-values"><i class="fa fa-check"></i><b>6.5</b> <code>filter()</code> rows by values</a></li>
<li class="chapter" data-level="6.6" data-path="dplyr.html"><a href="dplyr.html#arrange-rows-in-a-particular-order"><i class="fa fa-check"></i><b>6.6</b> <code>arrange()</code> rows in a particular order</a></li>
<li class="chapter" data-level="6.7" data-path="dplyr.html"><a href="dplyr.html#mutate"><i class="fa fa-check"></i><b>6.7</b> <code>mutate()</code> columns</a></li>
<li class="chapter" data-level="6.8" data-path="dplyr.html"><a href="dplyr.html#summarize"><i class="fa fa-check"></i><b>6.8</b> <code>summarize()</code> table by <code>groups</code></a></li>
<li class="chapter" data-level="6.9" data-path="dplyr.html"><a href="dplyr.html#putting-it-all-together"><i class="fa fa-check"></i><b>6.9</b> Putting it all together</a></li>
<li class="chapter" data-level="6.10" data-path="dplyr.html"><a href="dplyr.html#should-i-use-tidyverse"><i class="fa fa-check"></i><b>6.10</b> Should I use Tidyverse?</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="working-with-factors.html"><a href="working-with-factors.html"><i class="fa fa-check"></i><b>7</b> Working with Factors</a>
<ul>
<li class="chapter" data-level="7.1" data-path="working-with-factors.html"><a href="working-with-factors.html#how-to-write-code"><i class="fa fa-check"></i><b>7.1</b> How to write code</a></li>
<li class="chapter" data-level="7.2" data-path="working-with-factors.html"><a href="working-with-factors.html#implementing-a-typical-analysis"><i class="fa fa-check"></i><b>7.2</b> Implementing a typical analysis</a></li>
<li class="chapter" data-level="7.3" data-path="working-with-factors.html"><a href="working-with-factors.html#factors"><i class="fa fa-check"></i><b>7.3</b> Factors</a></li>
<li class="chapter" data-level="7.4" data-path="working-with-factors.html"><a href="working-with-factors.html#forcats"><i class="fa fa-check"></i><b>7.4</b> Forcats</a></li>
<li class="chapter" data-level="7.5" data-path="working-with-factors.html"><a href="working-with-factors.html#plotting-group-averages"><i class="fa fa-check"></i><b>7.5</b> Plotting group averages</a></li>
<li class="chapter" data-level="7.6" data-path="working-with-factors.html"><a href="working-with-factors.html#plotting-our-confidence-in-group-averages-via-quantiles"><i class="fa fa-check"></i><b>7.6</b> Plotting our confidence in group averages via quantiles</a></li>
<li class="chapter" data-level="7.7" data-path="working-with-factors.html"><a href="working-with-factors.html#looking-at-similarity"><i class="fa fa-check"></i><b>7.7</b> Looking at similarity</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="tyding.html"><a href="tyding.html"><i class="fa fa-check"></i><b>8</b> Tidyng your data: joins and pivots</a>
<ul>
<li class="chapter" data-level="8.1" data-path="tyding.html"><a href="tyding.html#joins"><i class="fa fa-check"></i><b>8.1</b> Joining tables</a></li>
<li class="chapter" data-level="8.2" data-path="tyding.html"><a href="tyding.html#pivoting"><i class="fa fa-check"></i><b>8.2</b> Pivoting</a></li>
<li class="chapter" data-level="8.3" data-path="tyding.html"><a href="tyding.html#pivot-longer"><i class="fa fa-check"></i><b>8.3</b> Pivot longer</a></li>
<li class="chapter" data-level="8.4" data-path="tyding.html"><a href="tyding.html#pivot-wider"><i class="fa fa-check"></i><b>8.4</b> Pivot wider</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="controling-computation-flow.html"><a href="controling-computation-flow.html"><i class="fa fa-check"></i><b>9</b> Controling computation flow</a>
<ul>
<li class="chapter" data-level="9.1" data-path="controling-computation-flow.html"><a href="controling-computation-flow.html#rep"><i class="fa fa-check"></i><b>9.1</b> <code>rep()</code></a></li>
<li class="chapter" data-level="9.2" data-path="controling-computation-flow.html"><a href="controling-computation-flow.html#repeating-combinations"><i class="fa fa-check"></i><b>9.2</b> Repeating combinations</a></li>
<li class="chapter" data-level="9.3" data-path="controling-computation-flow.html"><a href="controling-computation-flow.html#forloop"><i class="fa fa-check"></i><b>9.3</b> For loop</a></li>
<li class="chapter" data-level="9.4" data-path="controling-computation-flow.html"><a href="controling-computation-flow.html#if-else"><i class="fa fa-check"></i><b>9.4</b> Conditional statement</a></li>
<li class="chapter" data-level="9.5" data-path="controling-computation-flow.html"><a href="controling-computation-flow.html#breaking-out-of-the-loop"><i class="fa fa-check"></i><b>9.5</b> Breaking out of the loop</a></li>
<li class="chapter" data-level="9.6" data-path="controling-computation-flow.html"><a href="controling-computation-flow.html#using-for-loop-to-load-and-join-multiple-data-files"><i class="fa fa-check"></i><b>9.6</b> Using for loop to load and join multiple data files</a></li>
<li class="chapter" data-level="9.7" data-path="controling-computation-flow.html"><a href="controling-computation-flow.html#apply"><i class="fa fa-check"></i><b>9.7</b> Apply</a></li>
<li class="chapter" data-level="9.8" data-path="controling-computation-flow.html"><a href="controling-computation-flow.html#purrr"><i class="fa fa-check"></i><b>9.8</b> Purrr</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="christmas-special.html"><a href="christmas-special.html"><i class="fa fa-check"></i><b>10</b> Christmas special</a>
<ul>
<li class="chapter" data-level="10.1" data-path="christmas-special.html"><a href="christmas-special.html#left-side-of-the-tree"><i class="fa fa-check"></i><b>10.1</b> Left side of the tree</a></li>
<li class="chapter" data-level="10.2" data-path="christmas-special.html"><a href="christmas-special.html#right-side-of-the-tree"><i class="fa fa-check"></i><b>10.2</b> Right side of the tree</a></li>
<li class="chapter" data-level="10.3" data-path="christmas-special.html"><a href="christmas-special.html#the-whole-tree"><i class="fa fa-check"></i><b>10.3</b> The whole tree</a></li>
<li class="chapter" data-level="10.4" data-path="christmas-special.html"><a href="christmas-special.html#filling-in-the-tree"><i class="fa fa-check"></i><b>10.4</b> Filling in the tree</a></li>
<li class="chapter" data-level="10.5" data-path="christmas-special.html"><a href="christmas-special.html#adding-background-image"><i class="fa fa-check"></i><b>10.5</b> Adding background image</a></li>
<li class="chapter" data-level="10.6" data-path="christmas-special.html"><a href="christmas-special.html#adding-decoration-a-boring-one"><i class="fa fa-check"></i><b>10.6</b> Adding decoration (a boring one)</a></li>
<li class="chapter" data-level="10.7" data-path="christmas-special.html"><a href="christmas-special.html#adding-decoration-a-bit-more-fun-one"><i class="fa fa-check"></i><b>10.7</b> Adding decoration (a bit more fun one)</a></li>
<li class="chapter" data-level="10.8" data-path="christmas-special.html"><a href="christmas-special.html#adding-decoration-the-fun-ones"><i class="fa fa-check"></i><b>10.8</b> Adding decoration (the fun ones)</a></li>
<li class="chapter" data-level="10.9" data-path="christmas-special.html"><a href="christmas-special.html#a-star-on-top"><i class="fa fa-check"></i><b>10.9</b> A star on top</a></li>
<li class="chapter" data-level="10.10" data-path="christmas-special.html"><a href="christmas-special.html#merry-christmas"><i class="fa fa-check"></i><b>10.10</b> Merry Christmas!</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="missing-data.html"><a href="missing-data.html"><i class="fa fa-check"></i><b>11</b> Missing data</a>
<ul>
<li class="chapter" data-level="11.1" data-path="missing-data.html"><a href="missing-data.html#complete"><i class="fa fa-check"></i><b>11.1</b> Making missing data explicit (completing data)</a></li>
<li class="chapter" data-level="11.2" data-path="missing-data.html"><a href="missing-data.html#na.omit"><i class="fa fa-check"></i><b>11.2</b> Dropping / omitting NAs</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="strings.html"><a href="strings.html"><i class="fa fa-check"></i><b>12</b> Working with strings</a>
<ul>
<li class="chapter" data-level="12.1" data-path="strings.html"><a href="strings.html#warming-up"><i class="fa fa-check"></i><b>12.1</b> Warming up</a></li>
<li class="chapter" data-level="12.2" data-path="strings.html"><a href="strings.html#glue"><i class="fa fa-check"></i><b>12.2</b> Formatting strings via <code>glue()</code></a></li>
<li class="chapter" data-level="12.3" data-path="strings.html"><a href="strings.html#paste"><i class="fa fa-check"></i><b>12.3</b> Formatting strings via <code>paste()</code></a></li>
<li class="chapter" data-level="12.4" data-path="strings.html"><a href="strings.html#sprintf"><i class="fa fa-check"></i><b>12.4</b> Formatting strings via <code>sprintf()</code></a></li>
<li class="chapter" data-level="12.5" data-path="strings.html"><a href="strings.html#extracting-information-from-a-string"><i class="fa fa-check"></i><b>12.5</b> Extracting information from a string</a></li>
<li class="chapter" data-level="12.6" data-path="strings.html"><a href="strings.html#splitting-strings-via-separate"><i class="fa fa-check"></i><b>12.6</b> Splitting strings via <code>separate()</code></a></li>
<li class="chapter" data-level="12.7" data-path="strings.html"><a href="strings.html#extracting-a-substring-when-you-know-its-location"><i class="fa fa-check"></i><b>12.7</b> Extracting a substring when you know its location</a></li>
<li class="chapter" data-level="12.8" data-path="strings.html"><a href="strings.html#detecting-a-substring-using-regular-expressions"><i class="fa fa-check"></i><b>12.8</b> Detecting a substring using regular expressions</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="sampling-and-simulations.html"><a href="sampling-and-simulations.html"><i class="fa fa-check"></i><b>13</b> Sampling and simulations</a>
<ul>
<li class="chapter" data-level="13.1" data-path="sampling-and-simulations.html"><a href="sampling-and-simulations.html#estimating-mean-of-a-normal-distribution-via-resampling"><i class="fa fa-check"></i><b>13.1</b> Estimating mean of a normal distribution via resampling</a></li>
<li class="chapter" data-level="13.2" data-path="sampling-and-simulations.html"><a href="sampling-and-simulations.html#bootstrapping-via-boot-library"><i class="fa fa-check"></i><b>13.2</b> Bootstrapping via boot library</a></li>
<li class="chapter" data-level="13.3" data-path="sampling-and-simulations.html"><a href="sampling-and-simulations.html#more-samples-give-you-more-confidence"><i class="fa fa-check"></i><b>13.3</b> More samples give you more confidence</a></li>
<li class="chapter" data-level="13.4" data-path="sampling-and-simulations.html"><a href="sampling-and-simulations.html#adding-average-sample-mean"><i class="fa fa-check"></i><b>13.4</b> Adding average sample mean</a></li>
<li class="chapter" data-level="13.5" data-path="sampling-and-simulations.html"><a href="sampling-and-simulations.html#practice-makes-perfect"><i class="fa fa-check"></i><b>13.5</b> Practice makes perfect</a></li>
<li class="chapter" data-level="13.6" data-path="sampling-and-simulations.html"><a href="sampling-and-simulations.html#starting-with-basics"><i class="fa fa-check"></i><b>13.6</b> Starting with basics</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="statistical-modeling.html"><a href="statistical-modeling.html"><i class="fa fa-check"></i><b>14</b> Statistical modeling</a>
<ul>
<li class="chapter" data-level="14.1" data-path="statistical-modeling.html"><a href="statistical-modeling.html#correlation"><i class="fa fa-check"></i><b>14.1</b> Correlation</a></li>
<li class="chapter" data-level="14.2" data-path="statistical-modeling.html"><a href="statistical-modeling.html#correlation-in-practice"><i class="fa fa-check"></i><b>14.2</b> Correlation in practice</a></li>
<li class="chapter" data-level="14.3" data-path="statistical-modeling.html"><a href="statistical-modeling.html#pairwise-comparisons"><i class="fa fa-check"></i><b>14.3</b> Pairwise comparisons</a></li>
<li class="chapter" data-level="14.4" data-path="statistical-modeling.html"><a href="statistical-modeling.html#t-tests-in-practice"><i class="fa fa-check"></i><b>14.4</b> T-tests in practice</a></li>
<li class="chapter" data-level="14.5" data-path="statistical-modeling.html"><a href="statistical-modeling.html#formula-notation"><i class="fa fa-check"></i><b>14.5</b> Formula notation</a></li>
<li class="chapter" data-level="14.6" data-path="statistical-modeling.html"><a href="statistical-modeling.html#using-t-test-via-formula"><i class="fa fa-check"></i><b>14.6</b> Using t-test via formula</a></li>
<li class="chapter" data-level="14.7" data-path="statistical-modeling.html"><a href="statistical-modeling.html#anova"><i class="fa fa-check"></i><b>14.7</b> ANOVA</a></li>
<li class="chapter" data-level="14.8" data-path="statistical-modeling.html"><a href="statistical-modeling.html#almost-everything-is-a-linear-regression-model"><i class="fa fa-check"></i><b>14.8</b> (Almost) everything is a linear regression model</a></li>
<li class="chapter" data-level="14.9" data-path="statistical-modeling.html"><a href="statistical-modeling.html#GLMM"><i class="fa fa-check"></i><b>14.9</b> (Generalized) Linear Models</a></li>
<li class="chapter" data-level="14.10" data-path="statistical-modeling.html"><a href="statistical-modeling.html#resampling-a-linear-model"><i class="fa fa-check"></i><b>14.10</b> Resampling a linear model</a></li>
<li class="chapter" data-level="14.11" data-path="statistical-modeling.html"><a href="statistical-modeling.html#generalized-linear-mixed-models"><i class="fa fa-check"></i><b>14.11</b> (Generalized) Linear Mixed Models</a></li>
<li class="chapter" data-level="14.12" data-path="statistical-modeling.html"><a href="statistical-modeling.html#disclaimer-repeated"><i class="fa fa-check"></i><b>14.12</b> Disclaimer, repeated</a></li>
<li class="chapter" data-level="14.13" data-path="statistical-modeling.html"><a href="statistical-modeling.html#bad-names-to-good-names"><i class="fa fa-check"></i><b>14.13</b> Bad names to good names</a></li>
<li class="chapter" data-level="14.14" data-path="statistical-modeling.html"><a href="statistical-modeling.html#participant-id"><i class="fa fa-check"></i><b>14.14</b> Participant ID</a></li>
<li class="chapter" data-level="14.15" data-path="statistical-modeling.html"><a href="statistical-modeling.html#factors-1"><i class="fa fa-check"></i><b>14.15</b> Factors</a></li>
<li class="chapter" data-level="14.16" data-path="statistical-modeling.html"><a href="statistical-modeling.html#response-times"><i class="fa fa-check"></i><b>14.16</b> Response times</a></li>
<li class="chapter" data-level="14.17" data-path="statistical-modeling.html"><a href="statistical-modeling.html#accuracy"><i class="fa fa-check"></i><b>14.17</b> Accuracy</a></li>
<li class="chapter" data-level="14.18" data-path="statistical-modeling.html"><a href="statistical-modeling.html#physiological-signal"><i class="fa fa-check"></i><b>14.18</b> Physiological signal</a></li>
<li class="chapter" data-level="14.19" data-path="statistical-modeling.html"><a href="statistical-modeling.html#wrap-up-2"><i class="fa fa-check"></i><b>14.19</b> Wrap up</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://alexander-pastukhov.github.io/">Alexander (Sasha) Pastukhov</li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data analysis using R for Psychology and Social Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="statistical-modeling" class="section level1" number="14">
<h1><span class="header-section-number">Seminar 14</span> Statistical modeling</h1>
<p>I suspect that this is a seminar that you were waiting for the most as it finally tells you how to call statistical functions in R. However, from my perspective, it is the least useful seminar in the entire course because if you know statistics and you know which specific tool you need, figuring out how to use it in R is fairly trivial. Conversely, if your knowledge of statistics is approximate, knowing how to call functions will do you little good. The catch about statistical models is that they are very easy to run (even if you implement them by hand from scratch) but they are easy to misuse and very hard to interpret<a href="#fn64" class="footnote-ref" id="fnref64"><sup>64</sup></a>.</p>
<p>To make things worse, computers and algorithms do not care. In absolute majority of cases, statistical models will happily accept any input you provide, even if it is completely unsuitable, and spit out numbers. Unfortunately, it is on you, not on the computer, to know what you are doing and whether results even make sense. The only solution to this problem: do not spare any effort to learn statistics. Having a solid understanding of a basic regression analysis will help you in figuring out which statistical tools are applicable and, even more importantly, which will definitely misguide you. This is why I will give an general overview with some examples simulations but I will not explain here when and why you should use a particular tool or how to interpret the outputs. Want to know more? Attend my <em>Bayesian Statistics</em> seminar or read an excellent <a href="https://www.routledge.com/Statistical-Rethinking-A-Bayesian-Course-with-Examples-in-R-and-STAN/McElreath/p/book/9780367139919">Statistical Rethinking</a> by Richard McElreath that the seminar is based on.</p>
<p>Below, we will go through a number statistical analysis approaches and, for some, you will learn how to use resampling and permutation to obtain confidence intervals and p values, replicating the ones that parametric models produce. Hopefully, this should give you an intuition about where these values come from (the ones you see in the output are analytically derived solutions for when you would perform resampling and permutation for infinitely many iterations but the core idea is the same) and how you can compute them for simulations, power analysis, or when analytic estimates are not readily available. Grab the <a href="notebooks/Seminar%2014%20-%20statistics.Rmd">notebook</a>.</p>
<div id="correlation" class="section level2" number="14.1">
<h2><span class="header-section-number">14.1</span> Correlation</h2>
<p>In base R, you can use function <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/cor.html">cor()</a> to compute correlation. You have a choice of <code>method</code>, either <code>"pearson"</code> (default, <a href="https://en.wikipedia.org/wiki/Pearson_correlation_coefficient">Pearson’s product moment correlation coefficient</a>, <span class="math inline">\(\rho\)</span>), or rank-based <code>"kendall"</code> (<a href="https://en.wikipedia.org/wiki/Kendall_rank_correlation_coefficient">Kendall’s rank correlation coefficient</a>, <span class="math inline">\(\tau\)</span>) or <code>"spearman"</code> (<a href="https://en.wikipedia.org/wiki/Spearman%27s_rank_correlation_coefficient">Spearman’s rank correlation coefficient</a>, <span class="math inline">\(\rho\)</span>).</p>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="statistical-modeling.html#cb482-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> </span>
<span id="cb482-2"><a href="statistical-modeling.html#cb482-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb482-3"><a href="statistical-modeling.html#cb482-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">rnorm</span>(<span class="fu">n</span>(), x, <span class="fl">0.5</span>))</span>
<span id="cb482-4"><a href="statistical-modeling.html#cb482-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(df<span class="sc">$</span>x, df<span class="sc">$</span>y, <span class="at">method=</span><span class="st">&quot;pearson&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 0.9019981</code></pre>
<p>Alternatively, you can use <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/cor.test.html">cor.test()</a> that also computes test statistics and significance.</p>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="statistical-modeling.html#cb484-1" aria-hidden="true" tabindex="-1"></a>cor_result <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(df<span class="sc">$</span>x, df<span class="sc">$</span>y, <span class="at">method=</span><span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb484-2"><a href="statistical-modeling.html#cb484-2" aria-hidden="true" tabindex="-1"></a>cor_result</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  df$x and df$y
## t = 20.682, df = 98, p-value &lt; 2.2e-16
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.8575026 0.9331000
## sample estimates:
##       cor 
## 0.9019981</code></pre>
<p><code>cor.test</code> returns a list, so you can access its individual elements<a href="#fn65" class="footnote-ref" id="fnref65"><sup>65</sup></a> via a double-bracket or <code>$</code> notation.</p>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="statistical-modeling.html#cb486-1" aria-hidden="true" tabindex="-1"></a>cor_result<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 1.587873e-37</code></pre>
<p>Bayesian correlation with a full posterior distribution for the correlation coefficient and Bayes Factor as a measure of significance, can be computed via <code>correlationBF()</code> function, which is part of <a href="https://richarddmorey.github.io/BayesFactor">BayesFactor</a> package.</p>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="statistical-modeling.html#cb488-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(BayesFactor)</span>
<span id="cb488-2"><a href="statistical-modeling.html#cb488-2" aria-hidden="true" tabindex="-1"></a><span class="fu">correlationBF</span>(df<span class="sc">$</span>x, df<span class="sc">$</span>y)</span></code></pre></div>
<pre><code>## Bayes factor analysis
## --------------
## [1] Alt., r=0.333 : 1.018692e+33 ±0%
## 
## Against denominator:
##   Null, rho = 0 
## ---
## Bayes factor type: BFcorrelation, Jeffreys-beta*</code></pre>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="statistical-modeling.html#cb490-1" aria-hidden="true" tabindex="-1"></a>cor_bf <span class="ot">&lt;-</span> <span class="fu">correlationBF</span>(df<span class="sc">$</span>x, df<span class="sc">$</span>y, <span class="at">posterior =</span> <span class="cn">TRUE</span>, <span class="at">iterations=</span><span class="dv">1000</span>)</span>
<span id="cb490-2"><a href="statistical-modeling.html#cb490-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span><span class="cn">NULL</span>, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">c</span>(cor_bf[, <span class="st">&quot;rho&quot;</span>]))) <span class="sc">+</span> </span>
<span id="cb490-3"><a href="statistical-modeling.html#cb490-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">50</span>, ) <span class="sc">+</span> </span>
<span id="cb490-4"><a href="statistical-modeling.html#cb490-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Pearson&#39;s rho&quot;</span>)</span></code></pre></div>
<p><img src="data-analysis-using-r-for-psychology_files/figure-html/unnamed-chunk-341-1.png" width="672" /></p>
</div>
<div id="correlation-in-practice" class="section level2" number="14.2">
<h2><span class="header-section-number">14.2</span> Correlation in practice</h2>
<p>Let us practice computing and understanding the correlation using randomly generating data. First, let us compute Pearson’s correlation coefficient by hand. The formula is
<span class="math display">\[
r_{xy} = \frac{\sum_{i=1}^{n}(x_i-\hat{x})(y_i-\hat{y})}{\sqrt{\sum_{i=1}^{n}(x_i-\hat{x})^2}\sqrt{\sum_{i=1}^{n}(y_i-\hat{y})^2}}
\]</span>
where <span class="math inline">\(\hat{x}\)</span> and <span class="math inline">\(\hat{y}\)</span> are sample means for the corresponding variable. Thanks to vectorized nature of R, you <em>do not</em> need to use loops! Generate random data from normal distribution the way I did above. Generate variable <code>x</code> from standard normal distribution (<a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/Normal.html">rnorm()</a>, <span class="math inline">\(\mu=0\)</span>, <span class="math inline">\(\sigma=1\)</span>), generate a second variable from a normal distribution with <span class="math inline">\(\mu\)</span> defined by <code>x</code> and use a value of your choice for <span class="math inline">\(\sigma\)</span>. Compare your results with those of <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/cor.html">cor()</a> function.</p>
<pre><code>## cor(x, y) = 0.878730431189062, rxy = 0.878730431189062</code></pre>
<div class="infobox practice">
<p>Do exercise 1.</p>
</div>
<p>When interpreting correlation between two variables, your are interested not only in the estimate itself but also about your confidence about it. The <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/cor.test.html">cor.test()</a> function helps you in this by returning a 95% confidence interval. Let us <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/lapply.html">replicate</a> this via resampling approach you have learned about the last time. Recall the idea is to draw more samples from the distribution but, since we do cannot do this, we resample the data we have with replacement by assuming that our original sample is representative. Generate <code>x</code> and <code>y</code> as in exercise 1 and compute a percentile 95% confidence interval. For this, you will need to sample <em>pairs</em> of values with replacement. In other words, you need to sample <em>index</em> of elements. You can do it yourself or rely on <a href="https://stat.ethz.ch/R-manual/R-devel/library/boot/html/boot.html">boot()</a>). Once you computed correlation coefficients for 1000 samples drawn from original variables, compute and compare the 95% confidence interval with one reported by <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/cor.test.html">cor.test()</a>.</p>
<pre><code>## 95% CI via resampling: 0.974918..0.988283</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  x and y
## t = 52.538, df = 98, p-value &lt; 2.2e-16
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.9743617 0.9883520
## sample estimates:
##       cor 
## 0.9827071</code></pre>
<div class="infobox practice">
<p>Do exercise 2.</p>
</div>
<p>Next, let us see how noise in <code>y</code> (second variable) affect it strength. The approach will be very similar to how we explored with dependence between number of samples and our (un)certainty about the mean in the previous seminar. Write a function that will take two parameters: 1) number of samples and 2) standard deviation of noise. Generate variable <code>x</code> and <code>y</code> the same way as in exercise 1 but use the function parameter for <span class="math inline">\(\sigma\)</span> when generating <code>y</code>. Return the correlation coefficient. Next, create a tibble with various levels of standard deviation of noise with 1000 iterations (rows) per level. Compute correlation coefficient for every row (I have used <code>Nsamples = 30</code>) and then mean and 89%<a href="#fn66" class="footnote-ref" id="fnref66"><sup>66</sup></a> confidence interval for each level of noise. Plot it, so it looks similar to the plot below.
<img src="data-analysis-using-r-for-psychology_files/figure-html/unnamed-chunk-344-1.png" width="672" /></p>
<div class="infobox practice">
<p>Do exercise 3.</p>
</div>
<p>The analysis above explored how increased noise masks correlation between two samples of a <em>fixed</em> size. However, when you design a study you are more likely to be interested in an opposite question: what is your confidence about a <em>fixed strength</em> correlation (you figure out its value from the literature) given an increasing number of samples. This is the same logic that we applied to our confidence about mean. I have used <span class="math inline">\(\sigma_{noise} = 5.0\)</span> for the plot below.</p>
<p><img src="data-analysis-using-r-for-psychology_files/figure-html/unnamed-chunk-345-1.png" width="672" /></p>
<div class="infobox practice">
<p>Do exercise 4.</p>
</div>
</div>
<div id="pairwise-comparisons" class="section level2" number="14.3">
<h2><span class="header-section-number">14.3</span> Pairwise comparisons</h2>
<p>For pairwise comparisons for normally distributed data, you can use Student’s t-Test via <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/t.test.html">t.test()</a>. Here, I generate to <code>x</code> as a normally distributed normal variable and <code>y</code>, as a normally distributed variable random whose mean is <code>x + 0.3</code>. I am using library <a href="https://github.com/eclarke/ggbeeswarm">ggbeeswarm</a> to generate the nicely looking cloud of dots.</p>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb494-1"><a href="statistical-modeling.html#cb494-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">14454</span>)</span>
<span id="cb494-2"><a href="statistical-modeling.html#cb494-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> </span>
<span id="cb494-3"><a href="statistical-modeling.html#cb494-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb494-4"><a href="statistical-modeling.html#cb494-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> x <span class="sc">+</span> <span class="fl">0.3</span>, <span class="at">sd =</span> <span class="dv">1</span>))</span></code></pre></div>
<p><img src="data-analysis-using-r-for-psychology_files/figure-html/unnamed-chunk-347-1.png" width="672" /></p>
<p>You can perform <em>t-test</em> assuming that samples in two variables are independent</p>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="statistical-modeling.html#cb495-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(df<span class="sc">$</span>x, df<span class="sc">$</span>y, <span class="at">paired =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  df$x and df$y
## t = -1.8603, df = 184.37, p-value = 0.06443
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.65829852  0.01933491
## sample estimates:
## mean of x mean of y 
##  1.018298  1.337780</code></pre>
<p>Or, that they are paired (this matches how I generated the data), i.e., repeated-measures design (note the change in estimates, statistics, and significance).</p>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="statistical-modeling.html#cb497-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(df<span class="sc">$</span>x, df<span class="sc">$</span>y, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  df$x and df$y
## t = -3.3432, df = 99, p-value = 0.00117
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.5090948 -0.1298688
## sample estimates:
## mean of the differences 
##              -0.3194818</code></pre>
<p>A Bayesian version is provided via <code>ttestBF()</code> function, which is part of the <a href="https://richarddmorey.github.io/BayesFactor">BayesFactor</a> package.</p>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="statistical-modeling.html#cb499-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(BayesFactor)</span>
<span id="cb499-2"><a href="statistical-modeling.html#cb499-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ttestBF</span>(<span class="at">x =</span> df<span class="sc">$</span>x, <span class="at">y=</span>df<span class="sc">$</span>y, <span class="at">paired=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Bayes factor analysis
## --------------
## [1] Alt., r=0.707 : 19.27724 ±0%
## 
## Against denominator:
##   Null, mu = 0 
## ---
## Bayes factor type: BFoneSample, JZS</code></pre>
<p>For a non-parametric pairwise test, you can use Wilcoxon Rank Sum and Signed Rank Tests <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/wilcox.test.html">wilcox.test()</a>. Package <a href="http://coin.r-forge.r-project.org/">coin</a> implements many tests, including permutation tests, such as Two- and K-sample Fisher-Pitman permutation test via <code>oneway_test()</code> that tests for the equality of the distributions in <em>independent</em> groups, see <a href="https://cran.r-project.org/web/packages/coin/vignettes/coin.pdf">vignette</a> for details.</p>
</div>
<div id="t-tests-in-practice" class="section level2" number="14.4">
<h2><span class="header-section-number">14.4</span> T-tests in practice</h2>
<p>As with the correlation coefficient, let us generate data and compute the t-statistics by hand. The formula is
<span class="math display">\[t = \frac{\bar{X} - \mu_0}{s_D / \sqrt{n}}\]</span></p>
<p>where <span class="math inline">\(\bar{X}\)</span> and <span class="math inline">\(s_D\)</span> are the average and standard deviation of <em>difference</em> between all pairs, <span class="math inline">\(n\)</span> is the number of pairs, and <span class="math inline">\(\mu_0\)</span> is the null hypothesis for difference. In our case, we would like to know whether the difference is different from zero, thus, <span class="math inline">\(\mu_0 = 0\)</span>.</p>
<p>Generate random data similarly to how I did it in the example above. Compute t-statistic and compare it to the output of a <em>paired</em> <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/t.test.html">t.test()</a>.</p>
<pre><code>## t-statistic: -2.35394746408782</code></pre>
<pre><code>## 
##  Paired t-test
## 
## data:  x and y
## t = -2.3539, df = 99, p-value = 0.02055
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.42255491 -0.03601326
## sample estimates:
## mean of the differences 
##              -0.2292841</code></pre>
<div class="infobox practice">
<p>Do exercise 5.</p>
</div>
<p>Let us use resampling approach to replicate analytically derived confidence interval of difference between the means and the p-value. We start with the 95% confidence interval for the difference. The idea is the same as before when we computed the confidence interval for correlation: We sample both variables <em>pairwise</em>, compute the average difference, store it, repeat this 1000 times. Once we have 1000 resampled average distances, compute a percentile interval and compare it to one reported by <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/t.test.html">t.test()</a>.</p>
<pre><code>## resampled 95% percentile confidence interval: -0.525506556471162..-0.124136641013539</code></pre>
<pre><code>## 
##  Paired t-test
## 
## data:  x and y
## t = -3.0788, df = 99, p-value = 0.00269
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.5329613 -0.1152214
## sample estimates:
## mean of the differences 
##              -0.3240913</code></pre>
<div class="infobox practice">
<p>Do exercise 6.</p>
</div>
<p>Next comes the statistical significance testing via a <em>permutation test</em>. Here, we compute the t-statistic for the sample (you already know how to do that). Then, we pool values from both <code>x</code> and <code>y</code> into a single vector, shuffle that single vector and divide it back into permuted x (first half of the pooled vector) and permuted y (second half of the pooled vector). Then we compute the t-statistics for the difference between permuted vectors. We repeat this 10000 times to obtain a distribution of t-statistics that we would observe when pairing between <code>x</code> and <code>y</code> was random. Finally, we compute the proportion of values that are more extreme (smaller than, in our case) than the original value. This, effectively, is the probably of observing such extreme t-statistic by pure chance and is interpreted the same way as the p-value. Compare this to the output of the paired t-test using <code>alternative = "less"</code>:</p>
<p><img src="data-analysis-using-r-for-psychology_files/figure-html/unnamed-chunk-353-1.png" width="672" /></p>
<pre><code>## Proportion of t-statisic for permuted pairs &lt; t-stat for original: 0.2573</code></pre>
<pre><code>## 
##  Paired t-test
## 
## data:  x and y
## t = -0.65575, df = 99, p-value = 0.2568
## alternative hypothesis: true difference in means is less than 0
## 95 percent confidence interval:
##      -Inf 0.100426
## sample estimates:
## mean of the differences 
##             -0.06555021</code></pre>
<div class="infobox practice">
<p>Do exercise 7.</p>
</div>
</div>
<div id="formula-notation" class="section level2" number="14.5">
<h2><span class="header-section-number">14.5</span> Formula notation</h2>
<p>Using statistical models in R is particularly easy because most packages make use of a <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/formula.html">formula</a> to describe a model. Different functions and packages interpret the formula <em>mostly</em> the same way with differences arising due to how random effects or additional parameters are described. Here is an example of a formula:</p>
<div class="sourceCode" id="cb507"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb507-1"><a href="statistical-modeling.html#cb507-1" aria-hidden="true" tabindex="-1"></a>y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x1<span class="sc">:</span>x2</span></code></pre></div>
<p>It says that the outcome variable <code>y</code> should be a modeled as a linear combination of an intercept <code>1</code> (can be omitted in a formula), predictor variables <code>x1</code> and <code>x2</code>, plus their interaction <code>x1:x2</code>. This also assumes that all these variables are in a single table that you also supply to the function (that parameter is typically called <code>data</code>). Same formula can be shortened by using <code>*</code> which means “both predictors and their interaction” and omitting redundant intercept (it is always used unless you explicitly exclude it)</p>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="statistical-modeling.html#cb508-1" aria-hidden="true" tabindex="-1"></a>y <span class="sc">~</span> x1<span class="sc">*</span>x2</span></code></pre></div>
<p>You can also <em>exclude</em> specific terms via <code>-</code>. So, if you insist that the intercept <em>must</em> go through 0, you write “exclude intercept term” as <code>-1</code></p>
<div class="sourceCode" id="cb509"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb509-1"><a href="statistical-modeling.html#cb509-1" aria-hidden="true" tabindex="-1"></a>y <span class="sc">~</span> x1<span class="sc">*</span>x2 <span class="sc">-</span> <span class="dv">1</span></span></code></pre></div>
<p>Or you can exclude a specific term or an interaction. The two formulas below are equivalent with a main effect for <code>x2</code> and an interaction term but no main effect for <code>x1</code>. However, I would generally discourage you from using <code>-</code> as the first formula is much harder to understand (or, conversely, much easier to misunderstand).</p>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb510-1"><a href="statistical-modeling.html#cb510-1" aria-hidden="true" tabindex="-1"></a>y <span class="sc">~</span> x1<span class="sc">*</span>x2 <span class="sc">-</span> x1</span>
<span id="cb510-2"><a href="statistical-modeling.html#cb510-2" aria-hidden="true" tabindex="-1"></a>y <span class="sc">~</span> x2 <span class="sc">+</span> x1<span class="sc">:</span>x2</span></code></pre></div>
</div>
<div id="using-t-test-via-formula" class="section level2" number="14.6">
<h2><span class="header-section-number">14.6</span> Using t-test via formula</h2>
<p>When we used <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/t.test.html">t.test()</a> above, we specified two vectors. However, you can also use a table where one column contains <em>values</em> and another one <em>group labels</em>. Here, we estimate difference in mean <code>x</code> between two <code>group</code>s.</p>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb511-1"><a href="statistical-modeling.html#cb511-1" aria-hidden="true" tabindex="-1"></a>yA <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb511-2"><a href="statistical-modeling.html#cb511-2" aria-hidden="true" tabindex="-1"></a>yB <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> yA <span class="sc">+</span> <span class="fl">0.1</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb511-3"><a href="statistical-modeling.html#cb511-3" aria-hidden="true" tabindex="-1"></a>df_group <span class="ot">&lt;-</span></span>
<span id="cb511-4"><a href="statistical-modeling.html#cb511-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">y =</span> <span class="fu">c</span>(yA, yB),</span>
<span id="cb511-5"><a href="statistical-modeling.html#cb511-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;A&quot;</span>, <span class="dv">100</span>), <span class="fu">rep</span>(<span class="st">&quot;B&quot;</span>, <span class="dv">100</span>))))</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:right;">
y
</th>
<th style="text-align:left;">
group
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
2.2309282
</td>
<td style="text-align:left;">
A
</td>
</tr>
<tr>
<td style="text-align:right;">
1.0449518
</td>
<td style="text-align:left;">
A
</td>
</tr>
<tr>
<td style="text-align:right;">
0.8420765
</td>
<td style="text-align:left;">
A
</td>
</tr>
<tr>
<td style="text-align:right;">
0.2378746
</td>
<td style="text-align:left;">
A
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb512-1"><a href="statistical-modeling.html#cb512-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(y <span class="sc">~</span> group, <span class="at">data=</span>df_group, <span class="at">paired=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  y by group
## t = -0.32625, df = 99, p-value = 0.7449
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.2185310  0.1568153
## sample estimates:
## mean of the differences 
##             -0.03085788</code></pre>
</div>
<div id="anova" class="section level2" number="14.7">
<h2><span class="header-section-number">14.7</span> ANOVA</h2>
<p><strong>AN</strong>alysis <strong>O</strong>f <strong>VA</strong>riance is probably the most widely used analysis in social sciences. However, I would strongly suggest considering <a href="statistical-modeling.html#GLMM">generalized linear mixed models</a> instead. Unlike ANOVA they can work when residuals are not normally distributed (binomial, count, Likert-scale ordered categorical, proportions data, etc.), they can tolerate missing values, and they tend to overfit less (their results are likely to better generalize to future data) by assuming that individual participants are more average than they appear in the raw data (so-called shrinkage).</p>
<p>First, let us simulate data for ten participants and their responses, assuming that condition <code>B</code> increases their responses by 2 (arbitrary) units and <code>C</code> by 3<a href="#fn67" class="footnote-ref" id="fnref67"><sup>67</sup></a>.</p>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb514-1"><a href="statistical-modeling.html#cb514-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">519264</span>)</span>
<span id="cb514-2"><a href="statistical-modeling.html#cb514-2" aria-hidden="true" tabindex="-1"></a>df_anova <span class="ot">&lt;-</span></span>
<span id="cb514-3"><a href="statistical-modeling.html#cb514-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># generate ten participants with five trials per condition</span></span>
<span id="cb514-4"><a href="statistical-modeling.html#cb514-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_grid</span>(<span class="at">Participant  =</span> <span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>),</span>
<span id="cb514-5"><a href="statistical-modeling.html#cb514-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">Condition =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;A&quot;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&quot;B&quot;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&quot;C&quot;</span>, <span class="dv">3</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb514-6"><a href="statistical-modeling.html#cb514-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb514-7"><a href="statistical-modeling.html#cb514-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># decide on a SINGLE baseline (intercept) for each participant</span></span>
<span id="cb514-8"><a href="statistical-modeling.html#cb514-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Participant) <span class="sc">%&gt;%</span></span>
<span id="cb514-9"><a href="statistical-modeling.html#cb514-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Intercept =</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="fl">2.5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb514-10"><a href="statistical-modeling.html#cb514-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb514-11"><a href="statistical-modeling.html#cb514-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># simulate normally distributed responses, assuming that are 3 units higher for condition &quot;B&quot;</span></span>
<span id="cb514-12"><a href="statistical-modeling.html#cb514-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb514-13"><a href="statistical-modeling.html#cb514-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Response =</span> <span class="fu">rnorm</span>(<span class="fu">n</span>(), Intercept <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">as.integer</span>(Condition <span class="sc">==</span> <span class="st">&quot;B&quot;</span>) <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fu">as.integer</span>(Condition <span class="sc">==</span> <span class="st">&quot;C&quot;</span>), <span class="fl">1.5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb514-14"><a href="statistical-modeling.html#cb514-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Intercept)</span></code></pre></div>
<p><img src="data-analysis-using-r-for-psychology_files/figure-html/unnamed-chunk-358-1.png" width="672" />
The base R ANOVA function is called <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/aov.html">aov()</a>, however, it does not support repeated measures. Instead, you can use function <code>anova_test</code> from package <a href="https://github.com/kassambara/rstatix">rstatix</a></p>
<p>For the <em>repeated-measures</em> ANOVA, we need to specify column with identity of participants via parameter <code>wid</code></p>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb515-1"><a href="statistical-modeling.html#cb515-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb515-2"><a href="statistical-modeling.html#cb515-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova_test</span>(<span class="at">data=</span>df_anova, Response <span class="sc">~</span> Condition, <span class="at">wid=</span>Participant)</span></code></pre></div>
<pre><code>## ANOVA Table (type II tests)
## 
##      Effect DFn DFd     F     p p&lt;.05   ges
## 1 Condition   2  87 7.418 0.001     * 0.146</code></pre>
<p>You can perform various pairwise post-hoc tests, e.g. Tukey</p>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb517-1"><a href="statistical-modeling.html#cb517-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tukey_hsd</span>(df_anova, Response <span class="sc">~</span> Condition)</span></code></pre></div>
<div class="sourceCode" id="cb518"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb518-1"><a href="statistical-modeling.html#cb518-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tukey_hsd</span>(df_anova, Response <span class="sc">~</span> Condition) <span class="sc">%&gt;%</span></span>
<span id="cb518-2"><a href="statistical-modeling.html#cb518-2" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:left;">
group1
</th>
<th style="text-align:left;">
group2
</th>
<th style="text-align:right;">
null.value
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
conf.low
</th>
<th style="text-align:right;">
conf.high
</th>
<th style="text-align:right;">
p.adj
</th>
<th style="text-align:left;">
p.adj.signif
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Condition
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.8015391
</td>
<td style="text-align:right;">
0.2763798
</td>
<td style="text-align:right;">
3.326698
</td>
<td style="text-align:right;">
0.01640
</td>
<td style="text-align:left;">
<ul>
<li></td>
</tr>
<tr>
<td style="text-align:left;">
Condition
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2.3560918
</td>
<td style="text-align:right;">
0.8309325
</td>
<td style="text-align:right;">
3.881251
</td>
<td style="text-align:right;">
0.00115
</td>
<td style="text-align:left;">
**
</td>
</tr>
<tr>
<td style="text-align:left;">
Condition
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.5545527
</td>
<td style="text-align:right;">
-0.9706066
</td>
<td style="text-align:right;">
2.079712
</td>
<td style="text-align:right;">
0.66200
</td>
<td style="text-align:left;">
ns
</td>
</tr>
</tbody>
</table></li>
</ul>
<p>A Bayesian ANOVA with posterior distributions for individual coefficients and significance via Bayes Factor can be performed
via <code>anovaBF</code> function from <a href="https://richarddmorey.github.io/BayesFactor">BayesFactor</a> package.</p>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb519-1"><a href="statistical-modeling.html#cb519-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anovaBF</span>(Response <span class="sc">~</span> Condition <span class="sc">+</span> Participant, <span class="at">whichRandom=</span><span class="st">&quot;Participant&quot;</span>, <span class="at">data=</span><span class="fu">data.frame</span>(df_anova))</span></code></pre></div>
<pre><code>## Bayes factor analysis
## --------------
## [1] Condition + Participant : 55450.04 ±0.85%
## 
## Against denominator:
##   Response ~ Participant 
## ---
## Bayes factor type: BFlinearModel, JZS</code></pre>
<p>If you decide for repeated-measure ANOVA, I would suggest using and reporting results for both frequentist and Bayesian ANOVA, as it will demonstrate that they do not depend on the choice of the statistical approach.</p>
</div>
<div id="almost-everything-is-a-linear-regression-model" class="section level2" number="14.8">
<h2><span class="header-section-number">14.8</span> (Almost) everything is a linear regression model</h2>
<p>Even though linear models did not appear as the first on the list, they are. All approaches that we covered so far, correlation, t-test, ANOVA, and many more (MANOVA, ANCOVA, etc.) a linear regression models. They may not <em>look</em> like linear regression models and even the formulas that we used, e.g., for t-test, do not look as if they have anything to do with linear regression, but they are. Here is a simple demonstration where I use the same code to generate data for running a t-test on a table. For a single two-level categorical variable, a t-test is equivalent to one-way ANOVA (note matching p-values).</p>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb521-1"><a href="statistical-modeling.html#cb521-1" aria-hidden="true" tabindex="-1"></a>yA <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb521-2"><a href="statistical-modeling.html#cb521-2" aria-hidden="true" tabindex="-1"></a>yB <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> yA <span class="sc">+</span> <span class="fl">0.1</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb521-3"><a href="statistical-modeling.html#cb521-3" aria-hidden="true" tabindex="-1"></a>df_group <span class="ot">&lt;-</span></span>
<span id="cb521-4"><a href="statistical-modeling.html#cb521-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">y =</span> <span class="fu">c</span>(yA, yB),</span>
<span id="cb521-5"><a href="statistical-modeling.html#cb521-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;A&quot;</span>, <span class="dv">100</span>), <span class="fu">rep</span>(<span class="st">&quot;B&quot;</span>, <span class="dv">100</span>))))</span>
<span id="cb521-6"><a href="statistical-modeling.html#cb521-6" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(y <span class="sc">~</span> group, <span class="at">data =</span> df_group)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  y by group
## t = 0.24858, df = 180.05, p-value = 0.804
## alternative hypothesis: true difference in means between group A and group B is not equal to 0
## 95 percent confidence interval:
##  -0.2663616  0.3431457
## sample estimates:
## mean in group A mean in group B 
##       0.9997196       0.9613275</code></pre>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb523-1"><a href="statistical-modeling.html#cb523-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(y <span class="sc">~</span> group, <span class="at">data =</span> df_group))</span></code></pre></div>
<pre><code>##              Df Sum Sq Mean Sq F value Pr(&gt;F)
## group         1   0.07  0.0737   0.062  0.804
## Residuals   198 236.15  1.1927</code></pre>
<p>However, we can ask R to show summary <em>as if</em> it was a linear model via <code>summary.lm()</code> function (<code>.lm</code> means that we call summary method for an <code>lm</code> linear model object). Again, note matching p-value for <code>group</code> parameter but also that now we can see the slope estimate for it.</p>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="statistical-modeling.html#cb525-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.lm</span>(<span class="fu">aov</span>(y <span class="sc">~</span> group, <span class="at">data =</span> df_group))</span></code></pre></div>
<pre><code>## 
## Call:
## aov(formula = y ~ group, data = df_group)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -3.15527 -0.76406 -0.05814  0.71729  2.95763 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.99972    0.10921   9.154   &lt;2e-16 ***
## groupB      -0.03839    0.15444  -0.249    0.804    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.092 on 198 degrees of freedom
## Multiple R-squared:  0.000312,   Adjusted R-squared:  -0.004737 
## F-statistic: 0.06179 on 1 and 198 DF,  p-value: 0.8039</code></pre>
<p>The take home message here is that virtually all of the commonly used statistical analyses are linear regression custom tailored for a specific usage case and given a cool label. Because of that it might <em>look</em> like there are big differences between methods but in reality they differ mostly in kind (only categorical, only continuous, both) and number of variables, plus on which parameters you interpret and which you “ignore” as random effects. Again, this is a very large topic in itself and I can only encourage you once again to make a deeper dive in statistics via <a href="https://www.routledge.com/Statistical-Rethinking-A-Bayesian-Course-with-Examples-in-R-and-STAN/McElreath/p/book/9780367139919">Statistical Rethinking</a> book (or, if you a student at Uni Bamberg, join my seminar).</p>
</div>
<div id="GLMM" class="section level2" number="14.9">
<h2><span class="header-section-number">14.9</span> (Generalized) Linear Models</h2>
<p>Base R provides function to perform linear regression <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/lm.html">lm()</a> and generalized linear models <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/glm.html">glm()</a> for binomial, count, and other types of data.</p>
<p>Let us generate a simple linear dependence between two parameters and see how <code>lm()</code> will infer the dependence. Our formula will be
<span class="math display">\[ y = 20 + 4 * x + \epsilon\]</span>
where <span class="math inline">\(\epsilon\)</span> is normally distributed noise.</p>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="statistical-modeling.html#cb527-1" aria-hidden="true" tabindex="-1"></a>df_lm <span class="ot">&lt;-</span></span>
<span id="cb527-2"><a href="statistical-modeling.html#cb527-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb527-3"><a href="statistical-modeling.html#cb527-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">rnorm</span>(<span class="fu">n</span>(), <span class="dv">20</span> <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> x, <span class="dv">50</span>))</span></code></pre></div>
<p><img src="data-analysis-using-r-for-psychology_files/figure-html/unnamed-chunk-365-1.png" width="672" /></p>
<p>Now let us fit the linear model using formula <code>y ~ x</code> and use <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/summary.lm.html">summary()</a> function to see the details.</p>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="statistical-modeling.html#cb528-1" aria-hidden="true" tabindex="-1"></a>lm_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data=</span>df_lm)</span>
<span id="cb528-2"><a href="statistical-modeling.html#cb528-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x, data = df_lm)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -117.254  -41.577    9.094   38.678  147.265 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  18.2680    10.4880   1.742   0.0847 .  
## x             4.1241     0.1803  22.873   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 52.05 on 98 degrees of freedom
## Multiple R-squared:  0.8422, Adjusted R-squared:  0.8406 
## F-statistic: 523.2 on 1 and 98 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>As you can see, values for both intercept and the slope are very close to our original. If you need to extract information about individual coefficients, I recommend <a href="https://broom.tidymodels.org/reference/tidy.lm.html">tidy()</a> function from <a href="https://github.com/tidymodels/broom">broom</a> package that returns information about the model in a “tidy” format:</p>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb530-1"><a href="statistical-modeling.html#cb530-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb530-2"><a href="statistical-modeling.html#cb530-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm_fit)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
18.267956
</td>
<td style="text-align:right;">
10.4880101
</td>
<td style="text-align:right;">
1.741794
</td>
<td style="text-align:right;">
0.0846821
</td>
</tr>
<tr>
<td style="text-align:left;">
x
</td>
<td style="text-align:right;">
4.124118
</td>
<td style="text-align:right;">
0.1803059
</td>
<td style="text-align:right;">
22.872893
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
</tbody>
</table>
</div>
<div id="resampling-a-linear-model" class="section level2" number="14.10">
<h2><span class="header-section-number">14.10</span> Resampling a linear model</h2>
<p>same rules still apply when We perform linear regression explicitly as linear regression (and not packaged as some statistical test): We are not interested in estimates alone but in our confidence (uncertainty) about them and about probability of a null hypothesis (e.g., an actual parameter value is zero). <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/lm.html">lm()</a> function produces analytically derived estimates based on the same idea of drawing (infinitely) more samples from the “true” distribution. Let us repeat the same resampling (for confidence interval) and permutation (for statistical significance) tricks.</p>
<p>Generate a table with data with 30 values for <code>x</code> drawn from a normal distribution with zero mean and standard deviation of 10. <span class="math inline">\(y = 20 +3 \cdot x + \epsilon\)</span>, where <span class="math inline">\(\epsilon ~ Normal(0, 50)\)</span>, i.e., noise comes from a normal distribution centered at zero with standard deviation of 50.
<img src="data-analysis-using-r-for-psychology_files/figure-html/unnamed-chunk-368-1.png" width="672" /></p>
<pre><code>## 
## Call:
## lm(formula = y ~ x, data = df_lm)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -83.317 -28.098  -4.514  30.695  84.269 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)   1.7296     8.1681   0.212   0.8338  
## x             0.8722     0.4153   2.100   0.0448 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 44.74 on 28 degrees of freedom
## Multiple R-squared:  0.1361, Adjusted R-squared:  0.1053 
## F-statistic: 4.411 on 1 and 28 DF,  p-value: 0.04483</code></pre>
<p>Our first task is to resample <code>x</code> and <code>y</code> pairwise (<a href="https://dplyr.tidyverse.org/reference/slice.html">slice_sample()</a> is one way to do this), fit lenear model to the resampled data, and extract coefficients via <a href="https://broom.tidymodels.org/reference/tidy.lm.html">tidy()</a>. Repeat that 1000 times to obtain a table with parameters and their estimates. There are different ways you can implement this. I have opted repeat it 1000 times via <a href="https://purrr.tidyverse.org/reference/map.html">map_dfr()</a> that combines all tidy coefficient tables into a single table by row. Note that there was no need from me to write a separate function, as I have simply nested calls to <a href="https://broom.tidymodels.org/reference/tidy.lm.html">tidy()</a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/lm.html">lm()</a>, and <a href="(https://dplyr.tidyverse.org/reference/slice.html)">slice_sample())</a>. Once you have samples it is a simple task to compute confidence interval for <code>estimate</code> of each parameter (grouping data is easy, right?). To compare this to analytically estimated 95% confidence intervals that you can compute from a fitted linear model via <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/confint.html">confint()</a> function.</p>
<table>
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
Lower 95% CI
</th>
<th style="text-align:right;">
Upper 95% CI
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
-13.0543641
</td>
<td style="text-align:right;">
16.209992
</td>
</tr>
<tr>
<td style="text-align:left;">
x
</td>
<td style="text-align:right;">
-0.0407846
</td>
<td style="text-align:right;">
1.749849
</td>
</tr>
</tbody>
</table>
<pre><code>##                    2.5 %    97.5 %
## (Intercept) -15.00188381 18.461150
## x             0.02155481  1.722767</code></pre>
<div class="infobox practice">
<p>Do exercise 8.</p>
</div>
<p>Next stop, statistical significance for <code>x</code>. Our null hypothesis is that pairing of <code>x</code> and <code>y</code> in our data is accidental and the statistic (that characterizes the strength of the dependence) that we observed happened just by chance. We test this idea by permuting the <code>x</code> which results in different <code>x</code>×<code>y</code> pairs, fit the model and record statistic <em>for x</em> for that random pairing. Once we repeat this process 1000 times we have our distribution of statistic assuming that pairing between <code>x</code> and <code>y</code> is accidental. Next we only need to compute the proportion of <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/MathFun.html">absolute</a>) statistic values that are more extreme than the absolute value of the original statistic. Note that as we permute <code>x</code>, our inference are applicable <em>only</em> to <code>x</code>. Thus, here we only need to record t value (statistic) for <code>x</code> and it could be more convenient to put them into a single vector. Extracting this information in R is a bit cumbersome. First, you need to get a <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/summary.lm.html">summary()</a>, then get a <code>$coef</code> attribute with a table of coefficients, and then get the <em>t value</em> for <code>x</code>. Here’s how you do this step by step.</p>
<p>This gives you the summary:</p>
<div class="sourceCode" id="cb533"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb533-1"><a href="statistical-modeling.html#cb533-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x, df_lm))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x, data = df_lm)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -83.317 -28.098  -4.514  30.695  84.269 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)   1.7296     8.1681   0.212   0.8338  
## x             0.8722     0.4153   2.100   0.0448 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 44.74 on 28 degrees of freedom
## Multiple R-squared:  0.1361, Adjusted R-squared:  0.1053 
## F-statistic: 4.411 on 1 and 28 DF,  p-value: 0.04483</code></pre>
<p>This, only the coefficients table:</p>
<div class="sourceCode" id="cb535"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb535-1"><a href="statistical-modeling.html#cb535-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x, df_lm))<span class="sc">$</span>coef</span></code></pre></div>
<pre><code>##              Estimate Std. Error   t value   Pr(&gt;|t|)
## (Intercept) 1.7296329  8.1680621 0.2117556 0.83383155
## x           0.8721608  0.4152524 2.1003149 0.04483337</code></pre>
<p>This, a single value <em>t value</em> for <code>x</code>:</p>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb537-1"><a href="statistical-modeling.html#cb537-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x, df_lm))<span class="sc">$</span>coef[<span class="st">&quot;x&quot;</span>, <span class="st">&quot;t value&quot;</span>]</span></code></pre></div>
<pre><code>## [1] 2.100315</code></pre>
<p>This way, you can use <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/lapply.html">replicate()</a>, combining all <em>t values</em> from permuted-and-fitted models into a single vector. I have used 2000 replications to get a more accurate probability (but this does take more time, of course).</p>
<pre><code>## Probability to observe more extreme t value by chance: 0.0485</code></pre>
<pre><code>##   Estimate Std. Error    t value   Pr(&gt;|t|) 
## 0.87216077 0.41525239 2.10031487 0.04483337</code></pre>
<div class="infobox practice">
<p>Do exercise 9.</p>
</div>
</div>
<div id="generalized-linear-mixed-models" class="section level2" number="14.11">
<h2><span class="header-section-number">14.11</span> (Generalized) Linear Mixed Models</h2>
<p>Generalized linear mixed models allow you to incorporate information about random factors into the model. One of the most popular packages in R is <a href="https://github.com/lme4/lme4">lme4</a>. Let us use LMM on data we generated for ANOVA. Here, we specify that we would like to have individual slopes for each participants via <code>(1|Participant)</code> notation<a href="#fn68" class="footnote-ref" id="fnref68"><sup>68</sup></a>.</p>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="statistical-modeling.html#cb541-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb541-2"><a href="statistical-modeling.html#cb541-2" aria-hidden="true" tabindex="-1"></a>lmer_fit <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Response <span class="sc">~</span> Condition <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Participant), <span class="at">data=</span>df_anova)</span>
<span id="cb541-3"><a href="statistical-modeling.html#cb541-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmer_fit)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: Response ~ Condition + (1 | Participant)
##    Data: df_anova
## 
## REML criterion at convergence: 359.6
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -2.3188 -0.7330 -0.1038  0.8131  2.0589 
## 
## Random effects:
##  Groups      Name        Variance Std.Dev.
##  Participant (Intercept) 3.966    1.991   
##  Residual                2.444    1.563   
## Number of obs: 90, groups:  Participant, 10
## 
## Fixed effects:
##             Estimate Std. Error t value
## (Intercept)   4.5005     0.6914   6.509
## ConditionB    1.8015     0.4037   4.463
## ConditionC    2.3561     0.4037   5.836
## 
## Correlation of Fixed Effects:
##            (Intr) CndtnB
## ConditionB -0.292       
## ConditionC -0.292  0.500</code></pre>
<p>To get tidy summary you need to use function <code>tidy</code> but from <a href="https://github.com/bbolker/broom.mixed">broom.mixed</a> library</p>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb543-1"><a href="statistical-modeling.html#cb543-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.mixed)</span>
<span id="cb543-2"><a href="statistical-modeling.html#cb543-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmer_fit)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
effect
</th>
<th style="text-align:left;">
group
</th>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
statistic
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
fixed
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
4.500512
</td>
<td style="text-align:right;">
0.6914189
</td>
<td style="text-align:right;">
6.509097
</td>
</tr>
<tr>
<td style="text-align:left;">
fixed
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
ConditionB
</td>
<td style="text-align:right;">
1.801539
</td>
<td style="text-align:right;">
0.4036827
</td>
<td style="text-align:right;">
4.462760
</td>
</tr>
<tr>
<td style="text-align:left;">
fixed
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
ConditionC
</td>
<td style="text-align:right;">
2.356092
</td>
<td style="text-align:right;">
0.4036827
</td>
<td style="text-align:right;">
5.836495
</td>
</tr>
<tr>
<td style="text-align:left;">
ran_pars
</td>
<td style="text-align:left;">
Participant
</td>
<td style="text-align:left;">
sd__(Intercept)
</td>
<td style="text-align:right;">
1.991432
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
ran_pars
</td>
<td style="text-align:left;">
Residual
</td>
<td style="text-align:left;">
sd__Observation
</td>
<td style="text-align:right;">
1.563456
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>
<p>To also get information about formal statistical significance, you can use an extension package <a href="https://github.com/runehaubo/lmerTestR">lmerTest</a><a href="#fn69" class="footnote-ref" id="fnref69"><sup>69</sup></a>.</p>
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb544-1"><a href="statistical-modeling.html#cb544-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb544-2"><a href="statistical-modeling.html#cb544-2" aria-hidden="true" tabindex="-1"></a>lmert_fit <span class="ot">&lt;-</span> lmerTest<span class="sc">::</span><span class="fu">lmer</span>(Response <span class="sc">~</span> Condition <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Participant), <span class="at">data=</span>df_anova)</span>
<span id="cb544-3"><a href="statistical-modeling.html#cb544-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmert_fit)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
## lmerModLmerTest]
## Formula: Response ~ Condition + (1 | Participant)
##    Data: df_anova
## 
## REML criterion at convergence: 359.6
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -2.3188 -0.7330 -0.1038  0.8131  2.0589 
## 
## Random effects:
##  Groups      Name        Variance Std.Dev.
##  Participant (Intercept) 3.966    1.991   
##  Residual                2.444    1.563   
## Number of obs: 90, groups:  Participant, 10
## 
## Fixed effects:
##             Estimate Std. Error      df t value Pr(&gt;|t|)    
## (Intercept)   4.5005     0.6914 11.4337   6.509 3.64e-05 ***
## ConditionB    1.8015     0.4037 78.0000   4.463 2.69e-05 ***
## ConditionC    2.3561     0.4037 78.0000   5.836 1.16e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##            (Intr) CndtnB
## ConditionB -0.292       
## ConditionC -0.292  0.500</code></pre>
<p>Again, we can use <code>tidy</code> to get coefficients information in a single table.</p>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb546-1"><a href="statistical-modeling.html#cb546-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmert_fit)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
effect
</th>
<th style="text-align:left;">
group
</th>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
fixed
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
4.500512
</td>
<td style="text-align:right;">
0.6914189
</td>
<td style="text-align:right;">
6.509097
</td>
<td style="text-align:right;">
11.43367
</td>
<td style="text-align:right;">
3.64e-05
</td>
</tr>
<tr>
<td style="text-align:left;">
fixed
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
ConditionB
</td>
<td style="text-align:right;">
1.801539
</td>
<td style="text-align:right;">
0.4036827
</td>
<td style="text-align:right;">
4.462760
</td>
<td style="text-align:right;">
78.00000
</td>
<td style="text-align:right;">
2.69e-05
</td>
</tr>
<tr>
<td style="text-align:left;">
fixed
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
ConditionC
</td>
<td style="text-align:right;">
2.356092
</td>
<td style="text-align:right;">
0.4036827
</td>
<td style="text-align:right;">
5.836495
</td>
<td style="text-align:right;">
78.00000
</td>
<td style="text-align:right;">
1.00e-07
</td>
</tr>
<tr>
<td style="text-align:left;">
ran_pars
</td>
<td style="text-align:left;">
Participant
</td>
<td style="text-align:left;">
sd__(Intercept)
</td>
<td style="text-align:right;">
1.991432
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
ran_pars
</td>
<td style="text-align:left;">
Residual
</td>
<td style="text-align:left;">
sd__Observation
</td>
<td style="text-align:right;">
1.563456
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>
<p>Note that <code>lmer()</code> functions provide information about difference of each condition to the baseline (condition <code>A</code>) not no ANOVA-style significance for the “overall” effect of condition. For this, you can use function <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/add1.html">drop1</a>, which test for a variable significance by dropping it from a model and checking whether it performed significantly worse <em>without</em> it.</p>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb547-1"><a href="statistical-modeling.html#cb547-1" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(lmert_fit)</span></code></pre></div>
<pre><code>## Single term deletions using Satterthwaite&#39;s method:
## 
## Model:
## Response ~ Condition + (1 | Participant)
##           Sum Sq Mean Sq NumDF DenDF F value    Pr(&gt;F)    
## Condition 91.042  45.521     2    78  18.623 2.446e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>You can also use Bayesian generalized linear modeling via <a href="https://mc-stan.org/rstanarm/">rstanarm</a> and <a href="https://github.com/paul-buerkner/brms">BRMS</a> packages. The former is somewhat faster, as it does not require model compilation (makes big difference when data is small but you test a lot of models), but is less flexible.</p>
</div>
<div id="disclaimer-repeated" class="section level2" number="14.12">
<h2><span class="header-section-number">14.12</span> Disclaimer, repeated</h2>
<p>The material above gives an <em>overview</em> of how to carry out statistical analysis in R but it is by no means exhaustive, nor deep enough to master it. I can only encourage you to again to learn a particular statistical analysis first, building an intuition of how it works and when it is valid, and only then to figure our which package and function in R can be used to run it.</p>

<p># Practice {#seminar12}</p>
<p>Today we will practice tidying up and plotting an almost real data. The <em>structure</em> of the table is real, I’ve used it precisely because it is a sort of messy, untidy data you often get. The <em>actual values</em> are, however, fake. Well, not fake, simulated! But that means that you should not use this particular data to make any inferences about Stroop task, which is what the original experiment was about.</p>
<p>Here is the back story. Once upon a time, an experiment with the <a href="https://en.wikipedia.org/wiki/Stroop_effect">Stroop task</a> was performed. There four different conditions, one control one, of course. And a continuous physiological signal (similar to skin conductance) was measured at five time points: 0) sometime before the task, 1) right before the task, 2) after first block, 3) after the second block, 4) 15 minutes after the task. What we would like to establish:</p>
<ul>
<li>Did the task work in principle? I.e., do we see more errors and longer response times for when color and word were incongruent?</li>
<li>Was there an effect of conditions on either the error count or response times?</li>
<li>Was out physiological signal different at different time-points? Particularly, if we compare it before the task and after a congruent or incongruent blocks?</li>
</ul>
<p>Download <a href="data/stroopsim.csv">stroopsim.csv</a> the table, read it, and read on to understand what individual columns mean and how we need to transform the table before it becomes usable. Create a markdown notebook yourself, make sure it is clearly structured!</p>
<table>
<thead>
<tr>
<th style="text-align:right;">
sex
</th>
<th style="text-align:right;">
Condition
</th>
<th style="text-align:right;">
IncongruentFirst
</th>
<th style="text-align:right;">
@#errorsCong
</th>
<th style="text-align:right;">
ReactiontimemeanCong
</th>
<th style="text-align:right;">
@#errorsInco
</th>
<th style="text-align:right;">
ReactiontimemeanInco
</th>
<th style="text-align:right;">
S0A
</th>
<th style="text-align:right;">
S1A
</th>
<th style="text-align:right;">
S2A
</th>
<th style="text-align:right;">
S3A
</th>
<th style="text-align:right;">
S4A
</th>
<th style="text-align:right;">
Bs0
</th>
<th style="text-align:right;">
Bs1
</th>
<th style="text-align:right;">
Bs2
</th>
<th style="text-align:right;">
Bs3
</th>
<th style="text-align:right;">
Bs4
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1.477454
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
3.247461
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
6.490969
</td>
<td style="text-align:right;">
4.564023
</td>
<td style="text-align:right;">
6.354532
</td>
<td style="text-align:right;">
5.224722
</td>
<td style="text-align:right;">
12.339243
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2.028072
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
2.408471
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
4.864416
</td>
<td style="text-align:right;">
7.957840
</td>
<td style="text-align:right;">
6.587935
</td>
<td style="text-align:right;">
3.044139
</td>
<td style="text-align:right;">
2.909219
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.334083
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
2.676602
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
10.071530
</td>
<td style="text-align:right;">
1.650143
</td>
<td style="text-align:right;">
1.562964
</td>
<td style="text-align:right;">
6.156831
</td>
<td style="text-align:right;">
8.045311
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1.171517
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2.471265
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
12.162085
</td>
<td style="text-align:right;">
4.796817
</td>
<td style="text-align:right;">
2.649034
</td>
<td style="text-align:right;">
2.019965
</td>
<td style="text-align:right;">
5.061974
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2.097203
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
2.255469
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
3.265458
</td>
<td style="text-align:right;">
7.900660
</td>
<td style="text-align:right;">
4.254162
</td>
<td style="text-align:right;">
16.426251
</td>
<td style="text-align:right;">
6.177225
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1.322103
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
2.626870
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
5.478926
</td>
<td style="text-align:right;">
5.845528
</td>
<td style="text-align:right;">
6.175421
</td>
<td style="text-align:right;">
4.388986
</td>
<td style="text-align:right;">
2.740655
</td>
</tr>
</tbody>
</table>
</div>
<div id="bad-names-to-good-names" class="section level2" number="14.13">
<h2><span class="header-section-number">14.13</span> Bad names to good names</h2>
<p>We have a couple of columns that are not easy to use:</p>
<ul>
<li><code>@#errorsCong</code> should be <code>errorsCongruent</code></li>
<li><code>@#errorsInco</code> should be <code>errorsIncongruent</code></li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:right;">
sex
</th>
<th style="text-align:right;">
Condition
</th>
<th style="text-align:right;">
errorsCongruent
</th>
<th style="text-align:right;">
errorsIncongruent
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
12
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
18
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
20
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
6
</td>
</tr>
</tbody>
</table>
</div>
<div id="participant-id" class="section level2" number="14.14">
<h2><span class="header-section-number">14.14</span> Participant ID</h2>
<p>Currently, we have a <em>wide</em> table with one row per participant. However, we will need to tidy it up, meaning that we need to keep track of which rows belong to which participants. For this, create a new column <code>HabitNr</code> which will simply have row index. To make things easier, use <a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate()</a> verb to make it the <em>first</em> column in the table.</p>
<table>
<thead>
<tr>
<th style="text-align:right;">
HabitNr
</th>
<th style="text-align:right;">
sex
</th>
<th style="text-align:right;">
Condition
</th>
<th style="text-align:right;">
IncongruentFirst
</th>
<th style="text-align:right;">
errorsCongruent
</th>
<th style="text-align:right;">
ReactiontimemeanCong
</th>
<th style="text-align:right;">
errorsIncongruent
</th>
<th style="text-align:right;">
ReactiontimemeanInco
</th>
<th style="text-align:right;">
S0A
</th>
<th style="text-align:right;">
S1A
</th>
<th style="text-align:right;">
S2A
</th>
<th style="text-align:right;">
S3A
</th>
<th style="text-align:right;">
S4A
</th>
<th style="text-align:right;">
Bs0
</th>
<th style="text-align:right;">
Bs1
</th>
<th style="text-align:right;">
Bs2
</th>
<th style="text-align:right;">
Bs3
</th>
<th style="text-align:right;">
Bs4
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1.477454
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
3.247461
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
6.490969
</td>
<td style="text-align:right;">
4.564023
</td>
<td style="text-align:right;">
6.354532
</td>
<td style="text-align:right;">
5.224722
</td>
<td style="text-align:right;">
12.339243
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2.028072
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
2.408471
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
4.864416
</td>
<td style="text-align:right;">
7.957840
</td>
<td style="text-align:right;">
6.587935
</td>
<td style="text-align:right;">
3.044139
</td>
<td style="text-align:right;">
2.909219
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.334083
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
2.676602
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
10.071530
</td>
<td style="text-align:right;">
1.650143
</td>
<td style="text-align:right;">
1.562964
</td>
<td style="text-align:right;">
6.156831
</td>
<td style="text-align:right;">
8.045311
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1.171517
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2.471265
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
12.162085
</td>
<td style="text-align:right;">
4.796817
</td>
<td style="text-align:right;">
2.649034
</td>
<td style="text-align:right;">
2.019965
</td>
<td style="text-align:right;">
5.061974
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2.097203
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
2.255469
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
3.265458
</td>
<td style="text-align:right;">
7.900660
</td>
<td style="text-align:right;">
4.254162
</td>
<td style="text-align:right;">
16.426251
</td>
<td style="text-align:right;">
6.177225
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1.322103
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
2.626870
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
5.478926
</td>
<td style="text-align:right;">
5.845528
</td>
<td style="text-align:right;">
6.175421
</td>
<td style="text-align:right;">
4.388986
</td>
<td style="text-align:right;">
2.740655
</td>
</tr>
</tbody>
</table>
</div>
<div id="factors-1" class="section level2" number="14.15">
<h2><span class="header-section-number">14.15</span> Factors</h2>
<p>First, let us do easy bits, converting several columns to factors and setting up labels.</p>
<ul>
<li><code>sex</code>
<ul>
<li>1 : <code>female</code></li>
<li>2 : <code>male</code></li>
</ul></li>
<li><code>Condition</code>:
<ul>
<li>0 : <code>control</code></li>
<li>1 : <code>speed</code></li>
<li>2 : <code>size</code></li>
<li>3 : <code>random</code></li>
</ul></li>
<li><code>IncongruentFirst</code>
<ul>
<li>0 : <code>Congruent first</code></li>
<li>1 : <code>Incongruent first</code></li>
</ul></li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:right;">
HabitNr
</th>
<th style="text-align:left;">
sex
</th>
<th style="text-align:left;">
Condition
</th>
<th style="text-align:left;">
IncongruentFirst
</th>
<th style="text-align:right;">
errorsCongruent
</th>
<th style="text-align:right;">
ReactiontimemeanCong
</th>
<th style="text-align:right;">
errorsIncongruent
</th>
<th style="text-align:right;">
ReactiontimemeanInco
</th>
<th style="text-align:right;">
S0A
</th>
<th style="text-align:right;">
S1A
</th>
<th style="text-align:right;">
S2A
</th>
<th style="text-align:right;">
S3A
</th>
<th style="text-align:right;">
S4A
</th>
<th style="text-align:right;">
Bs0
</th>
<th style="text-align:right;">
Bs1
</th>
<th style="text-align:right;">
Bs2
</th>
<th style="text-align:right;">
Bs3
</th>
<th style="text-align:right;">
Bs4
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
control
</td>
<td style="text-align:left;">
Congruent first
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1.477454
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
3.247461
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
6.490969
</td>
<td style="text-align:right;">
4.564023
</td>
<td style="text-align:right;">
6.354532
</td>
<td style="text-align:right;">
5.224722
</td>
<td style="text-align:right;">
12.339243
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
speed
</td>
<td style="text-align:left;">
Congruent first
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2.028072
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
2.408471
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
4.864416
</td>
<td style="text-align:right;">
7.957840
</td>
<td style="text-align:right;">
6.587935
</td>
<td style="text-align:right;">
3.044139
</td>
<td style="text-align:right;">
2.909219
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
size
</td>
<td style="text-align:left;">
Congruent first
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.334083
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
2.676602
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
10.071530
</td>
<td style="text-align:right;">
1.650143
</td>
<td style="text-align:right;">
1.562964
</td>
<td style="text-align:right;">
6.156831
</td>
<td style="text-align:right;">
8.045311
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
control
</td>
<td style="text-align:left;">
Congruent first
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1.171517
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2.471265
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
12.162085
</td>
<td style="text-align:right;">
4.796817
</td>
<td style="text-align:right;">
2.649034
</td>
<td style="text-align:right;">
2.019965
</td>
<td style="text-align:right;">
5.061974
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
speed
</td>
<td style="text-align:left;">
Congruent first
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2.097203
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
2.255469
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
3.265458
</td>
<td style="text-align:right;">
7.900660
</td>
<td style="text-align:right;">
4.254162
</td>
<td style="text-align:right;">
16.426251
</td>
<td style="text-align:right;">
6.177225
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
size
</td>
<td style="text-align:left;">
Congruent first
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1.322103
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
2.626870
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
5.478926
</td>
<td style="text-align:right;">
5.845528
</td>
<td style="text-align:right;">
6.175421
</td>
<td style="text-align:right;">
4.388986
</td>
<td style="text-align:right;">
2.740655
</td>
</tr>
</tbody>
</table>
</div>
<div id="response-times" class="section level2" number="14.16">
<h2><span class="header-section-number">14.16</span> Response times</h2>
Next, we need to “spin-off” a separate table that will contain information about response times per congruency manipulation. Thus we want a table where column <code>Congruency</code> indicates whether presentation was congruent, whereas two columns (<code>ReactiontimemeanCong</code> and <code>ReactiontimemeanInco</code>) for response times become two rows (we pivot table longer). Note that I have used better labels for congruent and incongruent conditions. You can first rename them pivot or pivot and relabel (choice is yours). At the moment, we do not need all other columns, see table below to see what I decided to keep.
<table>
<thead>
<tr>
<th style="text-align:right;">
HabitNr
</th>
<th style="text-align:left;">
Condition
</th>
<th style="text-align:left;">
IncongruentFirst
</th>
<th style="text-align:left;">
Congruency
</th>
<th style="text-align:right;">
RT
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
control
</td>
<td style="text-align:left;">
Congruent first
</td>
<td style="text-align:left;">
Congruent
</td>
<td style="text-align:right;">
1.477454
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
control
</td>
<td style="text-align:left;">
Congruent first
</td>
<td style="text-align:left;">
Incongruent
</td>
<td style="text-align:right;">
3.247461
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
speed
</td>
<td style="text-align:left;">
Congruent first
</td>
<td style="text-align:left;">
Congruent
</td>
<td style="text-align:right;">
2.028072
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
speed
</td>
<td style="text-align:left;">
Congruent first
</td>
<td style="text-align:left;">
Incongruent
</td>
<td style="text-align:right;">
2.408471
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
size
</td>
<td style="text-align:left;">
Congruent first
</td>
<td style="text-align:left;">
Congruent
</td>
<td style="text-align:right;">
1.334083
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
size
</td>
<td style="text-align:left;">
Congruent first
</td>
<td style="text-align:left;">
Incongruent
</td>
<td style="text-align:right;">
2.676602
</td>
</tr>
</tbody>
</table>
<p>Let us see how condition and incongruency-order presentation affects our response times.</p>
<p><img src="data-analysis-using-r-for-psychology_files/figure-html/unnamed-chunk-385-1.png" width="672" /></p>
<p>Participants responses were clearly faster on trials when color and word were incongruent. But to better see the effect of condition, let us replot the data.</p>
<p><img src="data-analysis-using-r-for-psychology_files/figure-html/unnamed-chunk-386-1.png" width="672" /></p>
<p>Now, we can that some conditions do appear to be different as well. Let us confirm this via statistics. We will use linear mixed models (thus, package <em>lmerTest</em>) with <code>Condition</code>, <code>IncongruentFirst</code>, and <code>Congruency</code> as fixed effect and <code>HabitNr</code> (participant ID) as a random factor. We will not look at any interactions although they are most likely of interest for the follow up analysis.</p>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
## lmerModLmerTest]
## Formula: RT ~ Condition + IncongruentFirst + Congruency + (1 | HabitNr)
##    Data: rt
## 
## REML criterion at convergence: 84
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -1.7862 -0.7005 -0.1239  0.4302  3.5893 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  HabitNr  (Intercept) 0.00000  0.0000  
##  Residual             0.09852  0.3139  
## Number of obs: 128, groups:  HabitNr, 64
## 
## Fixed effects:
##                                    Estimate Std. Error        df t value
## (Intercept)                         1.51036    0.06423 122.00000  23.513
## Conditionspeed                      0.05433    0.07929 122.00000   0.685
## Conditionsize                       0.06613    0.07929 122.00000   0.834
## Conditionrandom                     0.45794    0.08204 122.00000   5.582
## IncongruentFirstIncongruent first   0.08994    0.06374 122.00000   1.411
## CongruencyIncongruent               1.02108    0.05549 122.00000  18.402
##                                   Pr(&gt;|t|)    
## (Intercept)                        &lt; 2e-16 ***
## Conditionspeed                       0.495    
## Conditionsize                        0.406    
## Conditionrandom                   1.46e-07 ***
## IncongruentFirstIncongruent first    0.161    
## CongruencyIncongruent              &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) Cndtnsp Cndtnsz Cndtnr IncFIf
## Conditinspd -0.628                              
## Conditionsz -0.628  0.539                       
## Conditnrndm -0.603  0.525   0.525               
## IncngrntFIf -0.132 -0.129  -0.129  -0.155       
## CngrncyIncn -0.432  0.000   0.000   0.000  0.000
## optimizer (nloptwrap) convergence code: 0 (OK)
## boundary (singular) fit: see ?isSingular</code></pre>
<pre><code>## Single term deletions using Satterthwaite&#39;s method:
## 
## Model:
## RT ~ Condition + IncongruentFirst + Congruency + (1 | HabitNr)
##                  Sum Sq Mean Sq NumDF DenDF  F value    Pr(&gt;F)    
## Condition         4.012   1.337     3   122  13.5728 1.065e-07 ***
## IncongruentFirst  0.196   0.196     1   122   1.9911    0.1608    
## Congruency       33.363  33.363     1   122 338.6302 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>In short, we a highly significant effect of color-word congruency (good news, otherwise out Stroop task wasn’t very successful) and one condition (<em>random</em>) is clear difference. However, the <em>order</em> of block (first congruent then incongruent or vice versa) did not really matter.</p>
</div>
<div id="accuracy" class="section level2" number="14.17">
<h2><span class="header-section-number">14.17</span> Accuracy</h2>
<p>Now let us perform the same analysis but on correct response count. What you need to know is that there were 120 trials in total for each block. We have information about <em>errors</em> not <em>correct responses</em> but it makes no difference for analysis, only for model interpretation. Extract column and pivot table same way as you did with response times.</p>
<table>
<thead>
<tr>
<th style="text-align:right;">
HabitNr
</th>
<th style="text-align:left;">
Condition
</th>
<th style="text-align:left;">
IncongruentFirst
</th>
<th style="text-align:left;">
Congruency
</th>
<th style="text-align:right;">
Errors
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
control
</td>
<td style="text-align:left;">
Congruent first
</td>
<td style="text-align:left;">
Congruent
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
control
</td>
<td style="text-align:left;">
Congruent first
</td>
<td style="text-align:left;">
Incongruent
</td>
<td style="text-align:right;">
12
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
speed
</td>
<td style="text-align:left;">
Congruent first
</td>
<td style="text-align:left;">
Congruent
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
speed
</td>
<td style="text-align:left;">
Congruent first
</td>
<td style="text-align:left;">
Incongruent
</td>
<td style="text-align:right;">
18
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
size
</td>
<td style="text-align:left;">
Congruent first
</td>
<td style="text-align:left;">
Congruent
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
size
</td>
<td style="text-align:left;">
Congruent first
</td>
<td style="text-align:left;">
Incongruent
</td>
<td style="text-align:right;">
7
</td>
</tr>
</tbody>
</table>
<p>Again, let us plot data both ways</p>
<p><img src="data-analysis-using-r-for-psychology_files/figure-html/unnamed-chunk-390-1.png" width="672" /></p>
<p><img src="data-analysis-using-r-for-psychology_files/figure-html/unnamed-chunk-391-1.png" width="672" /></p>
<p>Plots are very similar to those for response times. So let us perform the statistical analysis. This is a binomial data, so many errors per 120 trials, so use <code>glmer()</code> function (generalized linear mixed model) from <code>lme4</code> package with binomial family.</p>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Laplace
##   Approximation) [glmerMod]
##  Family: binomial  ( logit )
## Formula: cbind(Errors, 120) ~ Condition + IncongruentFirst + Congruency +  
##     (1 | HabitNr)
##    Data: errors
## 
##      AIC      BIC   logLik deviance df.resid 
##    608.9    628.9   -297.5    594.9      121 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -2.1050 -0.8816 -0.1543  0.7427  3.5440 
## 
## Random effects:
##  Groups  Name        Variance Std.Dev.
##  HabitNr (Intercept) 0.02038  0.1428  
## Number of obs: 128, groups:  HabitNr, 64
## 
## Fixed effects:
##                                   Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                       -4.64135    0.12575 -36.908  &lt; 2e-16 ***
## Conditionspeed                     0.63983    0.11812   5.417 6.07e-08 ***
## Conditionsize                      0.07082    0.12845   0.551    0.581    
## Conditionrandom                    0.65101    0.12174   5.348 8.91e-08 ***
## IncongruentFirstIncongruent first  0.59263    0.08209   7.219 5.24e-13 ***
## CongruencyIncongruent              1.82114    0.09439  19.295  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) Cndtnsp Cndtnsz Cndtnr IncFIf
## Conditinspd -0.600                              
## Conditionsz -0.542  0.615                       
## Conditnrndm -0.575  0.651   0.615               
## IncngrntFIf -0.120 -0.124  -0.154  -0.178       
## CngrncyIncn -0.642  0.004   0.000   0.008  0.005</code></pre>
<pre><code>## Single term deletions
## 
## Model:
## cbind(Errors, 120) ~ Condition + IncongruentFirst + Congruency + 
##     (1 | HabitNr)
##                  npar     AIC    LRT   Pr(Chi)    
## &lt;none&gt;                 608.92                     
## Condition           3  646.37  43.45 1.971e-09 ***
## IncongruentFirst    1  643.42  36.50 1.524e-09 ***
## Congruency          1 1132.52 525.60 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>In comparison to response times, even the block order makes the difference with more errors if incongruent condition was presented first. For errors, <code>speed</code> condition was different from the <code>control</code> baseline. However, <code>size</code> conditions appears to be very boring, as we see no difference in neither error rate nor response times.</p>
</div>
<div id="physiological-signal" class="section level2" number="14.18">
<h2><span class="header-section-number">14.18</span> Physiological signal</h2>
<p>Now we come to the tricky part because information about physiological signal (I’ll call is PS for short) is stored in columns <code>S0A</code> till <code>S4A</code> for some participant but in columns <code>Bs0</code> till <code>Bs4</code> for others. I.e., <code>S0A</code> codes the same information as <code>Bs0</code>, <code>S1A</code> same as <code>Bs1</code>, etc. The digit indicates the measurement time point. How can we fix this? Either using <code>ifelse()</code> or by splitting table by rows, converting each to a common long format and then merging them. For didactic purposes, we will do both!</p>
In case of <code>ifelse()</code> solution, let us store everything in first set of columns but overwrite their value only if they have <code>NA</code>. So, <code>S0A</code> is not <code>NA</code>, you leave it alone, otherwise you overwrite it with a value from <code>Bs0</code>. Here is the end-product (store data in a separate new table <code>clean_results</code>, so you can work on the original later again).
<table>
<thead>
<tr>
<th style="text-align:right;">
HabitNr
</th>
<th style="text-align:right;">
S0A
</th>
<th style="text-align:right;">
S1A
</th>
<th style="text-align:right;">
S2A
</th>
<th style="text-align:right;">
S3A
</th>
<th style="text-align:right;">
S4A
</th>
<th style="text-align:right;">
Bs0
</th>
<th style="text-align:right;">
Bs1
</th>
<th style="text-align:right;">
Bs2
</th>
<th style="text-align:right;">
Bs3
</th>
<th style="text-align:right;">
Bs4
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
6.490969
</td>
<td style="text-align:right;">
4.564023
</td>
<td style="text-align:right;">
6.354532
</td>
<td style="text-align:right;">
5.224722
</td>
<td style="text-align:right;">
12.339243
</td>
<td style="text-align:right;">
6.490969
</td>
<td style="text-align:right;">
4.564023
</td>
<td style="text-align:right;">
6.354532
</td>
<td style="text-align:right;">
5.224722
</td>
<td style="text-align:right;">
12.339243
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4.864416
</td>
<td style="text-align:right;">
7.957840
</td>
<td style="text-align:right;">
6.587935
</td>
<td style="text-align:right;">
3.044139
</td>
<td style="text-align:right;">
2.909219
</td>
<td style="text-align:right;">
4.864416
</td>
<td style="text-align:right;">
7.957840
</td>
<td style="text-align:right;">
6.587935
</td>
<td style="text-align:right;">
3.044139
</td>
<td style="text-align:right;">
2.909219
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
10.071530
</td>
<td style="text-align:right;">
1.650143
</td>
<td style="text-align:right;">
1.562964
</td>
<td style="text-align:right;">
6.156831
</td>
<td style="text-align:right;">
8.045311
</td>
<td style="text-align:right;">
10.071530
</td>
<td style="text-align:right;">
1.650143
</td>
<td style="text-align:right;">
1.562964
</td>
<td style="text-align:right;">
6.156831
</td>
<td style="text-align:right;">
8.045311
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
12.162085
</td>
<td style="text-align:right;">
4.796817
</td>
<td style="text-align:right;">
2.649034
</td>
<td style="text-align:right;">
2.019965
</td>
<td style="text-align:right;">
5.061974
</td>
<td style="text-align:right;">
12.162085
</td>
<td style="text-align:right;">
4.796817
</td>
<td style="text-align:right;">
2.649034
</td>
<td style="text-align:right;">
2.019965
</td>
<td style="text-align:right;">
5.061974
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
3.265458
</td>
<td style="text-align:right;">
7.900660
</td>
<td style="text-align:right;">
4.254162
</td>
<td style="text-align:right;">
16.426251
</td>
<td style="text-align:right;">
6.177225
</td>
<td style="text-align:right;">
3.265458
</td>
<td style="text-align:right;">
7.900660
</td>
<td style="text-align:right;">
4.254162
</td>
<td style="text-align:right;">
16.426251
</td>
<td style="text-align:right;">
6.177225
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
5.478926
</td>
<td style="text-align:right;">
5.845528
</td>
<td style="text-align:right;">
6.175421
</td>
<td style="text-align:right;">
4.388986
</td>
<td style="text-align:right;">
2.740655
</td>
<td style="text-align:right;">
5.478926
</td>
<td style="text-align:right;">
5.845528
</td>
<td style="text-align:right;">
6.175421
</td>
<td style="text-align:right;">
4.388986
</td>
<td style="text-align:right;">
2.740655
</td>
</tr>
</tbody>
</table>
<p>The alternative is more challenging but still fairly straightforward. First, let us spin-off two separate tables. One which has valid values for <code>S0A</code>:<code>S4A</code> dropping all the rows when they are <code>NA</code>. And, conversely, the other table that has valid values for columns <code>Bs0</code>:<code>Bs4</code>. Then, pivot each table longer (we need to do this anyhow) and recode labels to <code>t0</code> till <code>t4</code>. After that we can merge two tables by rows via <code>bind_rows</code>.</p>
Here is the first table after filtering
<table>
<thead>
<tr>
<th style="text-align:right;">
HabitNr
</th>
<th style="text-align:left;">
sex
</th>
<th style="text-align:left;">
Condition
</th>
<th style="text-align:left;">
IncongruentFirst
</th>
<th style="text-align:right;">
errorsCongruent
</th>
<th style="text-align:right;">
ReactiontimemeanCong
</th>
<th style="text-align:right;">
errorsIncongruent
</th>
<th style="text-align:right;">
ReactiontimemeanInco
</th>
<th style="text-align:right;">
S0A
</th>
<th style="text-align:right;">
S1A
</th>
<th style="text-align:right;">
S2A
</th>
<th style="text-align:right;">
S3A
</th>
<th style="text-align:right;">
S4A
</th>
<th style="text-align:right;">
Bs0
</th>
<th style="text-align:right;">
Bs1
</th>
<th style="text-align:right;">
Bs2
</th>
<th style="text-align:right;">
Bs3
</th>
<th style="text-align:right;">
Bs4
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
31
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
control
</td>
<td style="text-align:left;">
Congruent first
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.589768
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3.237953
</td>
<td style="text-align:right;">
61.92695
</td>
<td style="text-align:right;">
130.667988
</td>
<td style="text-align:right;">
111.63928
</td>
<td style="text-align:right;">
82.540381
</td>
<td style="text-align:right;">
73.560757
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
32
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
control
</td>
<td style="text-align:left;">
Incongruent first
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.331935
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
2.728806
</td>
<td style="text-align:right;">
861.35340
</td>
<td style="text-align:right;">
4.222633
</td>
<td style="text-align:right;">
28.80748
</td>
<td style="text-align:right;">
2704.220725
</td>
<td style="text-align:right;">
7.598707
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
33
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
size
</td>
<td style="text-align:left;">
Incongruent first
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1.331964
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
2.350008
</td>
<td style="text-align:right;">
386.32276
</td>
<td style="text-align:right;">
48.234614
</td>
<td style="text-align:right;">
385.51966
</td>
<td style="text-align:right;">
14.163667
</td>
<td style="text-align:right;">
105.036142
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
34
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
speed
</td>
<td style="text-align:left;">
Incongruent first
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.443712
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
2.847616
</td>
<td style="text-align:right;">
24.49781
</td>
<td style="text-align:right;">
11.798876
</td>
<td style="text-align:right;">
36.00568
</td>
<td style="text-align:right;">
5.717785
</td>
<td style="text-align:right;">
104.179406
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
35
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
random
</td>
<td style="text-align:left;">
Congruent first
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2.052467
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
3.123355
</td>
<td style="text-align:right;">
18.13469
</td>
<td style="text-align:right;">
1.503134
</td>
<td style="text-align:right;">
13.92405
</td>
<td style="text-align:right;">
6.840379
</td>
<td style="text-align:right;">
18.698580
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
36
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
size
</td>
<td style="text-align:left;">
Congruent first
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1.404922
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
2.465878
</td>
<td style="text-align:right;">
34.34912
</td>
<td style="text-align:right;">
237.770126
</td>
<td style="text-align:right;">
51.11720
</td>
<td style="text-align:right;">
201.287047
</td>
<td style="text-align:right;">
823.285426
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>
And here it is pivoted
<table>
<thead>
<tr>
<th style="text-align:right;">
HabitNr
</th>
<th style="text-align:left;">
Condition
</th>
<th style="text-align:left;">
IncongruentFirst
</th>
<th style="text-align:left;">
Timepoint
</th>
<th style="text-align:right;">
Signal
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
31
</td>
<td style="text-align:left;">
control
</td>
<td style="text-align:left;">
Congruent first
</td>
<td style="text-align:left;">
t0
</td>
<td style="text-align:right;">
61.92695
</td>
</tr>
<tr>
<td style="text-align:right;">
31
</td>
<td style="text-align:left;">
control
</td>
<td style="text-align:left;">
Congruent first
</td>
<td style="text-align:left;">
t1
</td>
<td style="text-align:right;">
130.66799
</td>
</tr>
<tr>
<td style="text-align:right;">
31
</td>
<td style="text-align:left;">
control
</td>
<td style="text-align:left;">
Congruent first
</td>
<td style="text-align:left;">
t2
</td>
<td style="text-align:right;">
111.63928
</td>
</tr>
<tr>
<td style="text-align:right;">
31
</td>
<td style="text-align:left;">
control
</td>
<td style="text-align:left;">
Congruent first
</td>
<td style="text-align:left;">
t3
</td>
<td style="text-align:right;">
82.54038
</td>
</tr>
<tr>
<td style="text-align:right;">
31
</td>
<td style="text-align:left;">
control
</td>
<td style="text-align:left;">
Congruent first
</td>
<td style="text-align:left;">
t4
</td>
<td style="text-align:right;">
73.56076
</td>
</tr>
<tr>
<td style="text-align:right;">
32
</td>
<td style="text-align:left;">
control
</td>
<td style="text-align:left;">
Incongruent first
</td>
<td style="text-align:left;">
t0
</td>
<td style="text-align:right;">
861.35340
</td>
</tr>
</tbody>
</table>
Again, same procedure for rows with valid <code>Bs0</code>:<code>Bs4</code> columns
<table>
<thead>
<tr>
<th style="text-align:right;">
HabitNr
</th>
<th style="text-align:left;">
Condition
</th>
<th style="text-align:left;">
IncongruentFirst
</th>
<th style="text-align:left;">
Timepoint
</th>
<th style="text-align:right;">
Signal
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
control
</td>
<td style="text-align:left;">
Congruent first
</td>
<td style="text-align:left;">
t0
</td>
<td style="text-align:right;">
6.490969
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
control
</td>
<td style="text-align:left;">
Congruent first
</td>
<td style="text-align:left;">
t1
</td>
<td style="text-align:right;">
4.564023
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
control
</td>
<td style="text-align:left;">
Congruent first
</td>
<td style="text-align:left;">
t2
</td>
<td style="text-align:right;">
6.354532
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
control
</td>
<td style="text-align:left;">
Congruent first
</td>
<td style="text-align:left;">
t3
</td>
<td style="text-align:right;">
5.224722
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
control
</td>
<td style="text-align:left;">
Congruent first
</td>
<td style="text-align:left;">
t4
</td>
<td style="text-align:right;">
12.339243
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
speed
</td>
<td style="text-align:left;">
Congruent first
</td>
<td style="text-align:left;">
t0
</td>
<td style="text-align:right;">
4.864416
</td>
</tr>
</tbody>
</table>
<p>Once you merged two tables by rows (see <a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows()</a>).</p>
<p>, let us take a look at the results.</p>
<p><img src="data-analysis-using-r-for-psychology_files/figure-html/unnamed-chunk-398-1.png" width="672" /></p>
<p>There seems to be clear outliers, so let us drop all values above 1000 (filter inside the ggplot call) and plot again</p>
<p><img src="data-analysis-using-r-for-psychology_files/figure-html/unnamed-chunk-399-1.png" width="672" /></p>
<p>Well, certainly hard to tell, so no clear and consistent effect. Still, let us do stats via linear mixed models.</p>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
## lmerModLmerTest]
## Formula: Signal ~ Timepoint + Condition + IncongruentFirst + (1 | HabitNr)
##    Data: signal
## 
## REML criterion at convergence: 4184.7
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -2.0989 -0.2701 -0.1293 -0.0072 12.6054 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  HabitNr  (Intercept)  3774     61.43  
##  Residual             33352    182.63  
## Number of obs: 320, groups:  HabitNr, 64
## 
## Fixed effects:
##                                   Estimate Std. Error      df t value Pr(&gt;|t|)
## (Intercept)                         95.282     33.593 137.344   2.836  0.00525
## Timepointt1                         10.906     32.284 252.000   0.338  0.73578
## Timepointt2                        -11.969     32.284 252.000  -0.371  0.71113
## Timepointt3                         25.524     32.284 252.000   0.791  0.42991
## Timepointt4                         -6.173     32.284 252.000  -0.191  0.84851
## Conditionspeed                     -71.414     36.510  59.000  -1.956  0.05520
## Conditionsize                      -55.042     36.510  59.000  -1.508  0.13699
## Conditionrandom                    -75.083     37.776  59.000  -1.988  0.05151
## IncongruentFirstIncongruent first   88.443     29.349  59.000   3.013  0.00380
##                                     
## (Intercept)                       **
## Timepointt1                         
## Timepointt2                         
## Timepointt3                         
## Timepointt4                         
## Conditionspeed                    . 
## Conditionsize                       
## Conditionrandom                   . 
## IncongruentFirstIncongruent first **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) Tmpnt1 Tmpnt2 Tmpnt3 Tmpnt4 Cndtnsp Cndtnsz Cndtnr
## Timepointt1 -0.481                                                   
## Timepointt2 -0.481  0.500                                            
## Timepointt3 -0.481  0.500  0.500                                     
## Timepointt4 -0.481  0.500  0.500  0.500                              
## Conditinspd -0.553  0.000  0.000  0.000  0.000                       
## Conditionsz -0.553  0.000  0.000  0.000  0.000  0.539                
## Conditnrndm -0.531  0.000  0.000  0.000  0.000  0.525   0.525        
## IncngrntFIf -0.116  0.000  0.000  0.000  0.000 -0.129  -0.129  -0.155</code></pre>
<pre><code>## Single term deletions using Satterthwaite&#39;s method:
## 
## Model:
## Signal ~ Timepoint + Condition + IncongruentFirst + (1 | HabitNr)
##                  Sum Sq Mean Sq NumDF DenDF F value   Pr(&gt;F)   
## Timepoint         56635   14159     4   252  0.4245 0.790883   
## Condition        171033   57011     3    59  1.7094 0.174862   
## IncongruentFirst 302871  302871     1    59  9.0810 0.003802 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="wrap-up-2" class="section level2" number="14.19">
<h2><span class="header-section-number">14.19</span> Wrap up</h2>
<p>That’s it for today but realistically, this is still an oversimplified version of the analysis. The original study had many more predictors and even here, there is likely to be an interaction between time point and whether congruent or incongruent condition was presented first.</p>

</div>
</div>










































































<div class="footnotes">
<hr />
<ol start="64">
<li id="fn64"><p>In the Statistical Rethinking seminar we spend three seminars learning how to understand and interpret a simple linear multiple regression with just two predictors. And the conclusion is that even in this simple case, you are not guaranteed to fully understand it. And if you think that you can easily interpret an interaction term even for two continuous predictors…<a href="statistical-modeling.html#fnref64" class="footnote-back">↩︎</a></p></li>
<li id="fn65"><p>Use <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/names.html">names()</a> function to get names of all elements.<a href="statistical-modeling.html#fnref65" class="footnote-back">↩︎</a></p></li>
<li id="fn66"><p>Why 89%? Because 89 is a prime number.<a href="statistical-modeling.html#fnref66" class="footnote-back">↩︎</a></p></li>
<li id="fn67"><p><a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/Random.html">set.seed()</a> function initializes random numbers generator to a specific state to get a reproducible but random (as in, sequentially uncorrelated) sequence of values.<a href="statistical-modeling.html#fnref67" class="footnote-back">↩︎</a></p></li>
<li id="fn68"><p>Here, each participant must have their own intercept but they all share same single slope for <code>Condition</code>. You can also specify that they individual slopes that are either correlated or uncorrelated with their intercept.<a href="statistical-modeling.html#fnref68" class="footnote-back">↩︎</a></p></li>
<li id="fn69"><p>I use <code>lmerTest::</code> to tell R that I need function <code>lmer()</code> from package <code>lmerTest</code> and not from <code>lme4</code> as before<a href="statistical-modeling.html#fnref69" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sampling-and-simulations.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["data-analysis-using-r-for-psychology.pdf", "data-analysis-using-r-for-psychology.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
