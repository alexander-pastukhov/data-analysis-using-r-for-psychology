<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 9 Controling computation flow | Data analysis using R for Psychology and Social Science</title>
<meta name="author" content="Alexander (Sasha) Pastukhov">
<meta name="description" content="Grab the exercise notebook before we start. One of the most powerful features of R is that it is vector-based. Remember, everything is a vector (or a list). In the previous seminars you saw you...">
<meta name="generator" content="bookdown 0.37 with bs4_book()">
<meta property="og:title" content="Chapter 9 Controling computation flow | Data analysis using R for Psychology and Social Science">
<meta property="og:type" content="book">
<meta property="og:description" content="Grab the exercise notebook before we start. One of the most powerful features of R is that it is vector-based. Remember, everything is a vector (or a list). In the previous seminars you saw you...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 9 Controling computation flow | Data analysis using R for Psychology and Social Science">
<meta name="twitter:description" content="Grab the exercise notebook before we start. One of the most powerful features of R is that it is vector-based. Remember, everything is a vector (or a list). In the previous seminars you saw you...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.6.1/transition.js"></script><script src="libs/bs3compat-0.6.1/tabs.js"></script><script src="libs/bs3compat-0.6.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link rel="shortcut icon" href="images/R_course_logo.svg">
<!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-QMVBLBE7DV"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-QMVBLBE7DV');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="bs4_style.css">
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Data analysis using R for Psychology and Social Science</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Introduction</a></li>
<li><a class="" href="software.html">Software</a></li>
<li><a class="" href="reproducable-research.html"><span class="header-section-number">1</span> Reproducable Research: Projects and Markdown Notebooks</a></li>
<li><a class="" href="vectors.html"><span class="header-section-number">2</span> Vectors! Vectors everywhere!</a></li>
<li><a class="" href="tables.html"><span class="header-section-number">3</span> Tables and Tibbles (and Tribbles)</a></li>
<li><a class="" href="functions.html"><span class="header-section-number">4</span> Functions! Functions everywhere!</a></li>
<li><a class="" href="ggplot2.html"><span class="header-section-number">5</span> ggplot2: Grammar of Graphics</a></li>
<li><a class="" href="dplyr.html"><span class="header-section-number">6</span> Tidyverse: dplyr</a></li>
<li><a class="" href="working-with-factors.html"><span class="header-section-number">7</span> Working with Factors</a></li>
<li><a class="" href="tyding.html"><span class="header-section-number">8</span> Tidyng your data: joins and pivots</a></li>
<li><a class="active" href="control-flow-chapter.html"><span class="header-section-number">9</span> Controling computation flow</a></li>
<li><a class="" href="missing-data.html"><span class="header-section-number">10</span> Missing data</a></li>
<li><a class="" href="strings.html"><span class="header-section-number">11</span> Working with strings</a></li>
<li><a class="" href="sampling-and-simulations.html"><span class="header-section-number">12</span> Sampling and simulations</a></li>
<li><a class="" href="generalized-linear-regression-and-resampling.html"><span class="header-section-number">13</span> (Generalized) Linear regression and Resampling</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/alexander-pastukhov/data-analysis-using-r-for-psychology">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="control-flow-chapter" class="section level1" number="9">
<h1>
<span class="header-section-number">9</span> Controling computation flow<a class="anchor" aria-label="anchor" href="#control-flow-chapter"><i class="fas fa-link"></i></a>
</h1>
<p>Grab the <a href="notebooks/Seminar%2009%20-%20control%20flow.qmd">exercise notebook</a> before we start.</p>
<p>One of the most powerful features of R is that it is vector-based. Remember, everything is a vector (or a list). In the previous seminars you saw you can apply a function, a filter, or perform a computation on all values of a vector or all rows in a table in a single call. However, sometimes, you need to go over one value or row at a time explicitly. For example, if you working with a time-series, it might be easier to use an explicit <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/Control.html">for</a> loop to compute current value based on previous state of the system. However, such instances are fairly rare, so the general rule for R is “you probably do not need a loop”. Below, we will go through various tools that render explicit loops redundant, but cover the loops themselves as well as conditional control statements (if-else) and functions (<code>ifelse</code>, <code>case_when</code>).</p>
<p>Note that the material does not cover a <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/Control.html">while (<condition-is-true>) {&lt;do-code}</condition-is-true></a> loop mostly because it is rarely used in data analysis<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;I tried to remember when was the last time I personally used it in R and could not remember, if I ever did this.&lt;/p&gt;"><sup>61</sup></a> and I could not come up with examples that would not be very artificial looking. At the same time, if you do need it, it has a very simple structure, so understanding and using it should not be a challenge.</p>
<div id="rep" class="section level2" number="9.1">
<h2>
<span class="header-section-number">9.1</span> <code>rep()</code><a class="anchor" aria-label="anchor" href="#rep"><i class="fas fa-link"></i></a>
</h2>
<p>The most basic repetition mechanism in R is <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/rep.html">rep()</a> function. It takes a vector and repeats it specified number of <code>times</code>.</p>
<div class="sourceCode" id="cb355"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<pre><code>##  [1] 1 2 3 1 2 3 1 2 3 1 2 3</code></pre>
<p>Alternatively, you can repeat each element specified number of times before repeating the next one via <code>each</code> parameter. The difference between options lies only in the <em>order</em> of elements in the new vector. As you can see both vectors have the same length and each individual value is repeated four times.</p>
<div class="sourceCode" id="cb357"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<pre><code>##  [1] 1 1 1 1 2 2 2 2 3 3 3 3</code></pre>
<p>You can specify length of the output vector via <code>length.out</code>. When combined with <code>times</code> it can be useful for producing truncated vectors. E.g., when we repeat a three element vector but we want to get ten values. Using <code>times</code> only, we can get either nine (<code>times = 3</code>) or twelve (<code>times = 4</code>), not ten. <code>length.out = 10</code> makes it happen.</p>
<div class="sourceCode" id="cb359"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, times<span class="op">=</span><span class="fl">4</span>, length.out <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code>##  [1] 1 2 3 1 2 3 1 2 3 1</code></pre>
<p>However, you can also use subsetting of a new vector to achieve the same end.</p>
<div class="sourceCode" id="cb361"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span></code></pre></div>
<pre><code>##  [1] 1 2 3 1 2 3 1 2 3 1</code></pre>
<p>You should be more careful when combining <code>length.out</code> with <code>each</code>, as each value is repeated <code>each</code> times and, if <code>length.out</code> is longer, the same sequence is repeated again. Could be confusing and you might get a very unbalanced repeated sequence.</p>
<div class="sourceCode" id="cb363"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">8</span>, length.out <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code>##  [1] 1 1 1 1 1 1 1 1 2 2</code></pre>
<div class="practice">
<p>Do exercise 1.</p>
</div>
</div>
<div id="repeating-combinations" class="section level2" number="9.2">
<h2>
<span class="header-section-number">9.2</span> Repeating combinations<a class="anchor" aria-label="anchor" href="#repeating-combinations"><i class="fas fa-link"></i></a>
</h2>
<p>To create a table with all combinations of values, you can use either base R <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/expand.grid.html">expand.grid()</a> or tidyr’s implementation <a href="https://tidyr.tidyverse.org/reference/expand_grid.html">expand_grid()</a>. The latter is a bit more robust and can expand even tables and matrices (but see the documentation for subtle differences in implementation and output).</p>
<p>The usage is very straightforward, you provide column names and values and you get all combinations of their values.</p>
<div class="sourceCode" id="cb365"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">grid_base</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:left;">
gender
</th>
<th style="text-align:left;">
handidness
</th>
<th style="text-align:left;">
colorblindness
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
right
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
right
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
left
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
left
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
right
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
right
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
left
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
left
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
</tbody>
</table></div>
<p><a href="https://tidyr.tidyverse.org/reference/expand_grid.html">expand_grid()</a> works the same they but for the order of values within columns.</p>
<div class="sourceCode" id="cb366"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html">expand_grid</a></span><span class="op">(</span>gender<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"female"</span>, <span class="st">"male"</span><span class="op">)</span>, </span>
<span>            handidness<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"right"</span>, <span class="st">"left"</span><span class="op">)</span>,</span>
<span>            colorblindness<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb367"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">grid_tidyr</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:left;">
gender
</th>
<th style="text-align:left;">
handidness
</th>
<th style="text-align:left;">
colorblindness
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
right
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
right
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
left
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
left
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
right
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
right
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
left
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
left
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
</tbody>
</table></div>
<div class="practice">
<p>Do exercise 2.</p>
</div>
</div>
<div id="forloop" class="section level2" number="9.3">
<h2>
<span class="header-section-number">9.3</span> For loop<a class="anchor" aria-label="anchor" href="#forloop"><i class="fas fa-link"></i></a>
</h2>
<p>You can loop (iterate) over elements of a vector or list via a <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/Control.html">for</a> loop, which is very similar to for-loops in other programming languages. However, use of the <code>for</code> loop in R is fairly rare, because vectors are a fundamental building block of R and, therefore, it is inherently vectorized (you can do the same thing to all values, not to one value at a time). In a sense, <code>for</code> loop is very un-R, so if you find yourself using it, consider whether there is a simpler or more expressive way to do this. At the same time, if <code>for</code> loop <em>is</em> the simplest, clearest, or more robust way to write you code, by all means, use it!</p>
<p>The general format is</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="control-flow-chapter.html#cb368-1" tabindex="-1"></a><span class="cf">for</span>(loop_variable <span class="cf">in</span> vector_or_list){</span>
<span id="cb368-2"><a href="control-flow-chapter.html#cb368-2" tabindex="-1"></a>  ...some operations using loop_variable that</span>
<span id="cb368-3"><a href="control-flow-chapter.html#cb368-3" tabindex="-1"></a>  changes its value on each iteration using</span>
<span id="cb368-4"><a href="control-flow-chapter.html#cb368-4" tabindex="-1"></a>  values from the vector or list... </span>
<span id="cb368-5"><a href="control-flow-chapter.html#cb368-5" tabindex="-1"></a>}</span></code></pre></div>
<p>Note the curly brackets. We used them before to put the code inside a function. Here, we use them to put the code inside the loop. The loop (the code inside curly brackets) is repeated as many times as the number of elements in a vector or a list with a loop variable<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Just a reminder, the loop variable can have &lt;em&gt;any&lt;/em&gt; name. Often, you see people using &lt;code&gt;i&lt;/code&gt; but I would strongly recommend going for a more meaningful name.&lt;/p&gt;"><sup>62</sup></a> getting assigned each vector/list value on each iteration. Thus, to print each value of a vector we can do</p>
<div class="sourceCode" id="cb369"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span><span class="op">(</span><span class="va">a_number</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">200</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">a_number</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code>## [1] 1
## [1] 5
## [1] 200</code></pre>
<p>Here, we have three elements in a vector, therefore the code inside curly brackets is repeated three times with the variable <code>a_number</code> taking each value in turn. I.e., <code>a_number</code> is equal to 1 on a first iteration, 5 on a second, 200 on the third. Note that the code above is equivalent to just assigning one value at a time to <code>a_number</code> and calling <code><a href="https://rdrr.io/r/base/print.html">print()</a></code> function three times.</p>
<div class="sourceCode" id="cb371"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a_number</span> <span class="op">&lt;-</span> <span class="fl">1</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">a_number</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb373"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a_number</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">a_number</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode" id="cb375"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a_number</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">a_number</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 200</code></pre>
<p>As you can see, it does not really matter <em>how</em> you assign a value to a variable and repeat the code. However, the <code>for</code> loop approach is much more flexible, is easier to read and to maintain. I.e., let us assume that you decided to alter the <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/print.html">print()</a> call with <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/cat.html">cat()</a> instead. In the <code>for</code> loop version there is just one line to take care of. In the copy-paste version, there are three lines you need to alter. And imagine if you need to repeat the same code a hundred or thousand times, copy-paste is clearly not a viable solution.</p>
<p>Also note that you might be interested in repeat the code inside the for loop given number of times but are not interested in a loop variable and values that it takes. For example, we might want to repeat <code>print("Ho!")</code> three times (because it is Christmas time and “Ho! Ho! Ho!” is what Santa Clause says). In this case, we still need a vector with three elements that we can loop over but we do not care what these three elements are.</p>
<div class="sourceCode" id="cb377"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span><span class="op">(</span><span class="va">temp</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Ho!"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code>## [1] "Ho!"
## [1] "Ho!"
## [1] "Ho!"</code></pre>
<p>Note that we are not using variable <code>temp</code> inside of the loop and it has no effect on the code inside the curly brackets. Which is why we can use <em>any</em> three values, as it is their total number that matters, not the values themselves.</p>
<div class="sourceCode" id="cb379"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span><span class="op">(</span><span class="va">temp</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Ho!"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code>## [1] "Ho!"
## [1] "Ho!"
## [1] "Ho!"</code></pre>
<p>or</p>
<div class="sourceCode" id="cb381"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span><span class="op">(</span><span class="va">temp</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">300</span>, length.out<span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Ho!"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code>## [1] "Ho!"
## [1] "Ho!"
## [1] "Ho!"</code></pre>
<p>In short, number of elements in the vector determines how many times the code inside the loop will be repeat. Vector elements are stored in the loop variable on each iteration and you can either use it (<code>a_number</code> example above) or ignore them (“Ho! Ho! Ho!”) example.</p>
<div class="practice">
<p>Do exercises 3 and 4.</p>
</div>
<p>One for a typical scenarios for the loop variable is when it is used as an <em>index</em> to access an element of a vector or a list. You can build a vector of indexes via <code>start:stop</code> sequence tool we used for <a href="vectors.html#vector-index-slicing">slicing</a>. You can compute a length of an object via <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/length.html">length()</a> function. For a <code>data.frame</code> or a <code>tibble</code>, you can figure out number of rows and columns via, respectively, <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/nrow.html">nrow()</a> and <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/nrow.html">ncol()</a> functions.</p>
<div class="sourceCode" id="cb383"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vector_of_some_numbers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">200</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">index</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">vector_of_some_numbers</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">vector_of_some_numbers</span><span class="op">[</span><span class="va">index</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code>## [1] 1
## [1] 5
## [1] 200</code></pre>
<div class="practice">
<p>Do exercise 5.</p>
</div>
<p>You can also <em>nest</em> loops</p>
<div class="sourceCode" id="cb385"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span><span class="op">(</span><span class="va">letter</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">number</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="va">letter</span>, <span class="va">number</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code>## A 1 
## A 2 
## B 1 
## B 2 
## C 1 
## C 2</code></pre>
<div class="practice">
<p>Do exercise 6.</p>
</div>
<p>One scenario when loops are particularly advantages is when a current value depends on a previous one (or many previous values). In this case, a new value depends on the previous one and, in turn, determines the following ones and they cannot be computed before it is known. This means that vectorized approach that applies the computation to all values in parallel will not work and we need to perform the computation in a sequantial manner.</p>
<p>In the next exercise, use <code>for</code> loop to create a random walk. It should start at zero (so, initial value for your variable should be zero). For each next step, draw a random value from a normal distribution using <em>previous</em> value as a mean (decide on the standard deviation yourself). The function you are looking for is <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/Normal.html">rnorm()</a>). Generate a ten-step random walk, that might look like this (you can my plot replicate exactly, if you <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/Random.html">set.seed()</a> to 1977):
<img src="data-analysis-using-r-for-psychology_files/figure-html/unnamed-chunk-234-1.png" width="672"></p>
<div class="practice">
<p>Do exercise 7.</p>
</div>
</div>
<div id="if-else" class="section level2" number="9.4">
<h2>
<span class="header-section-number">9.4</span> Conditional statement<a class="anchor" aria-label="anchor" href="#if-else"><i class="fas fa-link"></i></a>
</h2>
<p>As in all other programming languages, you can control the flow of execution using <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/Control.html">if-else</a> statements. The general usage is as follows.</p>
<div class="sourceCode" id="cb387"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="va">some_condition</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># code runs if some_condition is TRUE</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="co"># code runs if some_condition is FALSE</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>The rules are the same as for <a href="dplyr.html#logical-indexing">logical indexing</a>, so we can define our condition using <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/Comparison.html">mathematical comparisons</a>.</p>
<div class="sourceCode" id="cb388"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">3</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"X is definitely greater than  zero"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"X is not greater than zero."</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code>## X is not greater than zero.</code></pre>
<p>However, be aware that the <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/Control.html">if</a> uses a <em>single</em> logical value. If you have more than one value, it stops with an error<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;If you use an older R-version, it will use &lt;em&gt;only the first one&lt;/em&gt; but, at least, it will give you a warning. Point being that it is generally a good idea to use the latest R distribution.&lt;/p&gt;"><sup>63</sup></a>.</p>
<div class="sourceCode" id="cb390"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>,  <span class="op">-</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">x</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Bingo!"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"I don't like this x."</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code>## Error in if (x &lt; 0) {: the condition has length &gt; 1</code></pre>
<p>As in <a href="dplyr.html#logical-indexing">logical indexing</a>, you can combine several conditions using <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/Logic.html">logical operators</a> such as <em>and</em> <code>&amp;&amp;</code> or <em>or</em> <code>||</code>.</p>
<p>For example, we can check whether x is smaller than zero but larger than -10.</p>
<div class="sourceCode" id="cb392"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">3</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="op">-</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Bingo!"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"I don't like this x."</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code>## Bingo!</code></pre>
<p>However, be aware that R has both <code>&amp;</code>/<code>|</code> and <code>&amp;&amp;</code>/<code>||</code> versions of <em>and</em> and <em>or</em> logical operators (single versus double symbols). Both perform logical operations on vectors but double-symbol works only for a single value. E.g., single-symbol returns <code>TRUE</code>/<code>FALSE</code> for each value of <code>x</code></p>
<div class="sourceCode" id="cb394"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="op">-</span><span class="fl">3</span>, <span class="op">-</span><span class="fl">11</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">x</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="op">-</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] FALSE  TRUE FALSE</code></pre>
<p><code>&amp;&amp;</code> and <code>||</code> will generate an error if vectors are longer<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;This is a new and very nice behavior introduced recently. Prior to that both &lt;code&gt;&amp;amp;&amp;amp;&lt;/code&gt; and &lt;code&gt;||&lt;/code&gt; would &lt;em&gt;silently&lt;/em&gt; ignore all elements but the first, making them very dangerous to use, so that I recommended against their use in the previous version of the book. Now it is the other way around, so they are the preferred way when working with scalars.&lt;/p&gt;"><sup>64</sup></a>.</p>
<div class="sourceCode" id="cb396"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># This works</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">3</span></span>
<span><span class="op">(</span><span class="va">x</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="op">-</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb398"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># This generates and error</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="op">-</span><span class="fl">3</span>, <span class="op">-</span><span class="fl">11</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">x</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="op">-</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Error in (x &lt; 0) &amp;&amp; (x &gt; -10): 'length = 3' in coercion to 'logical(1)'</code></pre>
<p>Let us combine <code>for</code> loop with <code>if-else</code> operator. Generate a vector of ten normally distributed values (again, <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/Normal.html">rnorm()</a> is the function). Loop over them in a <code>for</code> loop and <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/print.html">print()</a> or <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/cat.html">cat()</a> <code>"Positive"</code> if a value is larger than zero and <code>"Not positive"</code> if not. The results should look like this<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Want exact same numbers as I do? Use &lt;code&gt;set.seed(164)&lt;/code&gt;. This function, see &lt;a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/Random.html"&gt;set.seed()&lt;/a&gt; makes random generators start at a specific point, so that the you will get the &lt;em&gt;same&lt;/em&gt; sequence of &lt;em&gt;random&lt;/em&gt; numbers as I did.&lt;/p&gt;'><sup>65</sup></a></p>
<pre><code>##  [1]  0.03003683  1.22390943  1.71573769 -0.89994016  0.55507190  0.42319195
##  [7]  0.82993426 -1.28614375  1.21511589 -0.05815403</code></pre>
<pre><code>## [1] "Positive"
## [1] "Positive"
## [1] "Positive"
## [1] "Not positive"
## [1] "Positive"
## [1] "Positive"
## [1] "Positive"
## [1] "Not positive"
## [1] "Positive"
## [1] "Not positive"</code></pre>
<div class="practice">
<p>Do exercise 8.</p>
</div>
</div>
<div id="ifelse" class="section level2" number="9.5">
<h2>
<span class="header-section-number">9.5</span> ifelse()<a class="anchor" aria-label="anchor" href="#ifelse"><i class="fas fa-link"></i></a>
</h2>
<p>As I wrote above, strength of R lies in built-in vectorization that typically renders loops unnecessary. Although we used the for loop to apply comparison to one element at a time, R has function <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/ifelse.html">ifelse()</a> that performs the same task on vectors. It format is <code>ifelse(logical-vector, values-if-true, values-if-false)</code> where the logical vector of <code>TRUE</code> and <code>FALSE</code> values can be produced via a comparison. For example, we can classify letters into <code>"Vowel"</code> and <code>"Consonant"</code> using <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/match.html">%in%</a> to check whether each letter is <em>in</em> the <code>vowels</code> list (note the <code>%</code>, this distinguished <code>%in%</code> for matching from <code>in</code> of the for loop).</p>
<div class="sourceCode" id="cb402"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vowels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"e"</span>, <span class="st">"i"</span>, <span class="st">"o"</span>, <span class="st">"u"</span><span class="op">)</span></span>
<span><span class="va">letters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>, <span class="st">"d"</span>, <span class="st">"e"</span>, <span class="st">"f"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">letters</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">vowels</span>, <span class="st">"Vowel"</span>, <span class="st">"Consonant"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "Vowel"     "Consonant" "Consonant" "Consonant" "Vowel"     "Consonant"</code></pre>
<p>Note that vectors <code>values-if-true</code> and <code>values-if-false</code> must not be of equal length. For example, one can use <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/ifelse.html">ifelse()</a> to replace only vowels in the original vector but keep consonant letter as is by using <code>letters</code> vector for <code>values-if-false</code></p>
<div class="sourceCode" id="cb404"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">letters</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">vowels</span>, <span class="st">"Vowel"</span>, <span class="va">letters</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "Vowel" "b"     "c"     "d"     "Vowel" "f"</code></pre>
<p>However vectors <code>values-if-true</code> and <code>values-if-false</code> ideally should either match the length of the logical comparison vector or have a single value. Otherwise, they will be recycled which might lead to confusing results. E.g., here, can you figure out when <code>"Consonant1"</code> and <code>"Consonant2"</code> are used?</p>
<div class="sourceCode" id="cb406"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">letters</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">vowels</span>, <span class="st">"Vowel"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Consonant1"</span>, <span class="st">"Consonant2"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "Vowel"      "Consonant2" "Consonant1" "Consonant2" "Vowel"     
## [6] "Consonant2"</code></pre>
<p>Use <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/ifelse.html">ifelse()</a> to replicate exercise 8 without a loop.</p>
<div class="practice">
<p>Do exercise 9.</p>
</div>
</div>
<div id="case_when" class="section level2" number="9.6">
<h2>
<span class="header-section-number">9.6</span> case_when<a class="anchor" aria-label="anchor" href="#case_when"><i class="fas fa-link"></i></a>
</h2>
<p>Function <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/ifelse.html">ifelse()</a> is useful when you have just two outcomes. You can use nested <code>ifelse</code> calls, just like you can use nested <code>if-else</code> statements but it becomes awkward and hard to read very fast. Instead, you can use function <a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a> from <a href="https://dplyr.tidyverse.org/">dplyr</a> library. Here, you can use as many conditions as you want. The general format is</p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="control-flow-chapter.html#cb408-1" tabindex="-1"></a><span class="fu">case_when</span>(Condition1 <span class="sc">~</span> Value1,</span>
<span id="cb408-2"><a href="control-flow-chapter.html#cb408-2" tabindex="-1"></a>          Condition2 <span class="sc">~</span> Value2,</span>
<span id="cb408-3"><a href="control-flow-chapter.html#cb408-3" tabindex="-1"></a>          ...</span>
<span id="cb408-4"><a href="control-flow-chapter.html#cb408-4" tabindex="-1"></a>          ConditionN <span class="sc">~</span> ValueN)</span></code></pre></div>
<p>For example, the internet tells me that letter <code>y</code> is complicated, as it can be either a consonant or a vowel depending on a word. Thus, we can label it as “Complicated” via <a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a> (note the vectorized nature of it, as it applies this comparison to one element of the vector at a time)</p>
<div class="sourceCode" id="cb409"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vowels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"e"</span>, <span class="st">"i"</span>, <span class="st">"o"</span>, <span class="st">"u"</span><span class="op">)</span></span>
<span><span class="va">letters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>, <span class="st">"d"</span>, <span class="st">"e"</span>, <span class="st">"f"</span>, <span class="st">"y"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span><span class="va">letters</span> <span class="op">==</span> <span class="st">"y"</span> <span class="op">~</span> <span class="st">"Complicated"</span>,</span>
<span>          <span class="va">letters</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">vowels</span> <span class="op">~</span> <span class="st">"Vowel"</span>,</span>
<span>          <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"Consonant"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "Vowel"       "Consonant"   "Consonant"   "Consonant"   "Vowel"      
## [6] "Consonant"   "Complicated"</code></pre>
<p>Note the last condition that is always <code>TRUE</code>, it looks odd but this servers as a “default” branch: if you got that far, all other conditions must be <code>FALSE</code>, so this <em>must</em> be <code>TRUE</code> (you have no other options left).</p>
<div class="practice">
<p>Do exercise 10.</p>
</div>
</div>
<div id="breaking-out-of-the-loop" class="section level2" number="9.7">
<h2>
<span class="header-section-number">9.7</span> Breaking out of the loop<a class="anchor" aria-label="anchor" href="#breaking-out-of-the-loop"><i class="fas fa-link"></i></a>
</h2>
<p>The code inside the <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/Control.html">for</a> loop is typically repeated for every value of the vector that you have supplied. However, there is a way to <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/Control.html">break</a> out of it using a <code><a href="https://rdrr.io/r/base/Control.html">break</a></code> statement. This stops execution of the code <em>inside</em> of the loop immediately and continues with the code immediately <em>after</em> the loop.</p>
<div class="sourceCode" id="cb411"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span><span class="op">(</span><span class="va">y</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"This will be exected"</span><span class="op">)</span></span>
<span>  <span class="kw">break</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"But this won't be"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code>## [1] "This will be exected"</code></pre>
<div class="sourceCode" id="cb413"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Now to the code AFTER the loop"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "Now to the code AFTER the loop"</code></pre>
<p>Note that in this case, the code was executed (incompletely!) only once. Typically, <code><a href="https://rdrr.io/r/base/Control.html">break</a></code> is used in combination with the <code>if-else</code> statement to break out of the loop, if a certain condition is met. Let us practice. Again, generate ten normally distributed numbers, loop over them and print each one. However, <code><a href="https://rdrr.io/r/base/Control.html">break</a></code> after the <em>fifth</em> value. For this, you need to loop over indexes of values (that go from 1 to the <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/length.html">length()</a> of your vector). Thus, you loop variable will contain an index of each element of <code>x</code> (because of that I called it <code>ix</code>) and you need to use it to get a value at this position within the vector. If that index is equal to 5, break out of the loop.
For the ten values I’ve generated above, the output will be the following (“Done for today” is printed after the loop, also I could have first printed a value and then exited the loop, that is a analysis logic question, not a technical one).</p>
<div class="sourceCode" id="cb415"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">164</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">ix</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">ix</span> <span class="op">==</span> <span class="fl">5</span><span class="op">)</span>  <span class="kw">break</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">ix</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code>## [1] 0.03003683
## [1] 1.223909
## [1] 1.715738
## [1] -0.8999402</code></pre>
<div class="sourceCode" id="cb417"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Done for today"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "Done for today"</code></pre>
<div class="practice">
<p>Do exercise 11.</p>
</div>
</div>
<div id="using-for-loop-to-load-and-join-multiple-data-files" class="section level2" number="9.8">
<h2>
<span class="header-section-number">9.8</span> Using for loop to load and join multiple data files<a class="anchor" aria-label="anchor" href="#using-for-loop-to-load-and-join-multiple-data-files"><i class="fas fa-link"></i></a>
</h2>
<p>Your analysis starts with loading the data. Quite often, data for individual participants is stored in different files but with identical structure, so you need code that figures out which files you need to load, loads them one at a time and then binds them to one final table. Using a <code>for</code> loop is not the most elegant way to implement this but it does the job and gives you another example of how loops can be useful. I will walk you through details and then you We will implement the code that loads and merges individual files for persistence study. Download the <a href="data/persistence.zip">persistence.zip</a> and unzip into <code>Persistence</code> subfolder (we do not want to create a mess in your main folder!).</p>
<p>First, you need to have a character vector with relevant file names. Package you are looking for is <a href="https://github.com/r-lib/fs">fs</a> (for File System). It has everything you need to work with the file system, including working with file names (dropping or adding path, extension, etc.), creating/moving/deleting files, checking whether file exists, and what not. One function that I use the most is <a href="https://www.rdocumentation.org/packages/fs/versions/1.5.0/topics/dir_ls">dir_ls()</a> that list files in a specified folder. The two parameters you need are <code>path</code> to your folder (you can and should use a relative path) and, optionally, <code>glob</code> filter string. The latter is a <a href="https://en.wikipedia.org/wiki/Glob_(programming)">globbing</a> wildcard pattern, where <code>*</code> stands for “any sequence of characters” and <code>?</code> stand for “one arbitrary character. For a csv file, this pattern would be <code>"*.csv"</code>. Test this single function call using appropriate <code>path</code> and <code>glob</code> parameters and make sure you get all the files in <em>Persistence</em> folder.</p>
Next, you need to create a full table variable (I, typically, call it <code>results</code> or <code>reports</code>) and initialize it to an empty <code><a href="https://rdrr.io/r/base/data.frame.html">data.frame()</a></code> (or an empty <code>tibble</code>). You loop over file names, <a href="tables.html#readr">read</a> one file at a time (don’t forget to specify column types), and then use <a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows()</a> to combine the full table and the new table you loaded. Note that <a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows()</a> returns a <em>new</em> table, so you need to assign it back to the original full table variable. Once you are done, your table should have 5232 rows and twelve columns.
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:left;">
Participant
</th>
<th style="text-align:left;">
Session
</th>
<th style="text-align:right;">
Block
</th>
<th style="text-align:right;">
Trial
</th>
<th style="text-align:right;">
OnsetDelay
</th>
<th style="text-align:left;">
Bias
</th>
<th style="text-align:left;">
Shape1
</th>
<th style="text-align:left;">
Shape2
</th>
<th style="text-align:left;">
Response1
</th>
<th style="text-align:left;">
Response2
</th>
<th style="text-align:right;">
RT1
</th>
<th style="text-align:right;">
RT2
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
AKM1995M
</td>
<td style="text-align:left;">
2019-06-12-14-07-17
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.5746952
</td>
<td style="text-align:left;">
left
</td>
<td style="text-align:left;">
stripes-8
</td>
<td style="text-align:left;">
stripes-4
</td>
<td style="text-align:left;">
right
</td>
<td style="text-align:left;">
left
</td>
<td style="text-align:right;">
5.0554813
</td>
<td style="text-align:right;">
1.0238089
</td>
</tr>
<tr>
<td style="text-align:left;">
AKM1995M
</td>
<td style="text-align:left;">
2019-06-12-14-07-17
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.5741707
</td>
<td style="text-align:left;">
left
</td>
<td style="text-align:left;">
stripes-4
</td>
<td style="text-align:left;">
heavy poles sphere
</td>
<td style="text-align:left;">
left
</td>
<td style="text-align:left;">
right
</td>
<td style="text-align:right;">
2.9692460
</td>
<td style="text-align:right;">
0.8239294
</td>
</tr>
<tr>
<td style="text-align:left;">
AKM1995M
</td>
<td style="text-align:left;">
2019-06-12-14-07-17
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.5082200
</td>
<td style="text-align:left;">
left
</td>
<td style="text-align:left;">
stripes-2
</td>
<td style="text-align:left;">
stripes-2
</td>
<td style="text-align:left;">
right
</td>
<td style="text-align:left;">
left
</td>
<td style="text-align:right;">
3.1623310
</td>
<td style="text-align:right;">
0.6718403
</td>
</tr>
<tr>
<td style="text-align:left;">
AKM1995M
</td>
<td style="text-align:left;">
2019-06-12-14-07-17
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.6065058
</td>
<td style="text-align:left;">
right
</td>
<td style="text-align:left;">
stripes-8
</td>
<td style="text-align:left;">
stripes-2
</td>
<td style="text-align:left;">
right
</td>
<td style="text-align:left;">
right
</td>
<td style="text-align:right;">
1.0211627
</td>
<td style="text-align:right;">
0.5919555
</td>
</tr>
<tr>
<td style="text-align:left;">
AKM1995M
</td>
<td style="text-align:left;">
2019-06-12-14-07-17
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0.5359504
</td>
<td style="text-align:left;">
left
</td>
<td style="text-align:left;">
stripes-2
</td>
<td style="text-align:left;">
heavy poles sphere
</td>
<td style="text-align:left;">
right
</td>
<td style="text-align:left;">
right
</td>
<td style="text-align:right;">
0.9426957
</td>
<td style="text-align:right;">
0.6157635
</td>
</tr>
<tr>
<td style="text-align:left;">
AKM1995M
</td>
<td style="text-align:left;">
2019-06-12-14-07-17
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.6435367
</td>
<td style="text-align:left;">
right
</td>
<td style="text-align:left;">
stripes-4
</td>
<td style="text-align:left;">
stripes-4
</td>
<td style="text-align:left;">
right
</td>
<td style="text-align:left;">
right
</td>
<td style="text-align:right;">
1.1646056
</td>
<td style="text-align:right;">
0.6398231
</td>
</tr>
</tbody>
</table></div>
<div class="practice">
<p>Do exercise 12.</p>
</div>
</div>
<div id="apply" class="section level2" number="9.9">
<h2>
<span class="header-section-number">9.9</span> Apply<a class="anchor" aria-label="anchor" href="#apply"><i class="fas fa-link"></i></a>
</h2>
<p>As noted above, <code>for</code> loops do the job by might not be the most elegant way of doing things. In R, you can <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/apply.html">apply</a> a function to each row or column of a matrix. In addition, there are more case-specific versions of it, such <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/lapply.html">lapply</a>.</p>
<p>The function is called <code>apply</code> because you <em>apply</em> it to values of a vector. In a sense, you have been applying functions the whole time by calling them. For example, we might compute a sinus of a sequence of numbers as</p>
<div class="sourceCode" id="cb419"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">pi</span>, length.out <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0.000000e+00 7.071068e-01 1.000000e+00 7.071068e-01 1.224606e-16</code></pre>
<p>Or, we can <em>apply</em> sinus function to a number sequence (note that I pass the name of the function alone <code>sin</code> but do not call it, so no round brackets!)</p>
<div class="sourceCode" id="cb421"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">pi</span>, length.out <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, <span class="va">sin</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0.000000e+00 7.071068e-01 1.000000e+00 7.071068e-01 1.224606e-16</code></pre>
<p>You might ask, what is then the point to use <code>apply</code>? Not much for simple vector cases like this, but it is very useful when you have two dimensional data, as you can apply a function along horizontal (rows) or vertical (columns) margin. For example, imagine you need to compute an average (or median, or any other quantile) of each row or column in a matrix (something you might do fairly often for posterior samples in Bayesian statistics).</p>
<p>Let us create a simple 3 by 4 matrix of normally distributed random numbers.</p>
<div class="sourceCode" id="cb423"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">a_matrix</span></span></code></pre></div>
<pre><code>##               [,1]       [,2]       [,3]       [,4]
## [1,] -1.306076e-05 -0.9815949  0.3981706 -0.1809577
## [2,]  1.880631e-02 -0.4210554 -1.2544423 -0.2319481
## [3,]  2.429102e+00 -1.1964317  0.2265607  0.5361628</code></pre>
<p>We would expect median value of any row or column to be 0 but because we have so few data points, they will be close but not exactly zero. Computing median for each row (we should get <em>three</em> numbers)</p>
<div class="sourceCode" id="cb425"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">a_matrix</span>, MARGIN <span class="op">=</span> <span class="fl">1</span>, FUN <span class="op">=</span> <span class="va">median</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] -0.0904854 -0.3265017  0.3813618</code></pre>
<p>Similarly for a column (here, it should be <em>four</em> numbers)</p>
<div class="sourceCode" id="cb427"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">a_matrix</span>, MARGIN <span class="op">=</span> <span class="fl">2</span>, FUN <span class="op">=</span> <span class="va">median</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1]  0.01880631 -0.98159487  0.22656072 -0.18095773</code></pre>
<p>I will not go into any further details on these functions, concentrating on similar functionality by <a href="control-flow-chapter.html#purrr">purrr</a> package. However, if you find yourself working with matrices or needing to apply a function to rows of a data frame, <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/apply.html">apply</a> might be a simpler solution. Keep this option in mind, if you feel that either looping or purrring looks inadequate.</p>
</div>
<div id="purrr" class="section level2" number="9.10">
<h2>
<span class="header-section-number">9.10</span> Purrr<a class="anchor" aria-label="anchor" href="#purrr"><i class="fas fa-link"></i></a>
</h2>
<p>Package <a href="https://purrr.tidyverse.org/">purrr</a> is part of the tidyverse. It provides functional programming approach similar to <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/apply.html">apply</a> but it easier to use (IMHO) and it has a more explicit and consistent way to describe and combine the output. Language-wise, you do not <em>apply</em> a function, you use it to <a href="https://purrr.tidyverse.org/reference/map.html">map</a> inputs on outputs<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Means the same thing but this is a linear algebra way of expressing of what a function does.&lt;/p&gt;"><sup>66</sup></a></p>
<p>The basic <a href="https://purrr.tidyverse.org/reference/map.html">map()</a> function always returns a list but you can explicitly state that you expect function to return a number (<code><a href="https://purrr.tidyverse.org/reference/map.html">map_dbl()</a></code>) and all outputs will be combined into a numeric vector. And, unlike <code>apply</code>, <code><a href="https://purrr.tidyverse.org/reference/map.html">map_dbl()</a></code> will generate an error if outputs cannot be converted to numeric.</p>
<p>The basic call is similar to <a href="control-flow-chapter.html#apply">apply</a> but is easier to use as you can explicitly address current value via <code>.</code> variable (as in other parts of Tidyverse) and you can write a “normal” function call, prefixing it with a <code>~</code>. Here is the example of computing the sinus again. First, same a <code>apply</code> via function name only</p>
<div class="sourceCode" id="cb429"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_dbl</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">pi</span>, length.out <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, <span class="va">sin</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0.000000e+00 7.071068e-01 1.000000e+00 7.071068e-01 1.224606e-16</code></pre>
<p>Now, we a magic tilde <code>~</code>. Note an explicit call to <code><a href="https://rdrr.io/r/base/Trig.html">sin()</a></code> function with <code>.</code> as an argument.</p>
<div class="sourceCode" id="cb431"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_dbl</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">pi</span>, length.out <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0.000000e+00 7.071068e-01 1.000000e+00 7.071068e-01 1.224606e-16</code></pre>
<p>Again, using <code><a href="https://purrr.tidyverse.org/reference/map.html">map_dbl()</a></code> in this case looks as a complete overkill. So let us do something more relevant. Let us implement loading and merging of persistence study files. You already know how to get a vector with names of relevant files. Now you can use <a href="https://purrr.tidyverse.org/reference/map.html">map()</a> function on this vector to generate a list of tables and then combine them into a single table by piping it to <a href="https://purrr.tidyverse.org/reference/list_c.html">list_rbind()</a> which binds tables by rows (there is a twin <code><a href="https://purrr.tidyverse.org/reference/list_c.html">list_cbind()</a></code> function that binds table by columns). When using <code>~</code> call notation, remember <code>.</code> would then correspond to a single value from the vector of file names (so, a <em>single</em> filename). Again, you should get a single table with twelve columns and 5232 rows. You need a <em>single</em> pipeline for the entire operation.</p>
<div class="practice">
<p>Do exercise 13.</p>
</div>
<p>You have just <em>mapped</em> inputs on outputs using <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv()</a></code> but functional programming is particularly useful, if you program your own functions. Let us program a function that takes a filename, loads the file and returns total number of trials/rows (if you forgot how to compute number of rows in a table, see <a href="control-flow-chapter.html#forloop">above</a>). Once you have a function, use it with <code>map_dbl</code> and a vector of persistence filenames. You should get a vector of ten values. Now we can easily see that there was something wrong with one of the files and we must pay attention to the amount of data that we have.</p>
<pre><code>##  [1] 528 528 480 528 528 528 528 528 528 528</code></pre>
<div class="practice">
<p>Do exercise 14.</p>
</div>

</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="tyding.html"><span class="header-section-number">8</span> Tidyng your data: joins and pivots</a></div>
<div class="next"><a href="missing-data.html"><span class="header-section-number">10</span> Missing data</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#control-flow-chapter"><span class="header-section-number">9</span> Controling computation flow</a></li>
<li><a class="nav-link" href="#rep"><span class="header-section-number">9.1</span> rep()</a></li>
<li><a class="nav-link" href="#repeating-combinations"><span class="header-section-number">9.2</span> Repeating combinations</a></li>
<li><a class="nav-link" href="#forloop"><span class="header-section-number">9.3</span> For loop</a></li>
<li><a class="nav-link" href="#if-else"><span class="header-section-number">9.4</span> Conditional statement</a></li>
<li><a class="nav-link" href="#ifelse"><span class="header-section-number">9.5</span> ifelse()</a></li>
<li><a class="nav-link" href="#case_when"><span class="header-section-number">9.6</span> case_when</a></li>
<li><a class="nav-link" href="#breaking-out-of-the-loop"><span class="header-section-number">9.7</span> Breaking out of the loop</a></li>
<li><a class="nav-link" href="#using-for-loop-to-load-and-join-multiple-data-files"><span class="header-section-number">9.8</span> Using for loop to load and join multiple data files</a></li>
<li><a class="nav-link" href="#apply"><span class="header-section-number">9.9</span> Apply</a></li>
<li><a class="nav-link" href="#purrr"><span class="header-section-number">9.10</span> Purrr</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/alexander-pastukhov/data-analysis-using-r-for-psychology/blob/master/09-control-flow.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/alexander-pastukhov/data-analysis-using-r-for-psychology/edit/master/09-control-flow.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Data analysis using R for Psychology and Social Science</strong>" was written by Alexander (Sasha) Pastukhov. It was last built on 2024-01-17.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>Please note that this website collects anonymized data via Google analytics. This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
