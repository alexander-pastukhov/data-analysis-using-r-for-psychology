<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Seminar 11 Statistical modeling | Data analysis using R for Psychology and Social Science</title>
  <meta name="description" content="Material and exercises for ‘Applied data analysis for psychology using the open-source software R’ seminar." />
  <meta name="generator" content="bookdown 0.23 and GitBook 2.6.7" />

  <meta property="og:title" content="Seminar 11 Statistical modeling | Data analysis using R for Psychology and Social Science" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Material and exercises for ‘Applied data analysis for psychology using the open-source software R’ seminar." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Seminar 11 Statistical modeling | Data analysis using R for Psychology and Social Science" />
  
  <meta name="twitter:description" content="Material and exercises for ‘Applied data analysis for psychology using the open-source software R’ seminar." />
  

<meta name="author" content="Alexander (Sasha) Pastukhov" />


<meta name="date" content="2021-10-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="seminar10.html"/>
<link rel="next" href="seminar12.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="font-awesome.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data analysis using R for Psychology</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-r"><i class="fa fa-check"></i>Why R?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-tidyverse"><i class="fa fa-check"></i>Why Tidyverse</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-seminar"><i class="fa fa-check"></i>About the seminar</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#thinking-like-a-computer"><i class="fa fa-check"></i>Thinking like a computer</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-material"><i class="fa fa-check"></i>About the material</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="software.html"><a href="software.html"><i class="fa fa-check"></i>Software</a>
<ul>
<li class="chapter" data-level="0.1" data-path="software.html"><a href="software.html#install-r"><i class="fa fa-check"></i><b>0.1</b> Installing R</a></li>
<li class="chapter" data-level="0.2" data-path="software.html"><a href="software.html#install-rstudio"><i class="fa fa-check"></i><b>0.2</b> Installing R-Studio</a></li>
<li class="chapter" data-level="0.3" data-path="software.html"><a href="software.html#install-rtools"><i class="fa fa-check"></i><b>0.3</b> Installing RTools</a></li>
<li class="chapter" data-level="" data-path="software.html"><a href="software.html#install.packages"><i class="fa fa-check"></i>Installing packages</a></li>
<li class="chapter" data-level="0.4" data-path="software.html"><a href="software.html#minimal-set-of-packages"><i class="fa fa-check"></i><b>0.4</b> Minimal set of packages</a></li>
<li class="chapter" data-level="0.5" data-path="software.html"><a href="software.html#installr"><i class="fa fa-check"></i><b>0.5</b> Keeping R and packages up-to-date</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="reproducable-research.html"><a href="reproducable-research.html"><i class="fa fa-check"></i><b>1</b> Reproducable Research: Projects and RMarkdown Notebooks</a>
<ul>
<li class="chapter" data-level="1.1" data-path="reproducable-research.html"><a href="reproducable-research.html#projects"><i class="fa fa-check"></i><b>1.1</b> Projects</a></li>
<li class="chapter" data-level="1.2" data-path="reproducable-research.html"><a href="reproducable-research.html#rmarkdown"><i class="fa fa-check"></i><b>1.2</b> RMarkdown</a></li>
<li class="chapter" data-level="1.3" data-path="reproducable-research.html"><a href="reproducable-research.html#exercise"><i class="fa fa-check"></i><b>1.3</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="vectors.html"><a href="vectors.html"><i class="fa fa-check"></i><b>2</b> Vectors! Vectors everywhere!</a>
<ul>
<li class="chapter" data-level="2.1" data-path="vectors.html"><a href="vectors.html#variables"><i class="fa fa-check"></i><b>2.1</b> Variables as boxes</a></li>
<li class="chapter" data-level="2.2" data-path="vectors.html"><a href="vectors.html#assignment-statement"><i class="fa fa-check"></i><b>2.2</b> Assignment statement in detail</a></li>
<li class="chapter" data-level="2.3" data-path="vectors.html"><a href="vectors.html#vectors-scalars"><i class="fa fa-check"></i><b>2.3</b> Vectors and singluar values (scalars, which are also vectors)</a></li>
<li class="chapter" data-level="2.4" data-path="vectors.html"><a href="vectors.html#vector-index"><i class="fa fa-check"></i><b>2.4</b> Vector indexes (subsetting)</a></li>
<li class="chapter" data-level="2.5" data-path="vectors.html"><a href="vectors.html#names"><i class="fa fa-check"></i><b>2.5</b> Names as an Index</a></li>
<li class="chapter" data-level="2.6" data-path="vectors.html"><a href="vectors.html#vector-index-slicing"><i class="fa fa-check"></i><b>2.6</b> Slicing</a></li>
<li class="chapter" data-level="2.7" data-path="vectors.html"><a href="vectors.html#colon-sequence"><i class="fa fa-check"></i><b>2.7</b> Colon Operator and Sequence Generation</a></li>
<li class="chapter" data-level="2.8" data-path="vectors.html"><a href="vectors.html#working-with-two-vectors-of-equal-length"><i class="fa fa-check"></i><b>2.8</b> Working with two vectors of <em>equal</em> length</a></li>
<li class="chapter" data-level="2.9" data-path="vectors.html"><a href="vectors.html#different-length-vectors"><i class="fa fa-check"></i><b>2.9</b> Working with two vectors of <em>different</em> length</a></li>
<li class="chapter" data-level="2.10" data-path="vectors.html"><a href="vectors.html#applying-functions-to-a-vector"><i class="fa fa-check"></i><b>2.10</b> Applying functions to a vector</a></li>
<li class="chapter" data-level="2.11" data-path="vectors.html"><a href="vectors.html#wrap-up"><i class="fa fa-check"></i><b>2.11</b> Wrap up</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tables.html"><a href="tables.html"><i class="fa fa-check"></i><b>3</b> Tables and Tibbles (and Tribbles)</a>
<ul>
<li class="chapter" data-level="3.1" data-path="tables.html"><a href="tables.html#primary-types"><i class="fa fa-check"></i><b>3.1</b> Primary data types</a></li>
<li class="chapter" data-level="3.2" data-path="tables.html"><a href="tables.html#vectors-are-homogeneous"><i class="fa fa-check"></i><b>3.2</b> All vector values must be of the same type</a></li>
<li class="chapter" data-level="3.3" data-path="tables.html"><a href="tables.html#lists"><i class="fa fa-check"></i><b>3.3</b> Lists</a></li>
<li class="chapter" data-level="3.4" data-path="tables.html"><a href="tables.html#subsetting"><i class="fa fa-check"></i><b>3.4</b> Subsetting, a fuller version</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="tables.html"><a href="tables.html#subsetting-for-atomics-vectors"><i class="fa fa-check"></i><b>3.4.1</b> Subsetting for (atomics) vectors</a></li>
<li class="chapter" data-level="3.4.2" data-path="tables.html"><a href="tables.html#subsetting-for-lists"><i class="fa fa-check"></i><b>3.4.2</b> Subsetting for lists</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="tables.html"><a href="tables.html#dollar-subsetting"><i class="fa fa-check"></i><b>3.5</b> Yet another subsetting via $</a></li>
<li class="chapter" data-level="3.6" data-path="tables.html"><a href="tables.html#data.frame"><i class="fa fa-check"></i><b>3.6</b> Tables, a.k.a. data frames</a></li>
<li class="chapter" data-level="3.7" data-path="tables.html"><a href="tables.html#table-subsetting"><i class="fa fa-check"></i><b>3.7</b> Subsetting tables</a></li>
<li class="chapter" data-level="3.8" data-path="tables.html"><a href="tables.html#library"><i class="fa fa-check"></i><b>3.8</b> Using libraries</a></li>
<li class="chapter" data-level="3.9" data-path="tables.html"><a href="tables.html#tibble"><i class="fa fa-check"></i><b>3.9</b> Tibble, a better data.frame</a></li>
<li class="chapter" data-level="3.10" data-path="tables.html"><a href="tables.html#tribble"><i class="fa fa-check"></i><b>3.10</b> Tribble, table from text</a></li>
<li class="chapter" data-level="3.11" data-path="tables.html"><a href="tables.html#data"><i class="fa fa-check"></i><b>3.11</b> Reading example tables</a></li>
<li class="chapter" data-level="3.12" data-path="tables.html"><a href="tables.html#readr"><i class="fa fa-check"></i><b>3.12</b> Reading csv files</a></li>
<li class="chapter" data-level="3.13" data-path="tables.html"><a href="tables.html#readxl"><i class="fa fa-check"></i><b>3.13</b> Reading Excel files</a></li>
<li class="chapter" data-level="3.14" data-path="tables.html"><a href="tables.html#reading-files-from-other-programs"><i class="fa fa-check"></i><b>3.14</b> Reading files from other programs</a></li>
<li class="chapter" data-level="3.15" data-path="tables.html"><a href="tables.html#wrap-up-1"><i class="fa fa-check"></i><b>3.15</b> Wrap up</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>4</b> Functions! Functions everywhere!</a>
<ul>
<li class="chapter" data-level="4.1" data-path="functions.html"><a href="functions.html#functions-1"><i class="fa fa-check"></i><b>4.1</b> Functions</a></li>
<li class="chapter" data-level="4.2" data-path="functions.html"><a href="functions.html#writing-a-function"><i class="fa fa-check"></i><b>4.2</b> Writing a function</a></li>
<li class="chapter" data-level="4.3" data-path="functions.html"><a href="functions.html#scopes-global-versus-local-variables"><i class="fa fa-check"></i><b>4.3</b> Scopes: Global versus Local variables</a></li>
<li class="chapter" data-level="4.4" data-path="functions.html"><a href="functions.html#function-with-two-parameters"><i class="fa fa-check"></i><b>4.4</b> Function with two parameters</a></li>
<li class="chapter" data-level="4.5" data-path="functions.html"><a href="functions.html#table-as-a-parameter"><i class="fa fa-check"></i><b>4.5</b> Table as a parameter</a></li>
<li class="chapter" data-level="4.6" data-path="functions.html"><a href="functions.html#named-versus-positional-arguments"><i class="fa fa-check"></i><b>4.6</b> Named versus positional arguments</a></li>
<li class="chapter" data-level="4.7" data-path="functions.html"><a href="functions.html#default-values"><i class="fa fa-check"></i><b>4.7</b> Default values</a></li>
<li class="chapter" data-level="4.8" data-path="functions.html"><a href="functions.html#nested-calls"><i class="fa fa-check"></i><b>4.8</b> Nested calls</a></li>
<li class="chapter" data-level="4.9" data-path="functions.html"><a href="functions.html#pipe"><i class="fa fa-check"></i><b>4.9</b> Piping</a></li>
<li class="chapter" data-level="4.10" data-path="functions.html"><a href="functions.html#function-is-just-a-code-stored-in-a-variable"><i class="fa fa-check"></i><b>4.10</b> Function is just a code stored in a variable</a></li>
<li class="chapter" data-level="4.11" data-path="functions.html"><a href="functions.html#functions-functions-everywhere"><i class="fa fa-check"></i><b>4.11</b> Functions! Functions everywhere!</a></li>
<li class="chapter" data-level="4.12" data-path="functions.html"><a href="functions.html#using-or-not-using-explicit-return-statement"><i class="fa fa-check"></i><b>4.12</b> Using (or not using) explicit return statement</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>5</b> Grammar of Graphics</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ggplot2.html"><a href="ggplot2.html#tidydata"><i class="fa fa-check"></i><b>5.1</b> Tidy data</a></li>
<li class="chapter" data-level="5.2" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-1"><i class="fa fa-check"></i><b>5.2</b> ggplot2</a></li>
<li class="chapter" data-level="5.3" data-path="ggplot2.html"><a href="ggplot2.html#auto-efficiency-continuous-x-axis"><i class="fa fa-check"></i><b>5.3</b> Auto efficiency: continuous x-axis</a></li>
<li class="chapter" data-level="5.4" data-path="ggplot2.html"><a href="ggplot2.html#auto-efficiency-discrete-x-axis"><i class="fa fa-check"></i><b>5.4</b> Auto efficiency: discrete x-axis</a></li>
<li class="chapter" data-level="5.5" data-path="ggplot2.html"><a href="ggplot2.html#mammals-sleep-single-variable"><i class="fa fa-check"></i><b>5.5</b> Mammals sleep: single variable</a></li>
<li class="chapter" data-level="5.6" data-path="ggplot2.html"><a href="ggplot2.html#mapping-for-all-visuals-versus-just-one-visual"><i class="fa fa-check"></i><b>5.6</b> Mapping for all visuals versus just one visual</a></li>
<li class="chapter" data-level="5.7" data-path="ggplot2.html"><a href="ggplot2.html#mapping-on-variables-versus-constants"><i class="fa fa-check"></i><b>5.7</b> Mapping on variables versus constants</a></li>
<li class="chapter" data-level="5.8" data-path="ggplot2.html"><a href="ggplot2.html#themes"><i class="fa fa-check"></i><b>5.8</b> Themes</a></li>
<li class="chapter" data-level="5.9" data-path="ggplot2.html"><a href="ggplot2.html#you-aint-seen-nothing-yet"><i class="fa fa-check"></i><b>5.9</b> You ain’t seen nothing yet</a></li>
<li class="chapter" data-level="5.10" data-path="ggplot2.html"><a href="ggplot2.html#further-reading"><i class="fa fa-check"></i><b>5.10</b> Further reading</a></li>
<li class="chapter" data-level="5.11" data-path="ggplot2.html"><a href="ggplot2.html#extending-ggplot2"><i class="fa fa-check"></i><b>5.11</b> Extending ggplot2</a></li>
<li class="chapter" data-level="5.12" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-cannot-do-everything"><i class="fa fa-check"></i><b>5.12</b> ggplot2 cannot do everything</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="dplyr.html"><a href="dplyr.html"><i class="fa fa-check"></i><b>6</b> Tidyverse: dplyr</a>
<ul>
<li class="chapter" data-level="6.1" data-path="dplyr.html"><a href="dplyr.html#tidyverse-philosophy"><i class="fa fa-check"></i><b>6.1</b> Tidyverse philosophy</a></li>
<li class="chapter" data-level="6.2" data-path="dplyr.html"><a href="dplyr.html#select"><i class="fa fa-check"></i><b>6.2</b> <code>select()</code> columns by name</a></li>
<li class="chapter" data-level="6.3" data-path="dplyr.html"><a href="dplyr.html#conditions"><i class="fa fa-check"></i><b>6.3</b> Conditions</a></li>
<li class="chapter" data-level="6.4" data-path="dplyr.html"><a href="dplyr.html#logical-indexing"><i class="fa fa-check"></i><b>6.4</b> Logical indexing</a></li>
<li class="chapter" data-level="6.5" data-path="dplyr.html"><a href="dplyr.html#filter-rows-by-values"><i class="fa fa-check"></i><b>6.5</b> <code>filter()</code> rows by values</a></li>
<li class="chapter" data-level="6.6" data-path="dplyr.html"><a href="dplyr.html#arrange-rows-in-a-particular-order"><i class="fa fa-check"></i><b>6.6</b> <code>arrange()</code> rows in a particular order</a></li>
<li class="chapter" data-level="6.7" data-path="dplyr.html"><a href="dplyr.html#mutate"><i class="fa fa-check"></i><b>6.7</b> <code>mutate()</code> columns</a></li>
<li class="chapter" data-level="6.8" data-path="dplyr.html"><a href="dplyr.html#summarize"><i class="fa fa-check"></i><b>6.8</b> <code>summarize()</code> table by <code>groups</code></a></li>
<li class="chapter" data-level="6.9" data-path="dplyr.html"><a href="dplyr.html#putting-it-all-together"><i class="fa fa-check"></i><b>6.9</b> Putting it all together</a></li>
<li class="chapter" data-level="6.10" data-path="dplyr.html"><a href="dplyr.html#should-i-use-tidyverse"><i class="fa fa-check"></i><b>6.10</b> Should I use Tidyverse?</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="seminar07.html"><a href="seminar07.html"><i class="fa fa-check"></i><b>7</b> Factors and Joins</a>
<ul>
<li class="chapter" data-level="7.1" data-path="seminar07.html"><a href="seminar07.html#how-to-write-code"><i class="fa fa-check"></i><b>7.1</b> How to write code</a></li>
<li class="chapter" data-level="7.2" data-path="seminar07.html"><a href="seminar07.html#implementing-a-typical-analysis"><i class="fa fa-check"></i><b>7.2</b> Implementing a typical analysis</a></li>
<li class="chapter" data-level="7.3" data-path="seminar07.html"><a href="seminar07.html#factors"><i class="fa fa-check"></i><b>7.3</b> Factors</a></li>
<li class="chapter" data-level="7.4" data-path="seminar07.html"><a href="seminar07.html#forcats"><i class="fa fa-check"></i><b>7.4</b> Forcats</a></li>
<li class="chapter" data-level="7.5" data-path="seminar07.html"><a href="seminar07.html#plotting-group-averages"><i class="fa fa-check"></i><b>7.5</b> Plotting group averages</a></li>
<li class="chapter" data-level="7.6" data-path="seminar07.html"><a href="seminar07.html#plotting-our-confidence-in-group-averages"><i class="fa fa-check"></i><b>7.6</b> Plotting our confidence in group averages</a></li>
<li class="chapter" data-level="7.7" data-path="seminar07.html"><a href="seminar07.html#looking-at-similarity"><i class="fa fa-check"></i><b>7.7</b> Looking at similarity</a></li>
<li class="chapter" data-level="7.8" data-path="seminar07.html"><a href="seminar07.html#joining-tables"><i class="fa fa-check"></i><b>7.8</b> Joining tables</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="seminar08.html"><a href="seminar08.html"><i class="fa fa-check"></i><b>8</b> Glueing and sprintfing</a>
<ul>
<li class="chapter" data-level="8.1" data-path="seminar08.html"><a href="seminar08.html#comparing-effect-between-two-studies"><i class="fa fa-check"></i><b>8.1</b> Comparing effect between two studies</a></li>
<li class="chapter" data-level="8.2" data-path="seminar08.html"><a href="seminar08.html#glue"><i class="fa fa-check"></i><b>8.2</b> Gluing in correlation strength information.</a></li>
<li class="chapter" data-level="8.3" data-path="seminar08.html"><a href="seminar08.html#sprintf"><i class="fa fa-check"></i><b>8.3</b> sprintf</a></li>
<li class="chapter" data-level="8.4" data-path="seminar08.html"><a href="seminar08.html#wrap-up-2"><i class="fa fa-check"></i><b>8.4</b> Wrap up</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="seminar09.html"><a href="seminar09.html"><i class="fa fa-check"></i><b>9</b> Tidyng your data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="seminar09.html"><a href="seminar09.html#pivoting-between-long-and-wide-format"><i class="fa fa-check"></i><b>9.1</b> Pivoting between long and wide format</a></li>
<li class="chapter" data-level="9.2" data-path="seminar09.html"><a href="seminar09.html#practice-pivoting-longer"><i class="fa fa-check"></i><b>9.2</b> Practice pivoting longer</a></li>
<li class="chapter" data-level="9.3" data-path="seminar09.html"><a href="seminar09.html#practice-pivoting-wider"><i class="fa fa-check"></i><b>9.3</b> Practice pivoting wider</a></li>
<li class="chapter" data-level="9.4" data-path="seminar09.html"><a href="seminar09.html#extracting-information-from-a-string"><i class="fa fa-check"></i><b>9.4</b> Extracting information from a string</a></li>
<li class="chapter" data-level="9.5" data-path="seminar09.html"><a href="seminar09.html#separate"><i class="fa fa-check"></i><b>9.5</b> Separate</a></li>
<li class="chapter" data-level="9.6" data-path="seminar09.html"><a href="seminar09.html#missing-data"><i class="fa fa-check"></i><b>9.6</b> Missing data</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="seminar10.html"><a href="seminar10.html"><i class="fa fa-check"></i><b>10</b> Repeating a computation</a>
<ul>
<li class="chapter" data-level="10.1" data-path="seminar10.html"><a href="seminar10.html#rep"><i class="fa fa-check"></i><b>10.1</b> <code>rep()</code></a></li>
<li class="chapter" data-level="10.2" data-path="seminar10.html"><a href="seminar10.html#repeating-combinations"><i class="fa fa-check"></i><b>10.2</b> Repeating combinations</a></li>
<li class="chapter" data-level="10.3" data-path="seminar10.html"><a href="seminar10.html#list"><i class="fa fa-check"></i><b>10.3</b> Lists</a></li>
<li class="chapter" data-level="10.4" data-path="seminar10.html"><a href="seminar10.html#forloop"><i class="fa fa-check"></i><b>10.4</b> For loop</a></li>
<li class="chapter" data-level="10.5" data-path="seminar10.html"><a href="seminar10.html#using-for-loop-to-load-and-join-multiple-data-files"><i class="fa fa-check"></i><b>10.5</b> Using for loop to load and join multiple data files</a></li>
<li class="chapter" data-level="10.6" data-path="seminar10.html"><a href="seminar10.html#apply"><i class="fa fa-check"></i><b>10.6</b> Apply</a></li>
<li class="chapter" data-level="10.7" data-path="seminar10.html"><a href="seminar10.html#purrr"><i class="fa fa-check"></i><b>10.7</b> Purrr</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="seminar11.html"><a href="seminar11.html"><i class="fa fa-check"></i><b>11</b> Statistical modeling</a>
<ul>
<li class="chapter" data-level="11.1" data-path="seminar11.html"><a href="seminar11.html#formula-notation"><i class="fa fa-check"></i><b>11.1</b> Formula notation</a></li>
<li class="chapter" data-level="11.2" data-path="seminar11.html"><a href="seminar11.html#correlation"><i class="fa fa-check"></i><b>11.2</b> Correlation</a></li>
<li class="chapter" data-level="11.3" data-path="seminar11.html"><a href="seminar11.html#pairwise-comparisons"><i class="fa fa-check"></i><b>11.3</b> Pairwise comparisons</a></li>
<li class="chapter" data-level="11.4" data-path="seminar11.html"><a href="seminar11.html#anova"><i class="fa fa-check"></i><b>11.4</b> ANOVA</a></li>
<li class="chapter" data-level="11.5" data-path="seminar11.html"><a href="seminar11.html#GLMM"><i class="fa fa-check"></i><b>11.5</b> (Generalized) Linear Models</a></li>
<li class="chapter" data-level="11.6" data-path="seminar11.html"><a href="seminar11.html#generalized-linear-mixed-models"><i class="fa fa-check"></i><b>11.6</b> (Generalized) Linear Mixed Models</a></li>
<li class="chapter" data-level="11.7" data-path="seminar11.html"><a href="seminar11.html#practice"><i class="fa fa-check"></i><b>11.7</b> Practice</a>
<ul>
<li class="chapter" data-level="" data-path="seminar11.html"><a href="seminar11.html#read-files-and-preprocess-data"><i class="fa fa-check"></i>Read files and preprocess data</a></li>
<li class="chapter" data-level="" data-path="seminar11.html"><a href="seminar11.html#accuracy"><i class="fa fa-check"></i>Accuracy</a></li>
<li class="chapter" data-level="" data-path="seminar11.html"><a href="seminar11.html#response-times"><i class="fa fa-check"></i>Response times</a></li>
<li class="chapter" data-level="" data-path="seminar11.html"><a href="seminar11.html#computing-the-score"><i class="fa fa-check"></i>Computing the score</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="seminar12.html"><a href="seminar12.html"><i class="fa fa-check"></i><b>12</b> Practice</a>
<ul>
<li class="chapter" data-level="12.1" data-path="seminar12.html"><a href="seminar12.html#bad-names-to-good-names"><i class="fa fa-check"></i><b>12.1</b> Bad names to good names</a></li>
<li class="chapter" data-level="12.2" data-path="seminar12.html"><a href="seminar12.html#participant-id"><i class="fa fa-check"></i><b>12.2</b> Participant ID</a></li>
<li class="chapter" data-level="12.3" data-path="seminar12.html"><a href="seminar12.html#factors-1"><i class="fa fa-check"></i><b>12.3</b> Factors</a></li>
<li class="chapter" data-level="12.4" data-path="seminar12.html"><a href="seminar12.html#response-times-1"><i class="fa fa-check"></i><b>12.4</b> Response times</a></li>
<li class="chapter" data-level="12.5" data-path="seminar12.html"><a href="seminar12.html#accuracy-1"><i class="fa fa-check"></i><b>12.5</b> Accuracy</a></li>
<li class="chapter" data-level="12.6" data-path="seminar12.html"><a href="seminar12.html#physiological-signal"><i class="fa fa-check"></i><b>12.6</b> Physiological signal</a></li>
<li class="chapter" data-level="12.7" data-path="seminar12.html"><a href="seminar12.html#wrap-up-3"><i class="fa fa-check"></i><b>12.7</b> Wrap up</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://alexander-pastukhov.github.io/">Alexander (Sasha) Pastukhov</li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data analysis using R for Psychology and Social Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="seminar11" class="section level1" number="11">
<h1><span class="header-section-number">Seminar 11</span> Statistical modeling</h1>
<p>I suspect that this is a seminar that you were waiting for the most as it finally tells you how to call statistical functions in R. However, from my perspective, it is the least useful seminar in the entire course because if you know statistics and you know which specific tool you need, figuring out how to use it in R is fairly trivial. Conversely, if your knowledge of statistics is approximate, knowing how to call functions will do you little good. The catch about statistical models is that they are very easy to run (even if you implement them by hand from scratch) but they are easy to misuse and very hard to interpret<a href="#fn54" class="footnote-ref" id="fnref54"><sup>54</sup></a>.</p>
<p>To make things worse, computers and algorithms do not care. In absolute majority of cases, statistical models will happily accept any input you provide, even if it is completely unsuitable, and spit out numbers. Unfortunately, it is on you, not on the computer, to know what you are doing and whether results even make sense. The only solution to this problem: do not spare any effort to learn statistics. Having a solid understanding of a basic regression analysis will help you in figuring out which statistical tools are applicable and, even more importantly, which will definitely misguide you. This is why I will give an general overview with some examples simulations but I will not explain here when and why you should use a particular tool or how to interpret the outputs. Want to know more? Attend my <strong>Statistical Rethinking</strong> seminar or read an excellent <a href="https://www.routledge.com/Statistical-Rethinking-A-Bayesian-Course-with-Examples-in-R-and-STAN/McElreath/p/book/9780367139919">book</a> by Richard McElreath that the seminar is based on.</p>
<div id="formula-notation" class="section level2" number="11.1">
<h2><span class="header-section-number">11.1</span> Formula notation</h2>
<p>Using statistical models in R is particularly easy because most packages make use of a <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/formula.html">formula</a> to describe a model. Different functions and packages interpret the formula <em>mostly</em> the same way with differences arising due to how random effects or additional parameters are described. Here is an example of a formula:</p>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="seminar11.html#cb401-1" aria-hidden="true" tabindex="-1"></a>y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x1<span class="sc">:</span>x2</span></code></pre></div>
<p>It says that the outcome variable <code>y</code> should be a modeled as a linear combination of an intercept <code>1</code> (can be omitted in a formula), predictor variables <code>x1</code> and <code>x2</code>, plus their interaction <code>x1:x2</code>. This also assume that all these variables are in a single table that you also supply to the function (typically called <code>data</code> parameter). Same formula can be shortened by using <code>*</code> which means “all predictors and their interaction,” thus (omitting redundant intercept)</p>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="seminar11.html#cb402-1" aria-hidden="true" tabindex="-1"></a>y <span class="sc">~</span> x1<span class="sc">*</span>x2</span></code></pre></div>
<p>You can also <em>exclude</em> specific terms via <code>-</code>. So, if you insist that the intercept <em>must</em> go through 0, you write “exclude intercept term” as <code>-1</code></p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="seminar11.html#cb403-1" aria-hidden="true" tabindex="-1"></a>y <span class="sc">~</span> x1<span class="sc">*</span>x2 <span class="sc">-</span> <span class="dv">1</span></span></code></pre></div>
<p>Or you can exclude a specific term or an interaction. The two formulas below are equivalent with a main effect for <code>x2</code> and an interaction term but no main effect for <code>x1</code>. However, I would generally discourage you from using <code>-</code> as the first formula is much harder to understand (or, much easier to misunderstand).</p>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="seminar11.html#cb404-1" aria-hidden="true" tabindex="-1"></a>y <span class="sc">~</span> x1<span class="sc">*</span>x2 <span class="sc">-</span> x1</span>
<span id="cb404-2"><a href="seminar11.html#cb404-2" aria-hidden="true" tabindex="-1"></a>y <span class="sc">~</span> x2 <span class="sc">+</span> x1<span class="sc">:</span>x2</span></code></pre></div>
</div>
<div id="correlation" class="section level2" number="11.2">
<h2><span class="header-section-number">11.2</span> Correlation</h2>
<p>To compute correlation, use function <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/cor.html">cor()</a>. You have a choice of <code>method</code>, either <code>"pearson"</code> (default, Pearson’s product moment correlation coefficient), or rank-based <code>"kendall"</code> (Kendall’s tau) or <code>"spearman"</code> (Spearman’s rho).</p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="seminar11.html#cb405-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> </span>
<span id="cb405-2"><a href="seminar11.html#cb405-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb405-3"><a href="seminar11.html#cb405-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">rnorm</span>(<span class="fu">n</span>(), x, <span class="fl">0.5</span>))</span>
<span id="cb405-4"><a href="seminar11.html#cb405-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(df<span class="sc">$</span>x, df<span class="sc">$</span>y, <span class="at">method=</span><span class="st">&quot;pearson&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 0.8991517</code></pre>
<p>Alternatively, you can use <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/cor.test.html">cor.test()</a> that also computes test statistics and significance.</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="seminar11.html#cb407-1" aria-hidden="true" tabindex="-1"></a>cor_result <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(df<span class="sc">$</span>x, df<span class="sc">$</span>y, <span class="at">method=</span><span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb407-2"><a href="seminar11.html#cb407-2" aria-hidden="true" tabindex="-1"></a>cor_result</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  df$x and df$y
## t = 20.339, df = 98, p-value &lt; 2.2e-16
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.8534634 0.9311242
## sample estimates:
##       cor 
## 0.8991517</code></pre>
<p><code>cor.test</code> returns a list, so you can access its individual elements<a href="#fn55" class="footnote-ref" id="fnref55"><sup>55</sup></a> via a double-bracket or <code>$</code> notation.</p>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="seminar11.html#cb409-1" aria-hidden="true" tabindex="-1"></a>cor_result<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 6.01944e-37</code></pre>
<p>Bayesian correlation with a posterior distribution for the correlation coefficient and Bayes Factor as a measure of significance, can be computed via <code>correlationBF()</code> function, which is part of <a href="https://richarddmorey.github.io/BayesFactor">BayesFactor</a> package.</p>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="seminar11.html#cb411-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(BayesFactor)</span>
<span id="cb411-2"><a href="seminar11.html#cb411-2" aria-hidden="true" tabindex="-1"></a><span class="fu">correlationBF</span>(df<span class="sc">$</span>x, df<span class="sc">$</span>y)</span></code></pre></div>
<pre><code>## Bayes factor analysis
## --------------
## [1] Alt., r=0.333 : 2.920163e+32 ±0%
## 
## Against denominator:
##   Null, rho = 0 
## ---
## Bayes factor type: BFcorrelation, Jeffreys-beta*</code></pre>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="seminar11.html#cb413-1" aria-hidden="true" tabindex="-1"></a>cor_bf <span class="ot">&lt;-</span> <span class="fu">correlationBF</span>(df<span class="sc">$</span>x, df<span class="sc">$</span>y, <span class="at">posterior =</span> <span class="cn">TRUE</span>, <span class="at">iterations=</span><span class="dv">1000</span>)</span>
<span id="cb413-2"><a href="seminar11.html#cb413-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span><span class="cn">NULL</span>, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">c</span>(cor_bf[, <span class="st">&quot;rho&quot;</span>]))) <span class="sc">+</span> </span>
<span id="cb413-3"><a href="seminar11.html#cb413-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">50</span>, ) <span class="sc">+</span> </span>
<span id="cb413-4"><a href="seminar11.html#cb413-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Pearson&#39;s rho&quot;</span>)</span></code></pre></div>
<p><img src="data-analysis-using-r-for-psychology_files/figure-html/unnamed-chunk-249-1.png" width="672" /></p>
</div>
<div id="pairwise-comparisons" class="section level2" number="11.3">
<h2><span class="header-section-number">11.3</span> Pairwise comparisons</h2>
<p>For pairwise comparisons for normally distributed data, you can use Student’s t-Test via <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/t.test.html">t.test()</a>. Here, I generate to <code>x</code> as a normally distributed normal variable and <code>y</code>, as a normally distributed variable random whose mean is <code>x+0.5</code>. I am using library <a href="https://github.com/eclarke/ggbeeswarm">ggbeeswarm</a> to generate the nicely looking cloud of dots.</p>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="seminar11.html#cb414-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">14454</span>)</span>
<span id="cb414-2"><a href="seminar11.html#cb414-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> </span>
<span id="cb414-3"><a href="seminar11.html#cb414-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb414-4"><a href="seminar11.html#cb414-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> x <span class="sc">+</span> <span class="fl">0.3</span>, <span class="at">sd =</span> <span class="dv">1</span>))</span></code></pre></div>
<p><img src="data-analysis-using-r-for-psychology_files/figure-html/unnamed-chunk-251-1.png" width="672" /></p>
<p>You can perform <em>t-test</em> assuming that samples in two variables are independent</p>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="seminar11.html#cb415-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(df<span class="sc">$</span>x, df<span class="sc">$</span>y, <span class="at">paired =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  df$x and df$y
## t = -1.8603, df = 184.37, p-value = 0.06443
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.65829852  0.01933491
## sample estimates:
## mean of x mean of y 
##  1.018298  1.337780</code></pre>
<p>Or, that they are paired, i.e., repeated-measures design (note the change in estimates, statistics, and significance).</p>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="seminar11.html#cb417-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(df<span class="sc">$</span>x, df<span class="sc">$</span>y, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  df$x and df$y
## t = -3.3432, df = 99, p-value = 0.00117
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.5090948 -0.1298688
## sample estimates:
## mean of the differences 
##              -0.3194818</code></pre>
<p>You can also use formula notation, if one variable describes grouping</p>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="seminar11.html#cb419-1" aria-hidden="true" tabindex="-1"></a>df_group <span class="ot">&lt;-</span></span>
<span id="cb419-2"><a href="seminar11.html#cb419-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(df<span class="sc">$</span>x, df<span class="sc">$</span>y),</span>
<span id="cb419-3"><a href="seminar11.html#cb419-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;A&quot;</span>, <span class="dv">100</span>), <span class="fu">rep</span>(<span class="st">&quot;B&quot;</span>, <span class="dv">100</span>))))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
<th align="left">group</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1.3776580</td>
<td align="left">A</td>
</tr>
<tr class="even">
<td align="right">1.8338910</td>
<td align="left">A</td>
</tr>
<tr class="odd">
<td align="right">-0.3034055</td>
<td align="left">A</td>
</tr>
<tr class="even">
<td align="right">1.3079381</td>
<td align="left">A</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="seminar11.html#cb420-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(x <span class="sc">~</span> group, <span class="at">data=</span>df_group, <span class="at">paired=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  x by group
## t = -3.3432, df = 99, p-value = 0.00117
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.5090948 -0.1298688
## sample estimates:
## mean of the differences 
##              -0.3194818</code></pre>
<p>A Bayesian version is provided via <code>ttestBF()</code> function, which is part of the <a href="https://richarddmorey.github.io/BayesFactor">BayesFactor</a> package.</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="seminar11.html#cb422-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(BayesFactor)</span>
<span id="cb422-2"><a href="seminar11.html#cb422-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ttestBF</span>(<span class="at">x =</span> df<span class="sc">$</span>x, <span class="at">y=</span>df<span class="sc">$</span>y, <span class="at">paired=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Bayes factor analysis
## --------------
## [1] Alt., r=0.707 : 19.27724 ±0%
## 
## Against denominator:
##   Null, mu = 0 
## ---
## Bayes factor type: BFoneSample, JZS</code></pre>
<p>For a non-parametric pairwise test, you can use Wilcoxon Rank Sum and Signed Rank Tests <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/wilcox.test.html">wilcox.test()</a>. Package <a href="http://coin.r-forge.r-project.org/">coin</a> implements many tests, including permutation tests, such as Two- and K-sample Fisher-Pitman permutation test via <code>oneway_test()</code> that tests for the equality of the distributions in <em>independent</em> groups, see <a href="https://cran.r-project.org/web/packages/coin/vignettes/coin.pdf">vignette</a> for details.</p>
</div>
<div id="anova" class="section level2" number="11.4">
<h2><span class="header-section-number">11.4</span> ANOVA</h2>
<p><strong>AN</strong>alysis <strong>O</strong>f <strong>VA</strong>riance is probably the most widely used analysis in social sciences. However, I would strongly suggest considering <a href="seminar11.html#GLMM">generalized linear mixed models</a> instead. Unlike ANOVA they can work when residuals are not normally distributed (binomial, count, Likert-scale ordered categorical, proportions data, etc.), they can tolerate missing values, and they tend to overfit less (their results are likely to better generalize to future data) by assuming that individual participants are more average than they appear in the raw data (so-called shrinkage).</p>
<p>First, let us simulate data for ten participants and their responses, assuming that condition <code>B</code> increases their responses by 2 (arbitrary) units and <code>C</code> by 3<a href="#fn56" class="footnote-ref" id="fnref56"><sup>56</sup></a>.</p>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="seminar11.html#cb424-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">519264</span>)</span>
<span id="cb424-2"><a href="seminar11.html#cb424-2" aria-hidden="true" tabindex="-1"></a>df_anova <span class="ot">&lt;-</span></span>
<span id="cb424-3"><a href="seminar11.html#cb424-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># generate ten participants with five trials per condition</span></span>
<span id="cb424-4"><a href="seminar11.html#cb424-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_grid</span>(<span class="at">Participant  =</span> <span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>),</span>
<span id="cb424-5"><a href="seminar11.html#cb424-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">Condition =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;A&quot;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&quot;B&quot;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&quot;C&quot;</span>, <span class="dv">3</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb424-6"><a href="seminar11.html#cb424-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb424-7"><a href="seminar11.html#cb424-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># decide on a SINGLE baseline (intercept) for each participant</span></span>
<span id="cb424-8"><a href="seminar11.html#cb424-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Participant) <span class="sc">%&gt;%</span></span>
<span id="cb424-9"><a href="seminar11.html#cb424-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Intercept =</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="fl">2.5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb424-10"><a href="seminar11.html#cb424-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb424-11"><a href="seminar11.html#cb424-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># simulate normally distributed responses, assuming that are 3 units higher for condition &quot;B&quot;</span></span>
<span id="cb424-12"><a href="seminar11.html#cb424-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb424-13"><a href="seminar11.html#cb424-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Response =</span> <span class="fu">rnorm</span>(<span class="fu">n</span>(), Intercept <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">as.integer</span>(Condition <span class="sc">==</span> <span class="st">&quot;B&quot;</span>) <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fu">as.integer</span>(Condition <span class="sc">==</span> <span class="st">&quot;C&quot;</span>), <span class="fl">1.5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb424-14"><a href="seminar11.html#cb424-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Intercept)</span></code></pre></div>
<p><img src="data-analysis-using-r-for-psychology_files/figure-html/unnamed-chunk-259-1.png" width="672" />
The base R ANOVA function is called <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/aov.html">aov()</a>, however, it does not support repeated measures. Instead, you can use function <code>anova_test</code> from package <a href="https://github.com/kassambara/rstatix">rstatix</a></p>
<p>For the <em>repeated-measures</em> ANOVA, we need to specify column with identity of participants via parameter <code>wid</code></p>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="seminar11.html#cb425-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb425-2"><a href="seminar11.html#cb425-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova_test</span>(<span class="at">data=</span>df_anova, Response <span class="sc">~</span> Condition, <span class="at">wid=</span>Participant)</span></code></pre></div>
<pre><code>## ANOVA Table (type II tests)
## 
##      Effect DFn DFd     F     p p&lt;.05   ges
## 1 Condition   2  87 7.418 0.001     * 0.146</code></pre>
<p>You can perform various pairwise post-hoc tests, e.g. Tukey</p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="seminar11.html#cb427-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tukey_hsd</span>(df_anova, Response <span class="sc">~</span> Condition)</span></code></pre></div>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="seminar11.html#cb428-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tukey_hsd</span>(df_anova, Response <span class="sc">~</span> Condition) <span class="sc">%&gt;%</span></span>
<span id="cb428-2"><a href="seminar11.html#cb428-2" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="left">group1</th>
<th align="left">group2</th>
<th align="right">null.value</th>
<th align="right">estimate</th>
<th align="right">conf.low</th>
<th align="right">conf.high</th>
<th align="right">p.adj</th>
<th align="left">p.adj.signif</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Condition</td>
<td align="left">A</td>
<td align="left">B</td>
<td align="right">0</td>
<td align="right">1.8015391</td>
<td align="right">0.2763798</td>
<td align="right">3.326698</td>
<td align="right">0.01640</td>
<td align="left">*</td>
</tr>
<tr class="even">
<td align="left">Condition</td>
<td align="left">A</td>
<td align="left">C</td>
<td align="right">0</td>
<td align="right">2.3560918</td>
<td align="right">0.8309325</td>
<td align="right">3.881251</td>
<td align="right">0.00115</td>
<td align="left">**</td>
</tr>
<tr class="odd">
<td align="left">Condition</td>
<td align="left">B</td>
<td align="left">C</td>
<td align="right">0</td>
<td align="right">0.5545527</td>
<td align="right">-0.9706066</td>
<td align="right">2.079712</td>
<td align="right">0.66200</td>
<td align="left">ns</td>
</tr>
</tbody>
</table>
<p>A Bayesian ANOVA with posterior distributions for individual coefficients and significance via Bayes Factor can be performed
via <code>anovaBF</code> function from <a href="https://richarddmorey.github.io/BayesFactor">BayesFactor</a> package.</p>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="seminar11.html#cb429-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anovaBF</span>(Response <span class="sc">~</span> Condition <span class="sc">+</span> Participant, <span class="at">whichRandom=</span><span class="st">&quot;Participant&quot;</span>, <span class="at">data=</span><span class="fu">data.frame</span>(df_anova))</span></code></pre></div>
<pre><code>## Bayes factor analysis
## --------------
## [1] Condition + Participant : 55450.04 ±0.85%
## 
## Against denominator:
##   Response ~ Participant 
## ---
## Bayes factor type: BFlinearModel, JZS</code></pre>
<p>If you decide for repeated-measure ANOVA, I would suggest using and reporting results for both frequentist and Bayesian ANOVA, as it will demonstrate that they do not depend on the choice of the statistical approach.</p>
</div>
<div id="GLMM" class="section level2" number="11.5">
<h2><span class="header-section-number">11.5</span> (Generalized) Linear Models</h2>
<p>Base R provides function to perform linear regression <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/lm.html">lm()</a> and generalized linear models <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/glm.html">glm()</a> for binomial, count, and other types of data.</p>
<p>Let us generate a simple linear dependence between two parameters and see how <code>lm()</code> will infer the dependence. Our formula will be
<span class="math display">\[ y = 20 + 4 * x + \epsilon\]</span>
where <span class="math inline">\(\epsilon\)</span> is normally distributed noise.</p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="seminar11.html#cb431-1" aria-hidden="true" tabindex="-1"></a>df_lm <span class="ot">&lt;-</span></span>
<span id="cb431-2"><a href="seminar11.html#cb431-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb431-3"><a href="seminar11.html#cb431-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">rnorm</span>(<span class="fu">n</span>(), <span class="dv">20</span> <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> x, <span class="dv">50</span>))</span></code></pre></div>
<p><img src="data-analysis-using-r-for-psychology_files/figure-html/unnamed-chunk-264-1.png" width="672" /></p>
<p>Now let us fit the linear model using formula <code>y ~ x</code> and use <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/summary.lm.html">summary()</a> function to see the details.</p>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="seminar11.html#cb432-1" aria-hidden="true" tabindex="-1"></a>lm_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data=</span>df_lm)</span>
<span id="cb432-2"><a href="seminar11.html#cb432-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x, data = df_lm)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -157.448  -30.581   -0.077   33.018  109.173 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  16.4483     9.1389    1.80    0.075 .  
## x             4.0701     0.1571   25.91   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 45.35 on 98 degrees of freedom
## Multiple R-squared:  0.8726, Adjusted R-squared:  0.8713 
## F-statistic: 671.1 on 1 and 98 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>As you can see, values for both intercept and the slope are very close to our original design. If you need to extract information about individual coefficients, I recommend <code>tidy()</code> function from <a href="https://github.com/tidymodels/broom">broom</a> package that returns information about the model in a “tidy” format:</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="seminar11.html#cb434-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb434-2"><a href="seminar11.html#cb434-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm_fit)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">16.448278</td>
<td align="right">9.1389367</td>
<td align="right">1.799802</td>
<td align="right">0.074969</td>
</tr>
<tr class="even">
<td align="left">x</td>
<td align="right">4.070054</td>
<td align="right">0.1571132</td>
<td align="right">25.905235</td>
<td align="right">0.000000</td>
</tr>
</tbody>
</table>
</div>
<div id="generalized-linear-mixed-models" class="section level2" number="11.6">
<h2><span class="header-section-number">11.6</span> (Generalized) Linear Mixed Models</h2>
<p>Generalized linear mixed models allow you to incorporate information about random factors into the model. One of the most popular packages in R is <a href="https://github.com/lme4/lme4">lme4</a>. Let us use LMM on data we generated for ANOVA. Here, we specify that we would like to have individual slopes for each participants via <code>(1|Participant)</code> notation<a href="#fn57" class="footnote-ref" id="fnref57"><sup>57</sup></a>.</p>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="seminar11.html#cb435-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb435-2"><a href="seminar11.html#cb435-2" aria-hidden="true" tabindex="-1"></a>lmer_fit <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Response <span class="sc">~</span> Condition <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Participant), <span class="at">data=</span>df_anova)</span>
<span id="cb435-3"><a href="seminar11.html#cb435-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmer_fit)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: Response ~ Condition + (1 | Participant)
##    Data: df_anova
## 
## REML criterion at convergence: 359.6
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -2.3188 -0.7330 -0.1038  0.8131  2.0589 
## 
## Random effects:
##  Groups      Name        Variance Std.Dev.
##  Participant (Intercept) 3.966    1.991   
##  Residual                2.444    1.563   
## Number of obs: 90, groups:  Participant, 10
## 
## Fixed effects:
##             Estimate Std. Error t value
## (Intercept)   4.5005     0.6914   6.509
## ConditionB    1.8015     0.4037   4.463
## ConditionC    2.3561     0.4037   5.836
## 
## Correlation of Fixed Effects:
##            (Intr) CndtnB
## ConditionB -0.292       
## ConditionC -0.292  0.500</code></pre>
<p>To get tidy summary you need to use function <code>tidy</code> but from <a href="https://github.com/bbolker/broom.mixed">broom.mixed</a></p>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="seminar11.html#cb437-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.mixed)</span>
<span id="cb437-2"><a href="seminar11.html#cb437-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmer_fit)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">effect</th>
<th align="left">group</th>
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">fixed</td>
<td align="left">NA</td>
<td align="left">(Intercept)</td>
<td align="right">4.500512</td>
<td align="right">0.6914189</td>
<td align="right">6.509097</td>
</tr>
<tr class="even">
<td align="left">fixed</td>
<td align="left">NA</td>
<td align="left">ConditionB</td>
<td align="right">1.801539</td>
<td align="right">0.4036827</td>
<td align="right">4.462760</td>
</tr>
<tr class="odd">
<td align="left">fixed</td>
<td align="left">NA</td>
<td align="left">ConditionC</td>
<td align="right">2.356092</td>
<td align="right">0.4036827</td>
<td align="right">5.836495</td>
</tr>
<tr class="even">
<td align="left">ran_pars</td>
<td align="left">Participant</td>
<td align="left">sd__(Intercept)</td>
<td align="right">1.991432</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">ran_pars</td>
<td align="left">Residual</td>
<td align="left">sd__Observation</td>
<td align="right">1.563456</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<p>To also get information about formal statistical significance, you can use an extension package <a href="https://github.com/runehaubo/lmerTestR">lmerTest</a><a href="#fn58" class="footnote-ref" id="fnref58"><sup>58</sup></a>.</p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="seminar11.html#cb438-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb438-2"><a href="seminar11.html#cb438-2" aria-hidden="true" tabindex="-1"></a>lmert_fit <span class="ot">&lt;-</span> lmerTest<span class="sc">::</span><span class="fu">lmer</span>(Response <span class="sc">~</span> Condition <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Participant), <span class="at">data=</span>df_anova)</span>
<span id="cb438-3"><a href="seminar11.html#cb438-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmert_fit)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
## lmerModLmerTest]
## Formula: Response ~ Condition + (1 | Participant)
##    Data: df_anova
## 
## REML criterion at convergence: 359.6
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -2.3188 -0.7330 -0.1038  0.8131  2.0589 
## 
## Random effects:
##  Groups      Name        Variance Std.Dev.
##  Participant (Intercept) 3.966    1.991   
##  Residual                2.444    1.563   
## Number of obs: 90, groups:  Participant, 10
## 
## Fixed effects:
##             Estimate Std. Error      df t value Pr(&gt;|t|)    
## (Intercept)   4.5005     0.6914 11.4337   6.509 3.64e-05 ***
## ConditionB    1.8015     0.4037 78.0000   4.463 2.69e-05 ***
## ConditionC    2.3561     0.4037 78.0000   5.836 1.16e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##            (Intr) CndtnB
## ConditionB -0.292       
## ConditionC -0.292  0.500</code></pre>
<p>Again, we can use <code>tidy</code> to get coefficients information in a single table.</p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="seminar11.html#cb440-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmert_fit)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">effect</th>
<th align="left">group</th>
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">df</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">fixed</td>
<td align="left">NA</td>
<td align="left">(Intercept)</td>
<td align="right">4.500512</td>
<td align="right">0.6914189</td>
<td align="right">6.509097</td>
<td align="right">11.43367</td>
<td align="right">3.64e-05</td>
</tr>
<tr class="even">
<td align="left">fixed</td>
<td align="left">NA</td>
<td align="left">ConditionB</td>
<td align="right">1.801539</td>
<td align="right">0.4036827</td>
<td align="right">4.462760</td>
<td align="right">78.00000</td>
<td align="right">2.69e-05</td>
</tr>
<tr class="odd">
<td align="left">fixed</td>
<td align="left">NA</td>
<td align="left">ConditionC</td>
<td align="right">2.356092</td>
<td align="right">0.4036827</td>
<td align="right">5.836495</td>
<td align="right">78.00000</td>
<td align="right">1.00e-07</td>
</tr>
<tr class="even">
<td align="left">ran_pars</td>
<td align="left">Participant</td>
<td align="left">sd__(Intercept)</td>
<td align="right">1.991432</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">ran_pars</td>
<td align="left">Residual</td>
<td align="left">sd__Observation</td>
<td align="right">1.563456</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<p>Note that <code>lmer()</code> functions provide information about difference of each condition to the baseline (condition <code>A</code>) not no ANOVA-style significance for the “overall” effect of condition. For this, you can use function <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/add1.html">drop1</a>, which test for a variable significance by dropping it from a model and checking whether it performed significantly worse <em>without</em> it.</p>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="seminar11.html#cb441-1" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(lmert_fit)</span></code></pre></div>
<pre><code>## Single term deletions using Satterthwaite&#39;s method:
## 
## Model:
## Response ~ Condition + (1 | Participant)
##           Sum Sq Mean Sq NumDF DenDF F value    Pr(&gt;F)    
## Condition 91.042  45.521     2    78  18.623 2.446e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>You can also use Bayesian generalized linear modeling via <a href="https://mc-stan.org/rstanarm/">rstanarm</a> and <a href="https://github.com/paul-buerkner/brms">BRMS</a> packages. The former is somewhat faster, as it does not require model compilation (makes big difference when data is small but you test a lot of models), but is less flexible.</p>
</div>
<div id="practice" class="section level2" number="11.7">
<h2><span class="header-section-number">11.7</span> Practice</h2>
<p>For practice, we will use data from a gamification experiment. Participant performed the same challenging task setup as a typical (read, boring) experiment or styled as a game with trial score, combos, high score table, achievements, etc. The idea was to investigate whether this shallow gamification (there was no story and all elements were present only before or after each trial and provided no information on the task itself) would alter (hopefully, improve) their performance. We quantified it via proportion of correct responses, response time, and score achieved for each trial (that one, you will need to compute yourself). Below, we would like to understand effects of</p>
<ol style="list-style-type: decimal">
<li>Experimental group coded in variable <code>Condition</code>, either <code>"experiment"</code> or <code>"game"</code>.</li>
<li>Task difficulty controller via cue-onset asynchrony. Participants could response while the stimulus was still on the scree (COA = -100 ms), shortly after it disappeared (COA=100 ms), or after a delay (COA = 1000 ms). We would expect that task is harder to longer COAs.</li>
<li>Perceptual learning. As participants do the task, the become better at it and are likely to become both faster and more accurate for later blocks. So we need to incorporate that improvement over different blocks into our model. The overall block index is coded in <code>Block</code> variable but we will need to create a new variable <code>COABlock</code> that will encode index of the block within each difficulty.</li>
</ol>
<p>You will need to load data, preprocess data, plot accuracy, response times, and score relative for each condition, difficulty, and difficulty block, perform formal statistical analysis to see whether any of the factor have an effect. So, first, download <a href="data/gamification.zip">gamification.zip</a> and unzip into your R-seminar project folder. You should get <em>gamification</em> subfolder with all the files. There will be no template notebook, create it from scratch yourself and keep it organized, e.g., headings, comments, chunked code, etc.</p>
<div id="read-files-and-preprocess-data" class="section level3 unnumbered">
<h3>Read files and preprocess data</h3>
<p>The two steps should be a single pipe.
1. Read and merge all CSV files in <em>gamification</em> folder into a single table. It is “German Excel” formatted with <code>:</code> as a delimiter and <code>,</code> as a decimal point. To perform it most cleanly, use <a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim</a>
function that allows you to specify the delimiter via <code>delim</code> parameter and the decimal point via <code>locale</code> parameter. You will need to read on how to specify the <a href="https://readr.tidyverse.org/reference/locale.html">locale</a> first. My advice, debug reading on a single file and then add reading-and-merging either via for loop or purrr mapping.
2. Compute whether response on each trial was correct (<code>Response</code> is equal to <code>Match</code> variable) and store it in <code>Correct</code> column. It is already present in the table but due to software glitch, some values are not correct. In general, it is not a bad idea to recompute such variables and compare them with table in the table, just to be on the safe side.
3. Drop columns <code>SessionID</code>, <code>Color0</code>, <code>Color1</code>, <code>Color2</code>, <code>Color3</code>, <code>Which</code> and <code>FlipComplimentary</code>. They are not relevant for the analysis and it is easier to look at uncluttered data.</p>
<table>
<thead>
<tr class="header">
<th align="left">Observer</th>
<th align="left">Condition</th>
<th align="right">Block</th>
<th align="right">Trial</th>
<th align="right">COA</th>
<th align="left">Target</th>
<th align="left">Match</th>
<th align="left">Response</th>
<th align="right">RT</th>
<th align="left">Correct</th>
<th align="right">OnsetDelay</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">-100</td>
<td align="left">column</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="right">0.9619999</td>
<td align="left">FALSE</td>
<td align="right">0.7110000</td>
</tr>
<tr class="even">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">-100</td>
<td align="left">column</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="right">0.8230000</td>
<td align="left">TRUE</td>
<td align="right">0.7710001</td>
</tr>
<tr class="odd">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">-100</td>
<td align="left">row</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="right">0.9500000</td>
<td align="left">TRUE</td>
<td align="right">1.3230000</td>
</tr>
<tr class="even">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">-100</td>
<td align="left">column</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="right">0.8500001</td>
<td align="left">TRUE</td>
<td align="right">0.8880000</td>
</tr>
</tbody>
</table>
<p>Now we need to compute block index per difficulty (and per participant and condition). We will spin it off as a separate table and then join it with the main one.
1. Generate a summary table with a single row per <code>Observer</code>, <code>Condition</code>, <code>COA</code>, <code>Block</code>. Hint, you can use <code>summarise(.groups="drop")</code> with no additional arguments to get one row per group.</p>
<table>
<thead>
<tr class="header">
<th align="left">Observer</th>
<th align="left">Condition</th>
<th align="right">COA</th>
<th align="right">Block</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">-100</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">-100</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">-100</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">-100</td>
<td align="right">10</td>
</tr>
</tbody>
</table>
<ol start="2" style="list-style-type: decimal">
<li>Regroup the table by <code>Observer</code>, <code>Condition</code>, and <code>COA</code> and compute <code>COABLock</code> block index. It is simply a sequence from 1 till number of rows in the group, you can get the latter via <a href="https://dplyr.tidyverse.org/reference/n.html">n()</a> function.</li>
</ol>
<table>
<thead>
<tr class="header">
<th align="left">Observer</th>
<th align="left">Condition</th>
<th align="right">COA</th>
<th align="right">Block</th>
<th align="right">COABlock</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">-100</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">-100</td>
<td align="right">6</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">-100</td>
<td align="right">7</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">-100</td>
<td align="right">10</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">100</td>
<td align="right">2</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">100</td>
<td align="right">4</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
<ol start="3" style="list-style-type: decimal">
<li>Now we can add <code>COABlock</code> to the main table by joining the two. I would strongly recommend to name the new full table differently, e.g., the original could be <code>results_raw</code> and the new one <code>results</code>. This is because if you join to table, overwriting one of them, and try to do joining again (you fixed it and now should work properly), you will get different column names as dplyr will enforce unique column names. It can get very confusing.</li>
<li>Filter out any rows where <code>COABlock</code> is more than 4. Some participants volunteered to do more but for the analysis we need to have full data for everyone.</li>
</ol>
<table>
<colgroup>
<col width="9%" />
<col width="11%" />
<col width="6%" />
<col width="6%" />
<col width="5%" />
<col width="7%" />
<col width="6%" />
<col width="9%" />
<col width="10%" />
<col width="8%" />
<col width="11%" />
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Observer</th>
<th align="left">Condition</th>
<th align="right">Block</th>
<th align="right">Trial</th>
<th align="right">COA</th>
<th align="left">Target</th>
<th align="left">Match</th>
<th align="left">Response</th>
<th align="right">RT</th>
<th align="left">Correct</th>
<th align="right">OnsetDelay</th>
<th align="right">COABlock</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">-100</td>
<td align="left">column</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="right">0.9619999</td>
<td align="left">FALSE</td>
<td align="right">0.7110000</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">-100</td>
<td align="left">column</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="right">0.8230000</td>
<td align="left">TRUE</td>
<td align="right">0.7710001</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">-100</td>
<td align="left">row</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="right">0.9500000</td>
<td align="left">TRUE</td>
<td align="right">1.3230000</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">-100</td>
<td align="left">column</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="right">0.8500001</td>
<td align="left">TRUE</td>
<td align="right">0.8880000</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
</div>
<div id="accuracy" class="section level3 unnumbered">
<h3>Accuracy</h3>
<p>Let us analyze accuracy, the results should be stored in a new separate table.</p>
<ol style="list-style-type: decimal">
<li>Compute number of correct trials each <code>Observer</code>, <code>Condition</code>, <code>COA</code> and <code>COABlock</code> combination. Also, store total number of trials for each combination in a separate variable (again, take a look at <a href="https://dplyr.tidyverse.org/reference/n.html">n()</a> function). We need these two variables for the statistical analysis.</li>
<li>Compute proportion of correct responses. You can compute it directly from <code>Correct</code> or from the two variables you computed on the previous step. We need this variable for visualization.</li>
</ol>
<table>
<thead>
<tr class="header">
<th align="left">Observer</th>
<th align="left">Condition</th>
<th align="right">COA</th>
<th align="right">COABlock</th>
<th align="right">Ncorrect</th>
<th align="right">Ntotal</th>
<th align="right">Pcorrect</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">-100</td>
<td align="right">1</td>
<td align="right">38</td>
<td align="right">48</td>
<td align="right">0.7916667</td>
</tr>
<tr class="even">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">-100</td>
<td align="right">2</td>
<td align="right">47</td>
<td align="right">48</td>
<td align="right">0.9791667</td>
</tr>
<tr class="odd">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">-100</td>
<td align="right">3</td>
<td align="right">47</td>
<td align="right">48</td>
<td align="right">0.9791667</td>
</tr>
<tr class="even">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">-100</td>
<td align="right">4</td>
<td align="right">45</td>
<td align="right">48</td>
<td align="right">0.9375000</td>
</tr>
</tbody>
</table>
<p>Let us visualize the performance. Generate a similar looking plot
<img src="data-analysis-using-r-for-psychology_files/figure-html/unnamed-chunk-277-1.png" width="672" /></p>
<p>And an alternative visualization.
<img src="data-analysis-using-r-for-psychology_files/figure-html/unnamed-chunk-278-1.png" width="672" /></p>
<p>The first one, shows an effect of experience (note how performance gets higher for the later blocks), for second one makes it easier to compare between conditions. Here, <code>experiment</code> tends to produce higher accuracy. However, this is just eye-balling the data, we need some actual numbers. For this, we will use Generalized Linear Mixed Model. It is <em>generalized</em> because out data is binomial (participants were successful in <code>Ncorrect</code> trials out of <code>Ntotal</code>). It is <em>linear</em> because we assume a simple linear sum of individual effects. It is <em>mixed</em>, because we will add <code>Observer</code> as a random factor<a href="#fn59" class="footnote-ref" id="fnref59"><sup>59</sup></a>. We will also use <code>COA</code> as a factor variable to have a more direct comparison between individual <code>COA</code> levels. Read <a href="https://www.rdocumentation.org/packages/lme4/versions/1.1-26/topics/glmer">documentation</a> to figure out how you specify the formula and binomial family. You will need to use library <a href="https://github.com/lme4/lme4">lmer4</a> and I strongly suggest using <code>lmer4::glmer()</code> notation as we will later use <a href="">lmerTest</a> package, which redefines some functions and it can be hard to figure out function from which package was actually called.</p>
<p>The summary output of the model should look like this.</p>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Laplace
##   Approximation) [glmerMod]
##  Family: binomial  ( logit )
## Formula: cbind(Ncorrect, Ntotal) ~ Condition + as.factor(COA) + COABlock +  
##     (1 | Observer)
##    Data: accuracy
## 
##      AIC      BIC   logLik deviance df.resid 
##   1788.8   1811.7   -888.4   1776.8      330 
## 
## Scaled residuals: 
##      Min       1Q   Median       3Q      Max 
## -1.72915 -0.29164  0.02438  0.34443  1.09710 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  Observer (Intercept) 0.01044  0.1022  
## Number of obs: 336, groups:  Observer, 28
## 
## Fixed effects:
##                    Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)        -0.26288    0.04509  -5.830 5.55e-09 ***
## Conditiongame      -0.05776    0.04539  -1.272  0.20323    
## as.factor(COA)100  -0.05424    0.02905  -1.867  0.06191 .  
## as.factor(COA)1000 -0.06163    0.02915  -2.115  0.03447 *  
## COABlock            0.03216    0.01070   3.005  0.00265 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) Cndtng as.(COA)100 a.(COA)1000
## Conditiongm -0.501                               
## as.(COA)100 -0.320  0.002                        
## a.(COA)1000 -0.323  0.002  0.491                 
## COABlock    -0.600  0.000  0.003       0.010</code></pre>
<p>As you can see, experience definitely improves the accuracy (effect for <code>COABlock</code> is positive and significant), there seems to be some effect of difficulty at least between extreme cases of COA = -100 ms (baseline) and COA = 1000 ms. But, does not seem to be much of an effect of the condition. We can also confirm this ANOVA-style with a single significance value for each fixed factor via <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/add1.html">drop1()</a> function, you will need to specify <code>test = "Chisq"</code> as a parameter to get significance values.</p>
<pre><code>## Single term deletions
## 
## Model:
## cbind(Ncorrect, Ntotal) ~ Condition + as.factor(COA) + COABlock + 
##     (1 | Observer)
##                npar    AIC    LRT  Pr(Chi)   
## &lt;none&gt;              1788.8                   
## Condition         1 1788.3 1.5749 0.209504   
## as.factor(COA)    2 1790.1 5.3724 0.068141 . 
## COABlock          1 1795.8 9.0345 0.002649 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="response-times" class="section level3 unnumbered">
<h3>Response times</h3>
<p>What about response times? Repeat the analysis but with a few changes. First, we only need to compute <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/median.html">median</a> response time instead of proportion of correct trials. Second, for the analysis, we use linear (not generalized) mixed models via <a href="https://www.rdocumentation.org/packages/lmerTest/versions/2.0-36/topics/lmer">lmer()</a> function from <a href="https://github.com/runehaubo/lmerTestR">lmerTest</a> package. Its advantage over the function with the same name from <code>lme4</code> package is in providing significance values. Again, use <code>lmerTest::lmer()</code> notation to use function from <code>lmerTest</code> and not the function of the same name in <code>lme4</code> package.</p>
<table>
<thead>
<tr class="header">
<th align="left">Observer</th>
<th align="left">Condition</th>
<th align="right">COA</th>
<th align="right">COABlock</th>
<th align="right">MedianRT</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">-100</td>
<td align="right">1</td>
<td align="right">0.8500000</td>
</tr>
<tr class="even">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">-100</td>
<td align="right">2</td>
<td align="right">0.8494999</td>
</tr>
<tr class="odd">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">-100</td>
<td align="right">3</td>
<td align="right">0.7660000</td>
</tr>
<tr class="even">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">-100</td>
<td align="right">4</td>
<td align="right">0.7180001</td>
</tr>
</tbody>
</table>
<p><img src="data-analysis-using-r-for-psychology_files/figure-html/unnamed-chunk-282-1.png" width="672" /></p>
<p><img src="data-analysis-using-r-for-psychology_files/figure-html/unnamed-chunk-283-1.png" width="672" /></p>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
## lmerModLmerTest]
## Formula: MedianRT ~ Condition + as.factor(COA) + COABlock + (1 | Observer)
##    Data: rt
## 
## REML criterion at convergence: 376.6
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -4.6729 -0.4167 -0.0270  0.3736  6.0652 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  Observer (Intercept) 0.3913   0.6255  
##  Residual             0.1275   0.3570  
## Number of obs: 336, groups:  Observer, 28
## 
## Fixed effects:
##                      Estimate Std. Error         df t value Pr(&gt;|t|)    
## (Intercept)          2.152089   0.177100  31.010542  12.152 2.50e-13 ***
## Conditiongame       -0.201307   0.239619  25.999998  -0.840    0.409    
## as.factor(COA)100   -0.009205   0.047713 305.000001  -0.193    0.847    
## as.factor(COA)1000  -0.008772   0.047713 305.000001  -0.184    0.854    
## COABlock            -0.142757   0.017422 305.000001  -8.194 7.05e-15 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) Cndtng as.(COA)100 a.(COA)1000
## Conditiongm -0.677                               
## as.(COA)100 -0.135  0.000                        
## a.(COA)1000 -0.135  0.000  0.500                 
## COABlock    -0.246  0.000  0.000       0.000</code></pre>
<pre><code>## Single term deletions using Satterthwaite&#39;s method:
## 
## Model:
## MedianRT ~ Condition + as.factor(COA) + COABlock + (1 | Observer)
##                Sum Sq Mean Sq NumDF DenDF F value    Pr(&gt;F)    
## Condition      0.0900  0.0900     1    26  0.7058    0.4085    
## as.factor(COA) 0.0060  0.0030     2   305  0.0237    0.9766    
## COABlock       8.5594  8.5594     1   305 67.1409 7.046e-15 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="computing-the-score" class="section level3 unnumbered">
<h3>Computing the score</h3>
<p>First, we need to compute score for each trial. The catch is, the score depends on both participants response on a <em>current</em> trial (correct or not and how fast was the response) and on <em>previous</em> trials (the score is multiplied by a combo: number of correct responses on a row + 1).</p>
<p>We begin by computing a raw score for each trial using the following rules:</p>
<ul>
<li>If the response is incorrect, the raw score is <code>0</code>, otherwise</li>
<li><span class="math inline">\(raw~score = ceiling(10 \cdot \frac{4-RT}{3})\)</span> but it cannot be larger than 10 or smaller than 0.</li>
</ul>
<p>Function <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/Round.html">ceiling(x)</a> returns the smallest integers not less than the corresponding elements of x. There is no function that could “clip” a value between 0 and 10 in R, so you need to write it yourself. If should take three parameters</p>
<ol style="list-style-type: decimal">
<li>Vector of values to be clipped.</li>
<li>Lower value limit.</li>
<li>Higher value limit.</li>
</ol>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="seminar11.html#cb447-1" aria-hidden="true" tabindex="-1"></a>example_vector <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">15</span>, <span class="dv">2</span>, <span class="dv">10</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">4</span>)</span>
<span id="cb447-2"><a href="seminar11.html#cb447-2" aria-hidden="true" tabindex="-1"></a><span class="fu">clip</span>(example_vector, <span class="dv">0</span>, <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## [1]  0 10  2 10  0  0</code></pre>
<p>Here is the head of the table with the computed raw score</p>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="seminar11.html#cb449-1" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span></span>
<span id="cb449-2"><a href="seminar11.html#cb449-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(RawScore<span class="sc">==</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb449-3"><a href="seminar11.html#cb449-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(Target, Match, Response, RT, COABlock, OnsetDelay)) <span class="sc">%&gt;%</span></span>
<span id="cb449-4"><a href="seminar11.html#cb449-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb449-5"><a href="seminar11.html#cb449-5" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Observer</th>
<th align="left">Condition</th>
<th align="right">Block</th>
<th align="right">Trial</th>
<th align="right">COA</th>
<th align="left">Correct</th>
<th align="right">RawScore</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">AKB1996w</td>
<td align="left">experiment</td>
<td align="right">3</td>
<td align="right">26</td>
<td align="right">1000</td>
<td align="left">TRUE</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">AKB1996w</td>
<td align="left">experiment</td>
<td align="right">8</td>
<td align="right">47</td>
<td align="right">1000</td>
<td align="left">TRUE</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">AKB1996w</td>
<td align="left">experiment</td>
<td align="right">12</td>
<td align="right">40</td>
<td align="right">1000</td>
<td align="left">TRUE</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">ARF1995w</td>
<td align="left">game</td>
<td align="right">1</td>
<td align="right">42</td>
<td align="right">-100</td>
<td align="left">TRUE</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">ARF1995w</td>
<td align="left">game</td>
<td align="right">1</td>
<td align="right">44</td>
<td align="right">-100</td>
<td align="left">TRUE</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">ARF1995w</td>
<td align="left">game</td>
<td align="right">2</td>
<td align="right">35</td>
<td align="right">100</td>
<td align="left">TRUE</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">ARF1995w</td>
<td align="left">game</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">1000</td>
<td align="left">TRUE</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">ARF1995w</td>
<td align="left">game</td>
<td align="right">3</td>
<td align="right">8</td>
<td align="right">1000</td>
<td align="left">TRUE</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">ARF1995w</td>
<td align="left">game</td>
<td align="right">3</td>
<td align="right">14</td>
<td align="right">1000</td>
<td align="left">TRUE</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">ARF1995w</td>
<td align="left">game</td>
<td align="right">3</td>
<td align="right">19</td>
<td align="right">1000</td>
<td align="left">TRUE</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
<p>To compute combo multiplier (number of correct responses on the row), we will write another function that loops over a vector of <code>Correct</code> responses. Every correct response (<code>TRUE</code>) add <code>1</code> to the multiplier for the <em>next</em> trial. Every incorrect response resets it to <code>1</code>, again, for the <em>next</em> trial.</p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="seminar11.html#cb450-1" aria-hidden="true" tabindex="-1"></a>correct <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>)</span>
<span id="cb450-2"><a href="seminar11.html#cb450-2" aria-hidden="true" tabindex="-1"></a><span class="fu">compute_combo</span>(correct)</span></code></pre></div>
<pre><code>## [1] 1 2 3 4 1 1 2 3 1</code></pre>
<p>Once you have the function and it work correctly, you can use to compute combo multiplier for the table. However, note that you need to do it per block, so you need to group data by <code>Observer</code>, <code>Condition</code>, <code>COA</code>, and <code>COABlock</code> first. Otherwise, your combo score won’t be 1 at the beginning of each block.</p>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="seminar11.html#cb452-1" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span></span>
<span id="cb452-2"><a href="seminar11.html#cb452-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb452-3"><a href="seminar11.html#cb452-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(Target, Match, Response, RT, COABlock, OnsetDelay)) <span class="sc">%&gt;%</span></span>
<span id="cb452-4"><a href="seminar11.html#cb452-4" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Observer</th>
<th align="left">Condition</th>
<th align="right">Block</th>
<th align="right">Trial</th>
<th align="right">COA</th>
<th align="left">Correct</th>
<th align="right">RawScore</th>
<th align="right">Combo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">-100</td>
<td align="left">FALSE</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">-100</td>
<td align="left">TRUE</td>
<td align="right">10</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">-100</td>
<td align="left">TRUE</td>
<td align="right">10</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">-100</td>
<td align="left">TRUE</td>
<td align="right">10</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">-100</td>
<td align="left">TRUE</td>
<td align="right">10</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">1</td>
<td align="right">6</td>
<td align="right">-100</td>
<td align="left">TRUE</td>
<td align="right">10</td>
<td align="right">5</td>
</tr>
<tr class="odd">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">1</td>
<td align="right">7</td>
<td align="right">-100</td>
<td align="left">TRUE</td>
<td align="right">10</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">1</td>
<td align="right">8</td>
<td align="right">-100</td>
<td align="left">TRUE</td>
<td align="right">10</td>
<td align="right">7</td>
</tr>
<tr class="odd">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">1</td>
<td align="right">9</td>
<td align="right">-100</td>
<td align="left">FALSE</td>
<td align="right">0</td>
<td align="right">8</td>
</tr>
<tr class="even">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">-100</td>
<td align="left">TRUE</td>
<td align="right">10</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>To get the actual score you just multiply raw score and multiplier</p>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="seminar11.html#cb453-1" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span></span>
<span id="cb453-2"><a href="seminar11.html#cb453-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb453-3"><a href="seminar11.html#cb453-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(Target, Match, Response, RT, COABlock, OnsetDelay)) <span class="sc">%&gt;%</span></span>
<span id="cb453-4"><a href="seminar11.html#cb453-4" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Observer</th>
<th align="left">Condition</th>
<th align="right">Block</th>
<th align="right">Trial</th>
<th align="right">COA</th>
<th align="left">Correct</th>
<th align="right">RawScore</th>
<th align="right">Combo</th>
<th align="right">Score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">-100</td>
<td align="left">FALSE</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">-100</td>
<td align="left">TRUE</td>
<td align="right">10</td>
<td align="right">1</td>
<td align="right">10</td>
</tr>
<tr class="odd">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">-100</td>
<td align="left">TRUE</td>
<td align="right">10</td>
<td align="right">2</td>
<td align="right">20</td>
</tr>
<tr class="even">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">-100</td>
<td align="left">TRUE</td>
<td align="right">10</td>
<td align="right">3</td>
<td align="right">30</td>
</tr>
<tr class="odd">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">-100</td>
<td align="left">TRUE</td>
<td align="right">10</td>
<td align="right">4</td>
<td align="right">40</td>
</tr>
<tr class="even">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">1</td>
<td align="right">6</td>
<td align="right">-100</td>
<td align="left">TRUE</td>
<td align="right">10</td>
<td align="right">5</td>
<td align="right">50</td>
</tr>
<tr class="odd">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">1</td>
<td align="right">7</td>
<td align="right">-100</td>
<td align="left">TRUE</td>
<td align="right">10</td>
<td align="right">6</td>
<td align="right">60</td>
</tr>
<tr class="even">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">1</td>
<td align="right">8</td>
<td align="right">-100</td>
<td align="left">TRUE</td>
<td align="right">10</td>
<td align="right">7</td>
<td align="right">70</td>
</tr>
<tr class="odd">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">1</td>
<td align="right">9</td>
<td align="right">-100</td>
<td align="left">FALSE</td>
<td align="right">0</td>
<td align="right">8</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">-100</td>
<td align="left">TRUE</td>
<td align="right">10</td>
<td align="right">1</td>
<td align="right">10</td>
</tr>
</tbody>
</table>
<p>Now that you have score per trial, perform analysis similar to response times but for each observer, condition, COA, and COA block compute a <em>total</em> score for each block. Otherwise, plot and analyze it similar to response times.</p>
<table>
<thead>
<tr class="header">
<th align="left">Observer</th>
<th align="left">Condition</th>
<th align="right">COA</th>
<th align="right">COABlock</th>
<th align="right">TotalScore</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">-100</td>
<td align="right">1</td>
<td align="right">1429</td>
</tr>
<tr class="even">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">-100</td>
<td align="right">2</td>
<td align="right">10820</td>
</tr>
<tr class="odd">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">-100</td>
<td align="right">3</td>
<td align="right">9960</td>
</tr>
<tr class="even">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">-100</td>
<td align="right">4</td>
<td align="right">5290</td>
</tr>
<tr class="odd">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">100</td>
<td align="right">1</td>
<td align="right">2796</td>
</tr>
<tr class="even">
<td align="left">AAF1997w</td>
<td align="left">experiment</td>
<td align="right">100</td>
<td align="right">2</td>
<td align="right">3281</td>
</tr>
</tbody>
</table>
<p><img src="data-analysis-using-r-for-psychology_files/figure-html/unnamed-chunk-297-1.png" width="672" /></p>
<p><img src="data-analysis-using-r-for-psychology_files/figure-html/unnamed-chunk-298-1.png" width="672" /></p>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
## lmerModLmerTest]
## Formula: TotalScore ~ Condition + as.factor(COA) + COABlock + (1 | Observer)
##    Data: score
## 
## REML criterion at convergence: 5871.3
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -1.9447 -0.4973 -0.1420  0.2494  4.6969 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  Observer (Intercept) 1234010  1111    
##  Residual             2349159  1533    
## Number of obs: 336, groups:  Observer, 28
## 
## Fixed effects:
##                    Estimate Std. Error       df t value Pr(&gt;|t|)    
## (Intercept)         1667.32     388.67    55.80   4.290 7.17e-05 ***
## Conditiongame       -261.00     451.94    26.00  -0.578 0.568566    
## as.factor(COA)100   -704.64     204.82   305.00  -3.440 0.000662 ***
## as.factor(COA)1000 -1009.47     204.82   305.00  -4.929 1.36e-06 ***
## COABlock             366.22      74.79   305.00   4.897 1.58e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) Cndtng as.(COA)100 a.(COA)1000
## Conditiongm -0.581                               
## as.(COA)100 -0.263  0.000                        
## a.(COA)1000 -0.263  0.000  0.500                 
## COABlock    -0.481  0.000  0.000       0.000</code></pre>
<pre><code>## Single term deletions using Satterthwaite&#39;s method:
## 
## Model:
## TotalScore ~ Condition + as.factor(COA) + COABlock + (1 | Observer)
##                  Sum Sq  Mean Sq NumDF DenDF F value    Pr(&gt;F)    
## Condition        783474   783474     1    26  0.3335    0.5686    
## as.factor(COA) 60049893 30024946     2   305 12.7811 4.673e-06 ***
## COABlock       56330349 56330349     1   305 23.9789 1.582e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="54">
<li id="fn54"><p>In the Statistical Rethinking seminar we spend three seminars learning how to understand and interpret a simple linear multiple regression with just two predictors. And the conclusion is that even in this simple case, you are not guaranteed to fully understand it. And if you think that you can easily interpret an interaction term even for two continuous predictors…<a href="seminar11.html#fnref54" class="footnote-back">↩︎</a></p></li>
<li id="fn55"><p>Use (names())[<a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/names.html" class="uri">https://stat.ethz.ch/R-manual/R-devel/library/base/html/names.html</a>] function to get names of all elements.<a href="seminar11.html#fnref55" class="footnote-back">↩︎</a></p></li>
<li id="fn56"><p><a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/Random.html">set.seed()</a> function initializes random numbers generator to a specific state to get a reproducible but random (as in, sequentially uncorrelated) sequence of values.<a href="seminar11.html#fnref56" class="footnote-back">↩︎</a></p></li>
<li id="fn57"><p>Here, each participant must have their own intercept but they all share same single slope for <code>Condition</code>. You can also specify that they individual slopes that are either correlated or uncorrelated with their intercept.<a href="seminar11.html#fnref57" class="footnote-back">↩︎</a></p></li>
<li id="fn58"><p>I use <code>lmerTest::</code> to tell R that I need function <code>lmer()</code> from package <code>lmerTest</code> and not from <code>lme4</code> as before<a href="seminar11.html#fnref58" class="footnote-back">↩︎</a></p></li>
<li id="fn59"><p>The magic machinery underneath will mix ordinary least squares (OLS) estimates for fixed effects with Best Linear Unbiased Predictions (BLUP) for random effects.<a href="seminar11.html#fnref59" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="seminar10.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="seminar12.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["data-analysis-using-r-for-psychology.pdf", "data-analysis-using-r-for-psychology.epub"],
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
